[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 3.3 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_39 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_39 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_39 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_40 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_40 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_40 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_41 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_41 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_41 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_13 (Flatten)         (None, 2048)              0         
_________________________________________________________________
dense_26 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_27 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 248s 490ms/step - loss: 2.8863 - acc: 0.1375 - val_loss: 2.5920 - val_acc: 0.2138
Epoch 2/100
506/506 [==============================] - 55s 108ms/step - loss: 2.0453 - acc: 0.3977 - val_loss: 1.5955 - val_acc: 0.5563
Epoch 3/100
506/506 [==============================] - 55s 108ms/step - loss: 1.2845 - acc: 0.6663 - val_loss: 1.0897 - val_acc: 0.7174
Epoch 4/100
506/506 [==============================] - 55s 109ms/step - loss: 0.9672 - acc: 0.7463 - val_loss: 0.9001 - val_acc: 0.7441
Epoch 5/100
506/506 [==============================] - 55s 109ms/step - loss: 0.8207 - acc: 0.7745 - val_loss: 0.7596 - val_acc: 0.7934
Epoch 6/100
506/506 [==============================] - 55s 109ms/step - loss: 0.7079 - acc: 0.8026 - val_loss: 0.6588 - val_acc: 0.8170
Epoch 7/100
506/506 [==============================] - 55s 109ms/step - loss: 0.6338 - acc: 0.8188 - val_loss: 0.6140 - val_acc: 0.8159
Epoch 8/100
506/506 [==============================] - 55s 109ms/step - loss: 0.5694 - acc: 0.8367 - val_loss: 0.5356 - val_acc: 0.8490
Epoch 9/100
506/506 [==============================] - 55s 110ms/step - loss: 0.5251 - acc: 0.8482 - val_loss: 0.4858 - val_acc: 0.8637
Epoch 10/100
506/506 [==============================] - 55s 109ms/step - loss: 0.4772 - acc: 0.8629 - val_loss: 0.4666 - val_acc: 0.8682
Epoch 11/100
506/506 [==============================] - 55s 109ms/step - loss: 0.4420 - acc: 0.8725 - val_loss: 0.4263 - val_acc: 0.8806
Epoch 12/100
506/506 [==============================] - 55s 109ms/step - loss: 0.4095 - acc: 0.8843 - val_loss: 0.3998 - val_acc: 0.8875
Epoch 13/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3811 - acc: 0.8913 - val_loss: 0.3608 - val_acc: 0.9048
Epoch 14/100
506/506 [==============================] - 55s 109ms/step - loss: 0.3525 - acc: 0.8997 - val_loss: 0.3378 - val_acc: 0.9085
Epoch 15/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3310 - acc: 0.9055 - val_loss: 0.3305 - val_acc: 0.9048
Epoch 16/100
506/506 [==============================] - 61s 121ms/step - loss: 0.3084 - acc: 0.9127 - val_loss: 0.3079 - val_acc: 0.9143
Epoch 17/100
506/506 [==============================] - 56s 112ms/step - loss: 0.2873 - acc: 0.9180 - val_loss: 0.2766 - val_acc: 0.9262
Epoch 18/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2654 - acc: 0.9248 - val_loss: 0.2722 - val_acc: 0.9236
Epoch 19/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2499 - acc: 0.9291 - val_loss: 0.2374 - val_acc: 0.9347
Epoch 20/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2353 - acc: 0.9325 - val_loss: 0.2807 - val_acc: 0.9150
Epoch 21/100
506/506 [==============================] - 55s 110ms/step - loss: 0.2163 - acc: 0.9389 - val_loss: 0.2147 - val_acc: 0.9418
Epoch 22/100
506/506 [==============================] - 55s 109ms/step - loss: 0.2039 - acc: 0.9425 - val_loss: 0.1923 - val_acc: 0.9444
Epoch 23/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1904 - acc: 0.9460 - val_loss: 0.1912 - val_acc: 0.9440
Epoch 24/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1778 - acc: 0.9500 - val_loss: 0.1822 - val_acc: 0.9483
Epoch 25/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1643 - acc: 0.9542 - val_loss: 0.1680 - val_acc: 0.9522
Epoch 26/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1558 - acc: 0.9563 - val_loss: 0.1496 - val_acc: 0.9576
Epoch 27/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1442 - acc: 0.9593 - val_loss: 0.1382 - val_acc: 0.9613
Epoch 28/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1355 - acc: 0.9616 - val_loss: 0.1508 - val_acc: 0.9565
Epoch 29/100
506/506 [==============================] - 55s 110ms/step - loss: 0.1306 - acc: 0.9639 - val_loss: 0.1230 - val_acc: 0.9650
Epoch 30/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1213 - acc: 0.9653 - val_loss: 0.1256 - val_acc: 0.9630
Epoch 31/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1104 - acc: 0.9693 - val_loss: 0.1094 - val_acc: 0.9675
Epoch 32/100
506/506 [==============================] - 55s 110ms/step - loss: 0.1057 - acc: 0.9705 - val_loss: 0.0982 - val_acc: 0.9730
Epoch 33/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1002 - acc: 0.9717 - val_loss: 0.1182 - val_acc: 0.9662
Epoch 34/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0918 - acc: 0.9744 - val_loss: 0.0939 - val_acc: 0.9753
Epoch 35/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0884 - acc: 0.9755 - val_loss: 0.0839 - val_acc: 0.9792
Epoch 36/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0789 - acc: 0.9788 - val_loss: 0.0776 - val_acc: 0.9807
Epoch 37/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0775 - acc: 0.9787 - val_loss: 0.0815 - val_acc: 0.9768
Epoch 38/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0719 - acc: 0.9822 - val_loss: 0.0770 - val_acc: 0.9792
Epoch 39/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0669 - acc: 0.9829 - val_loss: 0.0759 - val_acc: 0.9792
Epoch 40/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0620 - acc: 0.9845 - val_loss: 0.0715 - val_acc: 0.9825
Epoch 41/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0603 - acc: 0.9851 - val_loss: 0.0604 - val_acc: 0.9859
Epoch 42/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0543 - acc: 0.9866 - val_loss: 0.0582 - val_acc: 0.9859
Epoch 43/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0511 - acc: 0.9876 - val_loss: 0.0530 - val_acc: 0.9853
Epoch 44/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0476 - acc: 0.9885 - val_loss: 0.0581 - val_acc: 0.9838
Epoch 45/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0453 - acc: 0.9892 - val_loss: 0.0538 - val_acc: 0.9857
Epoch 46/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0401 - acc: 0.9906 - val_loss: 0.0513 - val_acc: 0.9877
Epoch 47/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0378 - acc: 0.9911 - val_loss: 0.0576 - val_acc: 0.9851
Epoch 48/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0356 - acc: 0.9918 - val_loss: 0.0371 - val_acc: 0.9913
Epoch 49/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0358 - acc: 0.9913 - val_loss: 0.0361 - val_acc: 0.9909
Epoch 50/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0331 - acc: 0.9921 - val_loss: 0.0386 - val_acc: 0.9903
Epoch 51/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0278 - acc: 0.9933 - val_loss: 0.0307 - val_acc: 0.9935
Epoch 52/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0271 - acc: 0.9940 - val_loss: 0.0301 - val_acc: 0.9933
Epoch 53/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0237 - acc: 0.9947 - val_loss: 0.0266 - val_acc: 0.9939
Epoch 54/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0237 - acc: 0.9949 - val_loss: 0.0295 - val_acc: 0.9924
Epoch 55/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0217 - acc: 0.9953 - val_loss: 0.0302 - val_acc: 0.9920
Epoch 56/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0218 - acc: 0.9949 - val_loss: 0.0286 - val_acc: 0.9933
Epoch 57/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0197 - acc: 0.9961 - val_loss: 0.0252 - val_acc: 0.9937
Epoch 58/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0176 - acc: 0.9967 - val_loss: 0.0266 - val_acc: 0.9942
Epoch 59/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0175 - acc: 0.9964 - val_loss: 0.0240 - val_acc: 0.9948
Epoch 60/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0174 - acc: 0.9960 - val_loss: 0.0244 - val_acc: 0.9937
Epoch 61/100
506/506 [==============================] - 62s 122ms/step - loss: 0.0177 - acc: 0.9960 - val_loss: 0.0176 - val_acc: 0.9965
Epoch 62/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0139 - acc: 0.9973 - val_loss: 0.0184 - val_acc: 0.9950
Epoch 63/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0138 - acc: 0.9973 - val_loss: 0.0204 - val_acc: 0.9955
Epoch 64/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0126 - acc: 0.9972 - val_loss: 0.0189 - val_acc: 0.9959
Epoch 65/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0106 - acc: 0.9982 - val_loss: 0.0452 - val_acc: 0.9853
Epoch 66/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0138 - acc: 0.9971 - val_loss: 0.0188 - val_acc: 0.9955

[INFO] Duração do treinamento: 64.7 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 74s 513ms/step - loss: 0.0241 - acc: 0.9948

Perda do teste: 0.024 
Acurácia do Teste: 99.48%

Gerando matriz de confusão tradicional...

[[448   0   0   0   3   0   0   0   0   0   0   0   0   0   0   3   0   0
    0   0   0]
 [  0 446   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 455   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  1   0   0 431   0   0   4   0   0   0   0   1   0   0   1   1   0   0
    1   0   0]
 [  0   0   0   0 450   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0 421   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   1   0 435   0   1   0   0   1   2   0   0   0   0   0
    0   0   0]
 [  0   0   0   1   2   0   2 433   0   0   0   0   0   0   0   2   0   0
    0   0   0]
 [  0   0   2   0   0   0   1   0 437   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 440   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   1   0   0   0   4 435   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   2   1   0   0   2   0   0   0   0 434   0   0   0   1   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0 439   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0 437   0   0   3
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   2   0   0   0   0 432   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0 439
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  440   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0 441   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 440]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       1.00      0.99      0.99       454
           B       1.00      1.00      1.00       446
           C       0.99      1.00      1.00       455
           D       1.00      0.98      0.99       440
           E       0.99      1.00      0.99       450
           F       1.00      1.00      1.00       421
           G       0.98      0.99      0.98       440
           I       1.00      0.98      0.99       440
           L       1.00      0.99      0.99       440
           M       0.99      1.00      0.99       440
           N       1.00      0.99      0.99       440
           O       0.99      0.99      0.99       440
           P       1.00      1.00      1.00       440
           Q       1.00      1.00      1.00       440
           R       1.00      0.99      1.00       440
           S       0.98      1.00      0.99       440
           T       1.00      1.00      1.00       434
           U       0.99      1.00      1.00       440
           V       1.00      1.00      1.00       440
           W       1.00      1.00      1.00       441
           Y       1.00      1.00      1.00       440

    accuracy                           0.99      9261
   macro avg       0.99      0.99      0.99      9261
weighted avg       0.99      0.99      0.99      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211013_0049