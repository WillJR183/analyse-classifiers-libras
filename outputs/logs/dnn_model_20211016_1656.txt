[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_6 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_24 (Dense)             (None, 80)                983120    
_________________________________________________________________
dense_25 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_26 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_27 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 193s 381ms/step - loss: 2.9590 - acc: 0.1200 - val_loss: 2.8667 - val_acc: 0.1988
Epoch 2/100
506/506 [==============================] - 27s 53ms/step - loss: 2.7508 - acc: 0.2456 - val_loss: 2.6150 - val_acc: 0.3150
Epoch 3/100
506/506 [==============================] - 27s 53ms/step - loss: 2.4674 - acc: 0.3519 - val_loss: 2.3194 - val_acc: 0.4096
Epoch 4/100
506/506 [==============================] - 26s 52ms/step - loss: 2.1937 - acc: 0.4327 - val_loss: 2.0757 - val_acc: 0.4680
Epoch 5/100
506/506 [==============================] - 26s 52ms/step - loss: 1.9801 - acc: 0.4885 - val_loss: 1.8994 - val_acc: 0.4849
Epoch 6/100
506/506 [==============================] - 28s 56ms/step - loss: 1.8117 - acc: 0.5310 - val_loss: 1.7275 - val_acc: 0.5563
Epoch 7/100
506/506 [==============================] - 26s 52ms/step - loss: 1.6707 - acc: 0.5716 - val_loss: 1.6004 - val_acc: 0.5759
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5488 - acc: 0.6072 - val_loss: 1.5104 - val_acc: 0.6099
Epoch 9/100
506/506 [==============================] - 26s 52ms/step - loss: 1.4504 - acc: 0.6291 - val_loss: 1.3915 - val_acc: 0.6367
Epoch 10/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3624 - acc: 0.6520 - val_loss: 1.3209 - val_acc: 0.6692
Epoch 11/100
506/506 [==============================] - 26s 51ms/step - loss: 1.2892 - acc: 0.6729 - val_loss: 1.2476 - val_acc: 0.6817
Epoch 12/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2250 - acc: 0.6905 - val_loss: 1.1919 - val_acc: 0.7092
Epoch 13/100
506/506 [==============================] - 26s 52ms/step - loss: 1.1675 - acc: 0.7031 - val_loss: 1.1435 - val_acc: 0.7228
Epoch 14/100
506/506 [==============================] - 24s 48ms/step - loss: 1.1158 - acc: 0.7167 - val_loss: 1.1050 - val_acc: 0.7157
Epoch 15/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0704 - acc: 0.7281 - val_loss: 1.0558 - val_acc: 0.7241
Epoch 16/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0284 - acc: 0.7383 - val_loss: 1.0332 - val_acc: 0.7373
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9904 - acc: 0.7472 - val_loss: 0.9732 - val_acc: 0.7534
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9562 - acc: 0.7530 - val_loss: 0.9461 - val_acc: 0.7531
Epoch 19/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9243 - acc: 0.7602 - val_loss: 0.9303 - val_acc: 0.7579
Epoch 20/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8943 - acc: 0.7682 - val_loss: 0.8902 - val_acc: 0.7726
Epoch 21/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8683 - acc: 0.7719 - val_loss: 0.8594 - val_acc: 0.7687
Epoch 22/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8379 - acc: 0.7812 - val_loss: 0.8232 - val_acc: 0.7871
Epoch 23/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8143 - acc: 0.7865 - val_loss: 0.8112 - val_acc: 0.7841
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7894 - acc: 0.7918 - val_loss: 0.7829 - val_acc: 0.7940
Epoch 25/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7688 - acc: 0.7957 - val_loss: 0.7826 - val_acc: 0.7888
Epoch 26/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7462 - acc: 0.8029 - val_loss: 0.7569 - val_acc: 0.7992
Epoch 27/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7243 - acc: 0.8073 - val_loss: 0.7251 - val_acc: 0.8053
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7050 - acc: 0.8122 - val_loss: 0.6950 - val_acc: 0.8129
Epoch 29/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6873 - acc: 0.8148 - val_loss: 0.6972 - val_acc: 0.8159
Epoch 30/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6699 - acc: 0.8200 - val_loss: 0.6714 - val_acc: 0.8178
Epoch 31/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6536 - acc: 0.8245 - val_loss: 0.6856 - val_acc: 0.8120
Epoch 32/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6369 - acc: 0.8287 - val_loss: 0.6265 - val_acc: 0.8306
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6206 - acc: 0.8338 - val_loss: 0.6434 - val_acc: 0.8239
Epoch 34/100
506/506 [==============================] - 22s 42ms/step - loss: 0.6035 - acc: 0.8375 - val_loss: 0.5992 - val_acc: 0.8382
Epoch 35/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5910 - acc: 0.8406 - val_loss: 0.5783 - val_acc: 0.8427
Epoch 36/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5771 - acc: 0.8453 - val_loss: 0.5806 - val_acc: 0.8431
Epoch 37/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5599 - acc: 0.8490 - val_loss: 0.5623 - val_acc: 0.8447
Epoch 38/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5499 - acc: 0.8505 - val_loss: 0.5505 - val_acc: 0.8548
Epoch 39/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5366 - acc: 0.8556 - val_loss: 0.5475 - val_acc: 0.8486
Epoch 40/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5221 - acc: 0.8607 - val_loss: 0.5188 - val_acc: 0.8639
Epoch 41/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5122 - acc: 0.8625 - val_loss: 0.5208 - val_acc: 0.8561
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4978 - acc: 0.8662 - val_loss: 0.5341 - val_acc: 0.8511
Epoch 43/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4879 - acc: 0.8694 - val_loss: 0.5048 - val_acc: 0.8667
Epoch 44/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4788 - acc: 0.8709 - val_loss: 0.4797 - val_acc: 0.8708
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4659 - acc: 0.8752 - val_loss: 0.4771 - val_acc: 0.8708
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4592 - acc: 0.8771 - val_loss: 0.4687 - val_acc: 0.8762
Epoch 47/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4467 - acc: 0.8818 - val_loss: 0.4621 - val_acc: 0.8732
Epoch 48/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4401 - acc: 0.8829 - val_loss: 0.4494 - val_acc: 0.8797
Epoch 49/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4289 - acc: 0.8871 - val_loss: 0.4504 - val_acc: 0.8743
Epoch 50/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4199 - acc: 0.8896 - val_loss: 0.4340 - val_acc: 0.8858
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4122 - acc: 0.8908 - val_loss: 0.4169 - val_acc: 0.8877
Epoch 52/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4037 - acc: 0.8934 - val_loss: 0.4285 - val_acc: 0.8884
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3949 - acc: 0.8958 - val_loss: 0.4141 - val_acc: 0.8912
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3885 - acc: 0.8983 - val_loss: 0.4173 - val_acc: 0.8923
Epoch 55/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3826 - acc: 0.8985 - val_loss: 0.3872 - val_acc: 0.8998
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3758 - acc: 0.9022 - val_loss: 0.3804 - val_acc: 0.9024
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3665 - acc: 0.9049 - val_loss: 0.3824 - val_acc: 0.9011
Epoch 58/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3612 - acc: 0.9051 - val_loss: 0.3803 - val_acc: 0.9020
Epoch 59/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3523 - acc: 0.9081 - val_loss: 0.3702 - val_acc: 0.9033
Epoch 60/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3450 - acc: 0.9125 - val_loss: 0.3744 - val_acc: 0.9048
Epoch 61/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3403 - acc: 0.9125 - val_loss: 0.3647 - val_acc: 0.9052
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3347 - acc: 0.9137 - val_loss: 0.3447 - val_acc: 0.9098
Epoch 63/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3286 - acc: 0.9163 - val_loss: 0.3430 - val_acc: 0.9139
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3242 - acc: 0.9163 - val_loss: 0.3298 - val_acc: 0.9167
Epoch 65/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3164 - acc: 0.9194 - val_loss: 0.3436 - val_acc: 0.9139
Epoch 66/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3114 - acc: 0.9201 - val_loss: 0.3220 - val_acc: 0.9217
Epoch 67/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3061 - acc: 0.9201 - val_loss: 0.3151 - val_acc: 0.9249
Epoch 68/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3025 - acc: 0.9219 - val_loss: 0.3119 - val_acc: 0.9234
Epoch 69/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2953 - acc: 0.9250 - val_loss: 0.3212 - val_acc: 0.9167
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2913 - acc: 0.9253 - val_loss: 0.3050 - val_acc: 0.9273
Epoch 71/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2862 - acc: 0.9276 - val_loss: 0.3115 - val_acc: 0.9212
Epoch 72/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2794 - acc: 0.9290 - val_loss: 0.2918 - val_acc: 0.9273
Epoch 73/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2758 - acc: 0.9318 - val_loss: 0.2863 - val_acc: 0.9334
Epoch 74/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2711 - acc: 0.9321 - val_loss: 0.2781 - val_acc: 0.9327
Epoch 75/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2667 - acc: 0.9338 - val_loss: 0.2812 - val_acc: 0.9299
Epoch 76/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2637 - acc: 0.9329 - val_loss: 0.2847 - val_acc: 0.9310
Epoch 77/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2594 - acc: 0.9357 - val_loss: 0.2737 - val_acc: 0.9349
Epoch 78/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2540 - acc: 0.9374 - val_loss: 0.2968 - val_acc: 0.9228
Epoch 79/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2501 - acc: 0.9366 - val_loss: 0.2695 - val_acc: 0.9375
Epoch 80/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2461 - acc: 0.9380 - val_loss: 0.2630 - val_acc: 0.9355
Epoch 81/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2413 - acc: 0.9410 - val_loss: 0.2626 - val_acc: 0.9370
Epoch 82/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2383 - acc: 0.9414 - val_loss: 0.2673 - val_acc: 0.9342
Epoch 83/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2345 - acc: 0.9426 - val_loss: 0.2590 - val_acc: 0.9357
Epoch 84/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2315 - acc: 0.9431 - val_loss: 0.2492 - val_acc: 0.9409
Epoch 85/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2275 - acc: 0.9445 - val_loss: 0.2426 - val_acc: 0.9450
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2241 - acc: 0.9458 - val_loss: 0.2602 - val_acc: 0.9362
Epoch 87/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2198 - acc: 0.9471 - val_loss: 0.2499 - val_acc: 0.9396
Epoch 88/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2170 - acc: 0.9463 - val_loss: 0.2363 - val_acc: 0.9420
Epoch 89/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2130 - acc: 0.9488 - val_loss: 0.2378 - val_acc: 0.9414
Epoch 90/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2116 - acc: 0.9472 - val_loss: 0.2218 - val_acc: 0.9511
Epoch 91/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2065 - acc: 0.9500 - val_loss: 0.2341 - val_acc: 0.9457
Epoch 92/100
506/506 [==============================] - 21s 41ms/step - loss: 0.2043 - acc: 0.9509 - val_loss: 0.2428 - val_acc: 0.9381
Epoch 93/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2016 - acc: 0.9509 - val_loss: 0.2221 - val_acc: 0.9422
Epoch 94/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1973 - acc: 0.9528 - val_loss: 0.2333 - val_acc: 0.9416
Epoch 95/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1944 - acc: 0.9540 - val_loss: 0.2279 - val_acc: 0.9479

[INFO] Duração do treinamento: 37.9 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 45s 314ms/step - loss: 0.2340 - acc: 0.9427

Perda do teste: 0.234 
Acurácia do Teste: 94.27%

Gerando matriz de confusão tradicional...

[[391   2   0   2  19   0   8   9  11   0   0   0   0   0   0  11   0   0
    0   0   1]
 [  0 423   0   9   6   1   0   3   0   0   0   0   0   0   0   1   0   1
    0   2   0]
 [  0   0 446   2   0   0   0   0   0   0   2   1   0   0   0   0   2   1
    1   0   0]
 [  0   0   0 429   5   0   2   3   0   0   0   0   0   0   1   0   0   0
    0   0   0]
 [  0   0   0  10 421   0  11   8   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   5   0   3   0 387   0  19   2   0   0   0   0   0   0   0   4   0
    0   1   0]
 [  0   0   0  23   7   0 397   4   4   0   0   0   0   0   2   3   0   0
    0   0   0]
 [  0   2   0  23   8   2   2 389   1   0   0   0   0   0   2   7   1   0
    0   2   1]
 [  0   0   3   3   0   0  11   5 417   0   0   0   0   0   0   0   1   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 424   7   0   0   9   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  14 418   0   0   8   0   0   0   0
    0   0   0]
 [  0  10   1   0  10   7   5   1   0   0   0 395   4   0   1   0   0   2
    0   4   0]
 [  0   0   1   0   0   0   0   0   4   0   0   0 435   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   3   0   0 435   0   0   0   0
    0   0   0]
 [  0   3   0  22   0   0   2   0   0   0   0   0   0   0 411   0   0   2
    0   0   0]
 [  1   1   0   3   1   0   5  14   1   0   0   0   0   0   0 414   0   0
    0   0   0]
 [  0   4   0   0   1   7   0  14   1   0   0   0   0   0   0   0 405   0
    0   2   0]
 [  0   3   0   5   0   0   0   1   0   0   0   0   0   0   3   0   0 426
    0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   3   0   0  18
  411   8   0]
 [  0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0   0
    0 438   0]
 [  5   0   1   0   2   0   0   5   0   0   0   0   0   0   0   9   0   0
    0   0 418]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.98      0.86      0.92       454
           B       0.93      0.95      0.94       446
           C       0.99      0.98      0.98       455
           D       0.80      0.97      0.88       440
           E       0.88      0.94      0.91       450
           F       0.96      0.92      0.94       421
           G       0.90      0.90      0.90       440
           I       0.81      0.88      0.85       440
           L       0.95      0.95      0.95       440
           M       0.96      0.96      0.96       440
           N       0.97      0.95      0.96       440
           O       1.00      0.90      0.94       440
           P       0.99      0.99      0.99       440
           Q       0.96      0.99      0.98       440
           R       0.97      0.93      0.95       440
           S       0.93      0.94      0.94       440
           T       0.98      0.93      0.96       434
           U       0.95      0.97      0.96       440
           V       1.00      0.93      0.96       440
           W       0.95      0.99      0.97       441
           Y       1.00      0.95      0.97       440

    accuracy                           0.94      9261
   macro avg       0.95      0.94      0.94      9261
weighted avg       0.95      0.94      0.94      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1658