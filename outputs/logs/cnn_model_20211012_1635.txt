[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.8 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_21 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_21 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_21 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_22 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_22 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_22 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_23 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_23 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_23 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_7 (Flatten)          (None, 2048)              0         
_________________________________________________________________
dense_14 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_15 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 222s 438ms/step - loss: 2.9506 - acc: 0.0980 - val_loss: 2.7216 - val_acc: 0.1984
Epoch 2/100
506/506 [==============================] - 55s 109ms/step - loss: 2.3203 - acc: 0.2882 - val_loss: 1.9506 - val_acc: 0.3775
Epoch 3/100
506/506 [==============================] - 56s 110ms/step - loss: 1.6280 - acc: 0.5265 - val_loss: 1.3796 - val_acc: 0.6255
Epoch 4/100
506/506 [==============================] - 56s 110ms/step - loss: 1.2424 - acc: 0.6628 - val_loss: 1.1171 - val_acc: 0.7058
Epoch 5/100
506/506 [==============================] - 56s 110ms/step - loss: 1.0540 - acc: 0.7239 - val_loss: 1.0010 - val_acc: 0.7324
Epoch 6/100
506/506 [==============================] - 56s 110ms/step - loss: 0.9303 - acc: 0.7569 - val_loss: 0.8704 - val_acc: 0.7765
Epoch 7/100
506/506 [==============================] - 56s 110ms/step - loss: 0.8400 - acc: 0.7809 - val_loss: 0.7930 - val_acc: 0.7971
Epoch 8/100
506/506 [==============================] - 56s 110ms/step - loss: 0.7620 - acc: 0.8014 - val_loss: 0.7347 - val_acc: 0.8085
Epoch 9/100
506/506 [==============================] - 56s 111ms/step - loss: 0.6992 - acc: 0.8157 - val_loss: 0.6543 - val_acc: 0.8289
Epoch 10/100
506/506 [==============================] - 56s 111ms/step - loss: 0.6488 - acc: 0.8260 - val_loss: 0.6484 - val_acc: 0.8237
Epoch 11/100
506/506 [==============================] - 57s 112ms/step - loss: 0.6020 - acc: 0.8357 - val_loss: 0.5776 - val_acc: 0.8410
Epoch 12/100
506/506 [==============================] - 57s 112ms/step - loss: 0.5670 - acc: 0.8425 - val_loss: 0.5476 - val_acc: 0.8479
Epoch 13/100
506/506 [==============================] - 57s 112ms/step - loss: 0.5297 - acc: 0.8523 - val_loss: 0.5310 - val_acc: 0.8507
Epoch 14/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4975 - acc: 0.8599 - val_loss: 0.4865 - val_acc: 0.8656
Epoch 15/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4699 - acc: 0.8680 - val_loss: 0.4650 - val_acc: 0.8702
Epoch 16/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4425 - acc: 0.8750 - val_loss: 0.4280 - val_acc: 0.8808
Epoch 17/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4196 - acc: 0.8812 - val_loss: 0.4335 - val_acc: 0.8780
Epoch 18/100
506/506 [==============================] - 56s 112ms/step - loss: 0.3967 - acc: 0.8879 - val_loss: 0.3865 - val_acc: 0.8920
Epoch 19/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3758 - acc: 0.8918 - val_loss: 0.3721 - val_acc: 0.8981
Epoch 20/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3562 - acc: 0.8991 - val_loss: 0.3493 - val_acc: 0.9039
Epoch 21/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3387 - acc: 0.9032 - val_loss: 0.3461 - val_acc: 0.9037
Epoch 22/100
506/506 [==============================] - 56s 112ms/step - loss: 0.3165 - acc: 0.9111 - val_loss: 0.3231 - val_acc: 0.9091
Epoch 23/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3042 - acc: 0.9140 - val_loss: 0.3036 - val_acc: 0.9143
Epoch 24/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2893 - acc: 0.9173 - val_loss: 0.3067 - val_acc: 0.9126
Epoch 25/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2712 - acc: 0.9230 - val_loss: 0.2866 - val_acc: 0.9215
Epoch 26/100
506/506 [==============================] - 57s 112ms/step - loss: 0.2606 - acc: 0.9266 - val_loss: 0.2652 - val_acc: 0.9275
Epoch 27/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2481 - acc: 0.9291 - val_loss: 0.2554 - val_acc: 0.9282
Epoch 28/100
506/506 [==============================] - 57s 112ms/step - loss: 0.2355 - acc: 0.9333 - val_loss: 0.2551 - val_acc: 0.9308
Epoch 29/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2242 - acc: 0.9363 - val_loss: 0.2462 - val_acc: 0.9308
Epoch 30/100
506/506 [==============================] - 57s 112ms/step - loss: 0.2141 - acc: 0.9384 - val_loss: 0.2211 - val_acc: 0.9379
Epoch 31/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2022 - acc: 0.9429 - val_loss: 0.2259 - val_acc: 0.9373
Epoch 32/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1920 - acc: 0.9440 - val_loss: 0.2155 - val_acc: 0.9409
Epoch 33/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1846 - acc: 0.9470 - val_loss: 0.2031 - val_acc: 0.9450
Epoch 34/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1744 - acc: 0.9497 - val_loss: 0.1918 - val_acc: 0.9494
Epoch 35/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1674 - acc: 0.9519 - val_loss: 0.1885 - val_acc: 0.9474
Epoch 36/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1576 - acc: 0.9546 - val_loss: 0.1876 - val_acc: 0.9474
Epoch 37/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1522 - acc: 0.9558 - val_loss: 0.1866 - val_acc: 0.9487
Epoch 38/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1458 - acc: 0.9575 - val_loss: 0.1661 - val_acc: 0.9552
Epoch 39/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1380 - acc: 0.9594 - val_loss: 0.1912 - val_acc: 0.9483
Epoch 40/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1351 - acc: 0.9609 - val_loss: 0.1546 - val_acc: 0.9541
Epoch 41/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1277 - acc: 0.9627 - val_loss: 0.1511 - val_acc: 0.9574
Epoch 42/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1224 - acc: 0.9644 - val_loss: 0.1432 - val_acc: 0.9582
Epoch 43/100
506/506 [==============================] - 56s 112ms/step - loss: 0.1190 - acc: 0.9653 - val_loss: 0.1415 - val_acc: 0.9598
Epoch 44/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1125 - acc: 0.9667 - val_loss: 0.1272 - val_acc: 0.9637
Epoch 45/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1087 - acc: 0.9684 - val_loss: 0.1370 - val_acc: 0.9595
Epoch 46/100
506/506 [==============================] - 56s 112ms/step - loss: 0.1033 - acc: 0.9703 - val_loss: 0.1207 - val_acc: 0.9652
Epoch 47/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1004 - acc: 0.9706 - val_loss: 0.1656 - val_acc: 0.9505
Epoch 48/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0969 - acc: 0.9720 - val_loss: 0.1293 - val_acc: 0.9650
Epoch 49/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0929 - acc: 0.9729 - val_loss: 0.1072 - val_acc: 0.9697
Epoch 50/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0862 - acc: 0.9756 - val_loss: 0.1039 - val_acc: 0.9706
Epoch 51/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0821 - acc: 0.9771 - val_loss: 0.1048 - val_acc: 0.9695
Epoch 52/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0797 - acc: 0.9784 - val_loss: 0.1130 - val_acc: 0.9706
Epoch 53/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0776 - acc: 0.9792 - val_loss: 0.0988 - val_acc: 0.9736
Epoch 54/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0753 - acc: 0.9795 - val_loss: 0.0976 - val_acc: 0.9760
Epoch 55/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0727 - acc: 0.9802 - val_loss: 0.0942 - val_acc: 0.9751
Epoch 56/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0678 - acc: 0.9817 - val_loss: 0.0862 - val_acc: 0.9773
Epoch 57/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0653 - acc: 0.9828 - val_loss: 0.0830 - val_acc: 0.9771
Epoch 58/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0610 - acc: 0.9837 - val_loss: 0.1017 - val_acc: 0.9695
Epoch 59/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0601 - acc: 0.9841 - val_loss: 0.0824 - val_acc: 0.9779
Epoch 60/100
506/506 [==============================] - 60s 119ms/step - loss: 0.0586 - acc: 0.9852 - val_loss: 0.0856 - val_acc: 0.9771
Epoch 61/100
506/506 [==============================] - 66s 130ms/step - loss: 0.0558 - acc: 0.9858 - val_loss: 0.0730 - val_acc: 0.9801
Epoch 62/100
506/506 [==============================] - 58s 114ms/step - loss: 0.0565 - acc: 0.9847 - val_loss: 0.0818 - val_acc: 0.9781
Epoch 63/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0531 - acc: 0.9857 - val_loss: 0.0798 - val_acc: 0.9773
Epoch 64/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0485 - acc: 0.9876 - val_loss: 0.0675 - val_acc: 0.9836
Epoch 65/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0482 - acc: 0.9875 - val_loss: 0.0710 - val_acc: 0.9818
Epoch 66/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0460 - acc: 0.9879 - val_loss: 0.0660 - val_acc: 0.9838
Epoch 67/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0464 - acc: 0.9880 - val_loss: 0.0673 - val_acc: 0.9836
Epoch 68/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0413 - acc: 0.9898 - val_loss: 0.0577 - val_acc: 0.9851
Epoch 69/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0429 - acc: 0.9877 - val_loss: 0.0567 - val_acc: 0.9844
Epoch 70/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0407 - acc: 0.9890 - val_loss: 0.0551 - val_acc: 0.9849
Epoch 71/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0384 - acc: 0.9893 - val_loss: 0.0582 - val_acc: 0.9842
Epoch 72/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0363 - acc: 0.9905 - val_loss: 0.0574 - val_acc: 0.9857
Epoch 73/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0371 - acc: 0.9903 - val_loss: 0.0585 - val_acc: 0.9857
Epoch 74/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0343 - acc: 0.9907 - val_loss: 0.0547 - val_acc: 0.9868
Epoch 75/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0336 - acc: 0.9910 - val_loss: 0.0481 - val_acc: 0.9872
Epoch 76/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0342 - acc: 0.9910 - val_loss: 0.0567 - val_acc: 0.9853
Epoch 77/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0307 - acc: 0.9917 - val_loss: 0.0463 - val_acc: 0.9898
Epoch 78/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0304 - acc: 0.9921 - val_loss: 0.0491 - val_acc: 0.9883
Epoch 79/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0287 - acc: 0.9928 - val_loss: 0.0454 - val_acc: 0.9875
Epoch 80/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0302 - acc: 0.9918 - val_loss: 0.0464 - val_acc: 0.9894
Epoch 81/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0259 - acc: 0.9936 - val_loss: 0.0456 - val_acc: 0.9875
Epoch 82/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0289 - acc: 0.9925 - val_loss: 0.0435 - val_acc: 0.9900
Epoch 83/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0260 - acc: 0.9940 - val_loss: 0.0473 - val_acc: 0.9887
Epoch 84/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0251 - acc: 0.9943 - val_loss: 0.0411 - val_acc: 0.9903
Epoch 85/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0254 - acc: 0.9939 - val_loss: 0.0381 - val_acc: 0.9924
Epoch 86/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0231 - acc: 0.9947 - val_loss: 0.0372 - val_acc: 0.9918
Epoch 87/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0239 - acc: 0.9938 - val_loss: 0.0477 - val_acc: 0.9877
Epoch 88/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0210 - acc: 0.9951 - val_loss: 0.0347 - val_acc: 0.9913
Epoch 89/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0221 - acc: 0.9947 - val_loss: 0.0374 - val_acc: 0.9918
Epoch 90/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0201 - acc: 0.9956 - val_loss: 0.0367 - val_acc: 0.9911

[INFO] Duração do treinamento: 87.6 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 62s 426ms/step - loss: 0.0423 - acc: 0.9891

Perda do teste: 0.042 
Acurácia do Teste: 98.91%

Gerando matriz de confusão tradicional...

[[444   3   0   0   6   0   0   0   0   0   0   0   0   0   0   1   0   0
    0   0   0]
 [  1 444   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 454   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    0   0   0]
 [  2   0   0 428   0   0   2   0   0   1   0   1   0   0   5   1   0   0
    0   0   0]
 [  1   0   0   0 449   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0 419   1   0   0   0   0   0   0   0   0   0   0   0
    0   0   1]
 [  0   1   4   0   4   0 421   0   1   0   5   0   4   0   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0   0 437   0   0   0   0   0   0   0   0   0   0
    0   0   2]
 [  0   2   0   0   0   0   3   1 434   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 435   1   0   0   4   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 439   0   1   0   0   0   0   0
    0   0   0]
 [  1   0   0   0   0   0   1   1   3   0   0 433   0   0   0   0   0   0
    0   0   1]
 [  0   0   4   0   0   0   0   0   0   0   0   0 436   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0 439   0   0   0   0
    0   0   0]
 [  0   0   1   0   0   0   0   0   0   0   0   1   0   0 431   0   0   6
    1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 431   2
    0   0   1]
 [  0   0   3   0   2   0   0   0   0   0   0   1   0   0   0   0   0 434
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1   0   0   6   0   0   0
  432   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0 441   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0
    0   0 439]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.99      0.98      0.98       454
           B       0.99      1.00      0.99       446
           C       0.97      1.00      0.99       455
           D       1.00      0.97      0.99       440
           E       0.97      1.00      0.98       450
           F       1.00      1.00      1.00       421
           G       0.98      0.96      0.97       440
           I       1.00      0.99      0.99       440
           L       0.99      0.99      0.99       440
           M       1.00      0.99      0.99       440
           N       0.98      1.00      0.99       440
           O       0.99      0.98      0.99       440
           P       0.99      0.99      0.99       440
           Q       0.99      1.00      0.99       440
           R       0.98      0.98      0.98       440
           S       0.99      1.00      1.00       440
           T       1.00      0.99      1.00       434
           U       0.98      0.99      0.98       440
           V       1.00      0.98      0.99       440
           W       1.00      1.00      1.00       441
           Y       0.99      1.00      0.99       440

    accuracy                           0.99      9261
   macro avg       0.99      0.99      0.99      9261
weighted avg       0.99      0.99      0.99      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_1636