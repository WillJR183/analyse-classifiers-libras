[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.8 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_24 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_24 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_24 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_25 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_25 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_25 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_26 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_26 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_26 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_8 (Flatten)          (None, 2048)              0         
_________________________________________________________________
dense_16 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_17 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 220s 436ms/step - loss: 2.8501 - acc: 0.1724 - val_loss: 2.3677 - val_acc: 0.3717
Epoch 2/100
506/506 [==============================] - 55s 109ms/step - loss: 1.6791 - acc: 0.5394 - val_loss: 1.2846 - val_acc: 0.6287ETA: 1s - loss: 1.6932 - acc: 0.5350
Epoch 3/100
506/506 [==============================] - 55s 109ms/step - loss: 1.0782 - acc: 0.7007 - val_loss: 1.0047 - val_acc: 0.7153
Epoch 4/100
506/506 [==============================] - 55s 109ms/step - loss: 0.8727 - acc: 0.7580 - val_loss: 0.8539 - val_acc: 0.7683
Epoch 5/100
506/506 [==============================] - 55s 109ms/step - loss: 0.7449 - acc: 0.7944 - val_loss: 0.7246 - val_acc: 0.8085
Epoch 6/100
506/506 [==============================] - 56s 110ms/step - loss: 0.6515 - acc: 0.8230 - val_loss: 0.6601 - val_acc: 0.8126
Epoch 7/100
506/506 [==============================] - 55s 110ms/step - loss: 0.5731 - acc: 0.8435 - val_loss: 0.5815 - val_acc: 0.8401
Epoch 8/100
506/506 [==============================] - 55s 110ms/step - loss: 0.5050 - acc: 0.8632 - val_loss: 0.5355 - val_acc: 0.8576
Epoch 9/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4502 - acc: 0.8748 - val_loss: 0.4767 - val_acc: 0.8674
Epoch 10/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4017 - acc: 0.8900 - val_loss: 0.4226 - val_acc: 0.8858
Epoch 11/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3636 - acc: 0.9011 - val_loss: 0.3916 - val_acc: 0.8981
Epoch 12/100
506/506 [==============================] - 55s 109ms/step - loss: 0.3302 - acc: 0.9101 - val_loss: 0.3513 - val_acc: 0.9117
Epoch 13/100
506/506 [==============================] - 55s 110ms/step - loss: 0.2974 - acc: 0.9208 - val_loss: 0.3670 - val_acc: 0.9042
Epoch 14/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2709 - acc: 0.9288 - val_loss: 0.3107 - val_acc: 0.9221
Epoch 15/100
506/506 [==============================] - 58s 114ms/step - loss: 0.2506 - acc: 0.9353 - val_loss: 0.2736 - val_acc: 0.9308
Epoch 16/100
506/506 [==============================] - 55s 109ms/step - loss: 0.2310 - acc: 0.9399 - val_loss: 0.2557 - val_acc: 0.9394
Epoch 17/100
506/506 [==============================] - 55s 110ms/step - loss: 0.2141 - acc: 0.9445 - val_loss: 0.2562 - val_acc: 0.9342
Epoch 18/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1966 - acc: 0.9490 - val_loss: 0.2285 - val_acc: 0.9422
Epoch 19/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1821 - acc: 0.9525 - val_loss: 0.2228 - val_acc: 0.9437
Epoch 20/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1681 - acc: 0.9560 - val_loss: 0.2191 - val_acc: 0.9459
Epoch 21/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1570 - acc: 0.9585 - val_loss: 0.1925 - val_acc: 0.9531
Epoch 22/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1464 - acc: 0.9629 - val_loss: 0.1861 - val_acc: 0.9533
Epoch 23/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1336 - acc: 0.9652 - val_loss: 0.1863 - val_acc: 0.9520
Epoch 24/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1271 - acc: 0.9663 - val_loss: 0.1634 - val_acc: 0.9574
Epoch 25/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1153 - acc: 0.9697 - val_loss: 0.1643 - val_acc: 0.9576
Epoch 26/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1068 - acc: 0.9721 - val_loss: 0.1449 - val_acc: 0.9647
Epoch 27/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1021 - acc: 0.9725 - val_loss: 0.1248 - val_acc: 0.9678
Epoch 28/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0926 - acc: 0.9763 - val_loss: 0.1305 - val_acc: 0.9673
Epoch 29/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0855 - acc: 0.9778 - val_loss: 0.1083 - val_acc: 0.9738
Epoch 30/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0792 - acc: 0.9783 - val_loss: 0.1030 - val_acc: 0.9734
Epoch 31/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0745 - acc: 0.9807 - val_loss: 0.1042 - val_acc: 0.9740
Epoch 32/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0675 - acc: 0.9829 - val_loss: 0.1035 - val_acc: 0.9736
Epoch 33/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0629 - acc: 0.9836 - val_loss: 0.0929 - val_acc: 0.9779
Epoch 34/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0582 - acc: 0.9847 - val_loss: 0.0756 - val_acc: 0.9812
Epoch 35/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0548 - acc: 0.9858 - val_loss: 0.0838 - val_acc: 0.9773
Epoch 36/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0506 - acc: 0.9868 - val_loss: 0.0775 - val_acc: 0.9831
Epoch 37/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0457 - acc: 0.9885 - val_loss: 0.0656 - val_acc: 0.9853
Epoch 38/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0429 - acc: 0.9892 - val_loss: 0.0670 - val_acc: 0.9840
Epoch 39/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0397 - acc: 0.9906 - val_loss: 0.0633 - val_acc: 0.9825
Epoch 40/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0353 - acc: 0.9919 - val_loss: 0.0536 - val_acc: 0.9875
Epoch 41/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0335 - acc: 0.9925 - val_loss: 0.0513 - val_acc: 0.9875
Epoch 42/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0348 - acc: 0.9915 - val_loss: 0.0496 - val_acc: 0.9900
Epoch 43/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0297 - acc: 0.9925 - val_loss: 0.0487 - val_acc: 0.9896
Epoch 44/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0262 - acc: 0.9943 - val_loss: 0.0408 - val_acc: 0.9911
Epoch 45/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0244 - acc: 0.9947 - val_loss: 0.0432 - val_acc: 0.9896
Epoch 46/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0249 - acc: 0.9939 - val_loss: 0.0468 - val_acc: 0.9890
Epoch 47/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0213 - acc: 0.9952 - val_loss: 0.0413 - val_acc: 0.9896
Epoch 48/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0225 - acc: 0.9946 - val_loss: 0.0368 - val_acc: 0.9922
Epoch 49/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0168 - acc: 0.9970 - val_loss: 0.0448 - val_acc: 0.9870
Epoch 50/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0186 - acc: 0.9958 - val_loss: 0.0352 - val_acc: 0.9909
Epoch 51/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0151 - acc: 0.9969 - val_loss: 0.0306 - val_acc: 0.9924
Epoch 52/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0150 - acc: 0.9964 - val_loss: 0.0358 - val_acc: 0.9918
Epoch 53/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0147 - acc: 0.9969 - val_loss: 0.0306 - val_acc: 0.9931
Epoch 54/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0124 - acc: 0.9975 - val_loss: 0.0426 - val_acc: 0.9887
Epoch 55/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0135 - acc: 0.9966 - val_loss: 0.0267 - val_acc: 0.9937
Epoch 56/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0125 - acc: 0.9970 - val_loss: 0.0264 - val_acc: 0.9937
Epoch 57/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0115 - acc: 0.9977 - val_loss: 0.0306 - val_acc: 0.9918
Epoch 58/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0080 - acc: 0.9988 - val_loss: 0.0254 - val_acc: 0.9935
Epoch 59/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0113 - acc: 0.9977 - val_loss: 0.0324 - val_acc: 0.9911
Epoch 60/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0092 - acc: 0.9981 - val_loss: 0.0205 - val_acc: 0.9957
Epoch 61/100
506/506 [==============================] - 61s 120ms/step - loss: 0.0082 - acc: 0.9985 - val_loss: 0.0311 - val_acc: 0.9913
Epoch 62/100
506/506 [==============================] - 64s 127ms/step - loss: 0.0078 - acc: 0.9985 - val_loss: 0.0198 - val_acc: 0.9948
Epoch 63/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0101 - acc: 0.9975 - val_loss: 0.0183 - val_acc: 0.9959
Epoch 64/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0080 - acc: 0.9983 - val_loss: 0.0213 - val_acc: 0.9942
Epoch 65/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0064 - acc: 0.9986 - val_loss: 0.0198 - val_acc: 0.9961
Epoch 66/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0066 - acc: 0.9988 - val_loss: 0.0245 - val_acc: 0.9944
Epoch 67/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0051 - acc: 0.9993 - val_loss: 0.0220 - val_acc: 0.9946
Epoch 68/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0084 - acc: 0.9981 - val_loss: 0.0568 - val_acc: 0.9829
Epoch 69/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0063 - acc: 0.9989 - val_loss: 0.0186 - val_acc: 0.9959
Epoch 70/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0041 - acc: 0.9993 - val_loss: 0.0187 - val_acc: 0.9952

[INFO] Duração do treinamento: 67.9 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 60s 413ms/step - loss: 0.0138 - acc: 0.9965

Perda do teste: 0.014 
Acurácia do Teste: 99.65%

Gerando matriz de confusão tradicional...

[[452   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0   0
    0   0   0]
 [  0 445   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 454   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0]
 [  0   0   0 432   0   0   2   0   0   0   0   0   0   0   5   0   0   0
    1   0   0]
 [  1   0   0   0 449   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0 421   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0 439   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   1   0   0   0   0   0 439   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   1   0   0   0   0   0 439   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0   0   0   0 438   1   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 439   0   0   1   0   0   0   0
    0   0   0]
 [  1   0   1   0   0   1   0   0   0   2   0 434   0   0   0   0   1   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0 439   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0
    0   0   0]
 [  0   0   0   0   0   2   0   0   0   0   0   0   0   0   0   0 432   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0   0 438
    0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0
  439   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0 440   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 440]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       1.00      1.00      1.00       454
           B       1.00      1.00      1.00       446
           C       1.00      1.00      1.00       455
           D       1.00      0.98      0.99       440
           E       1.00      1.00      1.00       450
           F       0.99      1.00      1.00       421
           G       0.99      1.00      1.00       440
           I       1.00      1.00      1.00       440
           L       1.00      1.00      1.00       440
           M       1.00      1.00      1.00       440
           N       1.00      1.00      1.00       440
           O       1.00      0.99      0.99       440
           P       1.00      1.00      1.00       440
           Q       1.00      1.00      1.00       440
           R       0.98      1.00      0.99       440
           S       1.00      1.00      1.00       440
           T       0.99      1.00      0.99       434
           U       1.00      1.00      1.00       440
           V       1.00      1.00      1.00       440
           W       1.00      1.00      1.00       441
           Y       1.00      1.00      1.00       440

    accuracy                           1.00      9261
   macro avg       1.00      1.00      1.00      9261
weighted avg       1.00      1.00      1.00      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_1758