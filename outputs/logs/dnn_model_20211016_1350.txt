[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_3 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_12 (Dense)             (None, 80)                983120    
_________________________________________________________________
dense_13 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_14 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_15 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 192s 380ms/step - loss: 2.9560 - acc: 0.0956 - val_loss: 2.8582 - val_acc: 0.1372
Epoch 2/100
506/506 [==============================] - 26s 52ms/step - loss: 2.7340 - acc: 0.1885 - val_loss: 2.5930 - val_acc: 0.2313
Epoch 3/100
506/506 [==============================] - 27s 53ms/step - loss: 2.4348 - acc: 0.3041 - val_loss: 2.2818 - val_acc: 0.3490
Epoch 4/100
506/506 [==============================] - 26s 52ms/step - loss: 2.1474 - acc: 0.4245 - val_loss: 2.0316 - val_acc: 0.4466
Epoch 5/100
506/506 [==============================] - 27s 53ms/step - loss: 1.9302 - acc: 0.4939 - val_loss: 1.8556 - val_acc: 0.4723
Epoch 6/100
506/506 [==============================] - 27s 53ms/step - loss: 1.7635 - acc: 0.5355 - val_loss: 1.6755 - val_acc: 0.5733
Epoch 7/100
506/506 [==============================] - 26s 52ms/step - loss: 1.6326 - acc: 0.5710 - val_loss: 1.5695 - val_acc: 0.5684
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5271 - acc: 0.5982 - val_loss: 1.4933 - val_acc: 0.5956
Epoch 9/100
506/506 [==============================] - 28s 56ms/step - loss: 1.4430 - acc: 0.6200 - val_loss: 1.3878 - val_acc: 0.6434
Epoch 10/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3679 - acc: 0.6480 - val_loss: 1.3084 - val_acc: 0.6703
Epoch 11/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3065 - acc: 0.6660 - val_loss: 1.2519 - val_acc: 0.6993
Epoch 12/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2539 - acc: 0.6819 - val_loss: 1.1955 - val_acc: 0.7166
Epoch 13/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2036 - acc: 0.6974 - val_loss: 1.1590 - val_acc: 0.6878
Epoch 14/100
506/506 [==============================] - 27s 53ms/step - loss: 1.1581 - acc: 0.7070 - val_loss: 1.1099 - val_acc: 0.7248
Epoch 15/100
506/506 [==============================] - 25s 50ms/step - loss: 1.1171 - acc: 0.7178 - val_loss: 1.0715 - val_acc: 0.7391
Epoch 16/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0794 - acc: 0.7266 - val_loss: 1.0578 - val_acc: 0.7352
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0418 - acc: 0.7351 - val_loss: 1.0058 - val_acc: 0.7521
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0088 - acc: 0.7428 - val_loss: 0.9745 - val_acc: 0.7337
Epoch 19/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9791 - acc: 0.7488 - val_loss: 0.9305 - val_acc: 0.7681
Epoch 20/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9475 - acc: 0.7567 - val_loss: 0.9051 - val_acc: 0.7780
Epoch 21/100
506/506 [==============================] - 21s 41ms/step - loss: 0.9179 - acc: 0.7640 - val_loss: 0.8798 - val_acc: 0.7787
Epoch 22/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8895 - acc: 0.7704 - val_loss: 0.8512 - val_acc: 0.7869
Epoch 23/100
506/506 [==============================] - 22s 44ms/step - loss: 0.8640 - acc: 0.7779 - val_loss: 0.8560 - val_acc: 0.7836
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8383 - acc: 0.7830 - val_loss: 0.8148 - val_acc: 0.7927
Epoch 25/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8134 - acc: 0.7903 - val_loss: 0.7998 - val_acc: 0.7949
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7903 - acc: 0.7948 - val_loss: 0.7785 - val_acc: 0.7981
Epoch 27/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7685 - acc: 0.8006 - val_loss: 0.7584 - val_acc: 0.8048
Epoch 28/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7468 - acc: 0.8046 - val_loss: 0.7493 - val_acc: 0.8057
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7246 - acc: 0.8108 - val_loss: 0.7025 - val_acc: 0.8178
Epoch 30/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7046 - acc: 0.8132 - val_loss: 0.6794 - val_acc: 0.8258
Epoch 31/100
506/506 [==============================] - 23s 46ms/step - loss: 0.6826 - acc: 0.8206 - val_loss: 0.6782 - val_acc: 0.8215
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6663 - acc: 0.8241 - val_loss: 0.6537 - val_acc: 0.8217
Epoch 33/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6478 - acc: 0.8286 - val_loss: 0.6252 - val_acc: 0.8367
Epoch 34/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6298 - acc: 0.8324 - val_loss: 0.6233 - val_acc: 0.8410
Epoch 35/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6143 - acc: 0.8356 - val_loss: 0.6163 - val_acc: 0.8291
Epoch 36/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5973 - acc: 0.8408 - val_loss: 0.5829 - val_acc: 0.8483
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5814 - acc: 0.8453 - val_loss: 0.5790 - val_acc: 0.8462
Epoch 38/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5682 - acc: 0.8471 - val_loss: 0.5707 - val_acc: 0.8466
Epoch 39/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5532 - acc: 0.8521 - val_loss: 0.5438 - val_acc: 0.8507
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5420 - acc: 0.8556 - val_loss: 0.5494 - val_acc: 0.8501
Epoch 41/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5302 - acc: 0.8573 - val_loss: 0.5180 - val_acc: 0.8648
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5150 - acc: 0.8621 - val_loss: 0.5168 - val_acc: 0.8626
Epoch 43/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5032 - acc: 0.8653 - val_loss: 0.5018 - val_acc: 0.8689
Epoch 44/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4915 - acc: 0.8684 - val_loss: 0.4812 - val_acc: 0.8736
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4821 - acc: 0.8699 - val_loss: 0.4901 - val_acc: 0.8702
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4723 - acc: 0.8703 - val_loss: 0.4619 - val_acc: 0.8778
Epoch 47/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4618 - acc: 0.8743 - val_loss: 0.4759 - val_acc: 0.8760
Epoch 48/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4521 - acc: 0.8782 - val_loss: 0.4433 - val_acc: 0.8791
Epoch 49/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4442 - acc: 0.8787 - val_loss: 0.4451 - val_acc: 0.8786
Epoch 50/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4323 - acc: 0.8811 - val_loss: 0.4296 - val_acc: 0.8827
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4222 - acc: 0.8842 - val_loss: 0.4163 - val_acc: 0.8884
Epoch 52/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4165 - acc: 0.8854 - val_loss: 0.4251 - val_acc: 0.8840
Epoch 53/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4069 - acc: 0.8896 - val_loss: 0.3967 - val_acc: 0.8955
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3999 - acc: 0.8917 - val_loss: 0.4009 - val_acc: 0.8879
Epoch 55/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3904 - acc: 0.8935 - val_loss: 0.4092 - val_acc: 0.8866
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3843 - acc: 0.8950 - val_loss: 0.3815 - val_acc: 0.8996
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3754 - acc: 0.8976 - val_loss: 0.4705 - val_acc: 0.8572
Epoch 58/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3697 - acc: 0.8988 - val_loss: 0.3645 - val_acc: 0.9009
Epoch 59/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3629 - acc: 0.9005 - val_loss: 0.3680 - val_acc: 0.8974
Epoch 60/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3565 - acc: 0.9022 - val_loss: 0.3599 - val_acc: 0.9042
Epoch 61/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3492 - acc: 0.9054 - val_loss: 0.3685 - val_acc: 0.8985
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3430 - acc: 0.9066 - val_loss: 0.3418 - val_acc: 0.9083
Epoch 63/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3377 - acc: 0.9077 - val_loss: 0.3432 - val_acc: 0.9080
Epoch 64/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3305 - acc: 0.9091 - val_loss: 0.3335 - val_acc: 0.9059
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3242 - acc: 0.9120 - val_loss: 0.3435 - val_acc: 0.8992
Epoch 66/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3209 - acc: 0.9125 - val_loss: 0.3198 - val_acc: 0.9102
Epoch 67/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3126 - acc: 0.9162 - val_loss: 0.3202 - val_acc: 0.9102
Epoch 68/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3081 - acc: 0.9171 - val_loss: 0.3146 - val_acc: 0.9169
Epoch 69/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3035 - acc: 0.9185 - val_loss: 0.3092 - val_acc: 0.9158
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2999 - acc: 0.9185 - val_loss: 0.3208 - val_acc: 0.9089
Epoch 71/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2934 - acc: 0.9212 - val_loss: 0.3137 - val_acc: 0.9085
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2884 - acc: 0.9228 - val_loss: 0.2949 - val_acc: 0.9210
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2847 - acc: 0.9232 - val_loss: 0.2925 - val_acc: 0.9154
Epoch 74/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2808 - acc: 0.9250 - val_loss: 0.2909 - val_acc: 0.9141
Epoch 75/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2751 - acc: 0.9266 - val_loss: 0.2857 - val_acc: 0.9184
Epoch 76/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2722 - acc: 0.9271 - val_loss: 0.2778 - val_acc: 0.9228
Epoch 77/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2669 - acc: 0.9289 - val_loss: 0.2683 - val_acc: 0.9219
Epoch 78/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2632 - acc: 0.9299 - val_loss: 0.2630 - val_acc: 0.9269
Epoch 79/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2584 - acc: 0.9312 - val_loss: 0.2667 - val_acc: 0.9254
Epoch 80/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2544 - acc: 0.9326 - val_loss: 0.2594 - val_acc: 0.9305
Epoch 81/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2507 - acc: 0.9338 - val_loss: 0.2852 - val_acc: 0.9206
Epoch 82/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2459 - acc: 0.9357 - val_loss: 0.2478 - val_acc: 0.9310
Epoch 83/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2434 - acc: 0.9355 - val_loss: 0.2580 - val_acc: 0.9230
Epoch 84/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2396 - acc: 0.9378 - val_loss: 0.2475 - val_acc: 0.9331
Epoch 85/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2359 - acc: 0.9380 - val_loss: 0.2371 - val_acc: 0.9379
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2320 - acc: 0.9389 - val_loss: 0.2478 - val_acc: 0.9299
Epoch 87/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2286 - acc: 0.9399 - val_loss: 0.2334 - val_acc: 0.9368
Epoch 88/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2248 - acc: 0.9425 - val_loss: 0.2632 - val_acc: 0.9195
Epoch 89/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2223 - acc: 0.9419 - val_loss: 0.2246 - val_acc: 0.9392
Epoch 90/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2202 - acc: 0.9417 - val_loss: 0.2739 - val_acc: 0.9199
Epoch 91/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2147 - acc: 0.9447 - val_loss: 0.2359 - val_acc: 0.9342
Epoch 92/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2106 - acc: 0.9443 - val_loss: 0.2237 - val_acc: 0.9373
Epoch 93/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2092 - acc: 0.9449 - val_loss: 0.2284 - val_acc: 0.9347
Epoch 94/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2056 - acc: 0.9467 - val_loss: 0.2239 - val_acc: 0.9399
Epoch 95/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2024 - acc: 0.9472 - val_loss: 0.2235 - val_acc: 0.9325
Epoch 96/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1995 - acc: 0.9491 - val_loss: 0.2064 - val_acc: 0.9433
Epoch 97/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1972 - acc: 0.9485 - val_loss: 0.2072 - val_acc: 0.9420
Epoch 98/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1941 - acc: 0.9498 - val_loss: 0.2001 - val_acc: 0.9472
Epoch 99/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1926 - acc: 0.9500 - val_loss: 0.1964 - val_acc: 0.9455
Epoch 100/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1878 - acc: 0.9523 - val_loss: 0.2301 - val_acc: 0.9336

[INFO] Duração do treinamento: 39.9 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 45s 311ms/step - loss: 0.2391 - acc: 0.9310

Perda do teste: 0.239 
Acurácia do Teste: 93.10%

Gerando matriz de confusão tradicional...

[[400   2   0   0   5   0   3   4   1   0   0   3   0   0   0   9   1   0
    0   0  26]
 [  0 409   0   1   4   2   7  10   1   0   0   0   0   0   0   2   7   0
    0   3   0]
 [  0   0 426   0   0   0   2   0   5   0   0  15   3   2   0   0   0   0
    2   0   0]
 [  2   0   1 411   0   0   8   1   9   0   0   0   0   0   7   1   0   0
    0   0   0]
 [  0   1   0   3 404   0   7  12   9   0   0   0   0   0   0  13   0   0
    0   0   1]
 [  0   3   0   0   0 376   1   8   8   0   0  14   0   0   0   0   9   0
    0   0   2]
 [  1   1   0   8   0   0 398   4  19   0   0   0   0   0   0   9   0   0
    0   0   0]
 [  1   0   0   9   0   3   6 396   5   0   0   1   0   0   0  10   1   0
    0   0   8]
 [  0   0   6   0   0   0   4   2 425   0   0   0   0   0   0   1   2   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 437   0   0   0   3   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  23 402   0   0  15   0   0   0   0
    0   0   0]
 [  9   2   1   1   2   1   1   3   1   0   0 404   1   0   0   0   0   0
    0   4  10]
 [  0   0   2   0   0   0   0   0   3   0   0   1 432   0   0   0   0   0
    0   0   2]
 [  0   0   0   0   0   0   0   0   0   3   4   0   0 433   0   0   0   0
    0   0   0]
 [  0   1   0   8   0   0   0   0   5   0   0   0   0   0 426   0   0   0
    0   0   0]
 [  1   1   0   0   0   0   0   0   1   0   0   2   0   0   0 430   0   0
    0   0   5]
 [  0   2   0   0   0   1   0   3   0   0   0   0   0   0   0   2 424   0
    0   0   2]
 [  0   6   0   6   0   0   3   0   0   0   0   0   0   0  28   0   0 298
   96   3   0]
 [  0   0   0   1   0   0   0   1   0   0   0   0   0   0   7   0   0   0
  431   0   0]
 [  0   3   0   3   0   0   0   3   1   0   0   0   0   0   1   0   0   0
    0 430   0]
 [  2   0   0   0   0   0   0   3   1   0   0   1   0   0   0   3   0   0
    0   0 430]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.96      0.88      0.92       454
           B       0.95      0.92      0.93       446
           C       0.98      0.94      0.96       455
           D       0.91      0.93      0.92       440
           E       0.97      0.90      0.93       450
           F       0.98      0.89      0.94       421
           G       0.90      0.90      0.90       440
           I       0.88      0.90      0.89       440
           L       0.86      0.97      0.91       440
           M       0.94      0.99      0.97       440
           N       0.99      0.91      0.95       440
           O       0.92      0.92      0.92       440
           P       0.99      0.98      0.99       440
           Q       0.96      0.98      0.97       440
           R       0.91      0.97      0.94       440
           S       0.90      0.98      0.93       440
           T       0.95      0.98      0.97       434
           U       1.00      0.68      0.81       440
           V       0.81      0.98      0.89       440
           W       0.98      0.98      0.98       441
           Y       0.88      0.98      0.93       440

    accuracy                           0.93      9261
   macro avg       0.93      0.93      0.93      9261
weighted avg       0.93      0.93      0.93      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1351