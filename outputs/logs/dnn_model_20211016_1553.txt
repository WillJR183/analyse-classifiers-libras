[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.8 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_5 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_20 (Dense)             (None, 80)                983120    
_________________________________________________________________
dense_21 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_22 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_23 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 195s 386ms/step - loss: 2.9484 - acc: 0.1240 - val_loss: 2.8442 - val_acc: 0.1774
Epoch 2/100
506/506 [==============================] - 26s 52ms/step - loss: 2.7104 - acc: 0.2545 - val_loss: 2.5636 - val_acc: 0.2804
Epoch 3/100
506/506 [==============================] - 26s 52ms/step - loss: 2.3961 - acc: 0.3571 - val_loss: 2.2315 - val_acc: 0.4189
Epoch 4/100
506/506 [==============================] - 27s 53ms/step - loss: 2.1134 - acc: 0.4205 - val_loss: 1.9911 - val_acc: 0.4429
Epoch 5/100
506/506 [==============================] - 26s 52ms/step - loss: 1.9046 - acc: 0.4668 - val_loss: 1.8193 - val_acc: 0.5050
Epoch 6/100
506/506 [==============================] - 26s 52ms/step - loss: 1.7472 - acc: 0.5098 - val_loss: 1.6649 - val_acc: 0.5716
Epoch 7/100
506/506 [==============================] - 27s 53ms/step - loss: 1.6193 - acc: 0.5509 - val_loss: 1.5537 - val_acc: 0.5463
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5203 - acc: 0.5864 - val_loss: 1.4591 - val_acc: 0.6099
Epoch 9/100
506/506 [==============================] - 27s 53ms/step - loss: 1.4395 - acc: 0.6146 - val_loss: 1.3844 - val_acc: 0.6062
Epoch 10/100
506/506 [==============================] - 27s 53ms/step - loss: 1.3699 - acc: 0.6381 - val_loss: 1.3663 - val_acc: 0.6478
Epoch 11/100
506/506 [==============================] - 28s 55ms/step - loss: 1.3110 - acc: 0.6599 - val_loss: 1.2507 - val_acc: 0.6887
Epoch 12/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2541 - acc: 0.6800 - val_loss: 1.2198 - val_acc: 0.6852
Epoch 13/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2049 - acc: 0.6949 - val_loss: 1.2138 - val_acc: 0.6798
Epoch 14/100
506/506 [==============================] - 26s 52ms/step - loss: 1.1602 - acc: 0.7065 - val_loss: 1.1114 - val_acc: 0.7341
Epoch 15/100
506/506 [==============================] - 21s 42ms/step - loss: 1.1164 - acc: 0.7177 - val_loss: 1.0697 - val_acc: 0.7417
Epoch 16/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0750 - acc: 0.7277 - val_loss: 1.0512 - val_acc: 0.7250
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0394 - acc: 0.7325 - val_loss: 1.0040 - val_acc: 0.7432
Epoch 18/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0012 - acc: 0.7451 - val_loss: 0.9655 - val_acc: 0.7642
Epoch 19/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9667 - acc: 0.7516 - val_loss: 0.9525 - val_acc: 0.7536
Epoch 20/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9366 - acc: 0.7566 - val_loss: 0.9089 - val_acc: 0.7629
Epoch 21/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9073 - acc: 0.7659 - val_loss: 0.8861 - val_acc: 0.7761
Epoch 22/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8782 - acc: 0.7738 - val_loss: 0.8679 - val_acc: 0.7804
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8482 - acc: 0.7800 - val_loss: 0.8371 - val_acc: 0.7882
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8223 - acc: 0.7858 - val_loss: 0.7986 - val_acc: 0.7919
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7970 - acc: 0.7885 - val_loss: 0.7824 - val_acc: 0.7856
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7674 - acc: 0.7951 - val_loss: 0.7471 - val_acc: 0.7999
Epoch 27/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7447 - acc: 0.8002 - val_loss: 0.7286 - val_acc: 0.8051
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7207 - acc: 0.8064 - val_loss: 0.7520 - val_acc: 0.7921
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6968 - acc: 0.8140 - val_loss: 0.7035 - val_acc: 0.8141
Epoch 30/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6793 - acc: 0.8176 - val_loss: 0.6619 - val_acc: 0.8237
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6590 - acc: 0.8227 - val_loss: 0.6434 - val_acc: 0.8354
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6365 - acc: 0.8287 - val_loss: 0.6272 - val_acc: 0.8336
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6221 - acc: 0.8324 - val_loss: 0.6140 - val_acc: 0.8332
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6045 - acc: 0.8341 - val_loss: 0.6140 - val_acc: 0.8425
Epoch 35/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5871 - acc: 0.8411 - val_loss: 0.6130 - val_acc: 0.8356
Epoch 36/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5727 - acc: 0.8439 - val_loss: 0.5633 - val_acc: 0.8553
Epoch 37/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5562 - acc: 0.8473 - val_loss: 0.5648 - val_acc: 0.8483
Epoch 38/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5403 - acc: 0.8530 - val_loss: 0.5528 - val_acc: 0.8455
Epoch 39/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5263 - acc: 0.8572 - val_loss: 0.5442 - val_acc: 0.8527
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5137 - acc: 0.8610 - val_loss: 0.5190 - val_acc: 0.8605
Epoch 41/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4970 - acc: 0.8642 - val_loss: 0.4958 - val_acc: 0.8663
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4866 - acc: 0.8673 - val_loss: 0.4902 - val_acc: 0.8648
Epoch 43/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4749 - acc: 0.8702 - val_loss: 0.4899 - val_acc: 0.8669
Epoch 44/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4612 - acc: 0.8734 - val_loss: 0.4782 - val_acc: 0.8663
Epoch 45/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4500 - acc: 0.8772 - val_loss: 0.4640 - val_acc: 0.8728
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4379 - acc: 0.8805 - val_loss: 0.4625 - val_acc: 0.8767
Epoch 47/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4287 - acc: 0.8838 - val_loss: 0.4352 - val_acc: 0.8817
Epoch 48/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4184 - acc: 0.8866 - val_loss: 0.4235 - val_acc: 0.8860
Epoch 49/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4088 - acc: 0.8867 - val_loss: 0.4251 - val_acc: 0.8821
Epoch 50/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3981 - acc: 0.8918 - val_loss: 0.4086 - val_acc: 0.8914
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3899 - acc: 0.8922 - val_loss: 0.3883 - val_acc: 0.9000
Epoch 52/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3798 - acc: 0.8967 - val_loss: 0.3753 - val_acc: 0.9026
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3733 - acc: 0.8979 - val_loss: 0.3775 - val_acc: 0.8981
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3626 - acc: 0.9019 - val_loss: 0.3869 - val_acc: 0.8959
Epoch 55/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3582 - acc: 0.9014 - val_loss: 0.3758 - val_acc: 0.8972
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3484 - acc: 0.9052 - val_loss: 0.3620 - val_acc: 0.9048
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3400 - acc: 0.9089 - val_loss: 0.3505 - val_acc: 0.9102
Epoch 58/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3322 - acc: 0.9097 - val_loss: 0.3354 - val_acc: 0.9135
Epoch 59/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3264 - acc: 0.9130 - val_loss: 0.3358 - val_acc: 0.9100
Epoch 60/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3184 - acc: 0.9144 - val_loss: 0.3202 - val_acc: 0.9150
Epoch 61/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3124 - acc: 0.9166 - val_loss: 0.3189 - val_acc: 0.9169
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3053 - acc: 0.9189 - val_loss: 0.3234 - val_acc: 0.9132
Epoch 63/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2975 - acc: 0.9208 - val_loss: 0.3173 - val_acc: 0.9154
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2926 - acc: 0.9220 - val_loss: 0.3161 - val_acc: 0.9145
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2850 - acc: 0.9243 - val_loss: 0.3236 - val_acc: 0.9104
Epoch 66/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2788 - acc: 0.9252 - val_loss: 0.2949 - val_acc: 0.9230
Epoch 67/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2745 - acc: 0.9259 - val_loss: 0.3198 - val_acc: 0.9113
Epoch 68/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2710 - acc: 0.9286 - val_loss: 0.2786 - val_acc: 0.9305
Epoch 69/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2642 - acc: 0.9291 - val_loss: 0.2793 - val_acc: 0.9254
Epoch 70/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2597 - acc: 0.9310 - val_loss: 0.2885 - val_acc: 0.9225
Epoch 71/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2533 - acc: 0.9334 - val_loss: 0.2931 - val_acc: 0.9243
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2498 - acc: 0.9334 - val_loss: 0.2642 - val_acc: 0.9288
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2436 - acc: 0.9355 - val_loss: 0.2566 - val_acc: 0.9305

[INFO] Duração do treinamento: 30.2 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 45s 310ms/step - loss: 0.2665 - acc: 0.9255

Perda do teste: 0.267 
Acurácia do Teste: 92.55%

Gerando matriz de confusão tradicional...

[[390   0   0   2  12   0  19   8   0   0   0  16   0   0   0   1   1   0
    0   1   4]
 [  0 408   0   5   0   3   4   8   0   0   0   4   0   0   3   0   7   0
    0   4   0]
 [  0   0 440   0   0   2   1   1   0   0   0   6   0   0   0   0   0   2
    3   0   0]
 [  1   0   1 394   4   3  18   0   1   0   0   0   0   0  17   0   0   1
    0   0   0]
 [  1   4   0  14 391   0  29   2   0   0   0   0   0   0   1   6   0   0
    0   0   2]
 [  0   3   0   4   0 395   0   4   0   0   0  11   0   0   1   0   2   0
    0   1   0]
 [  0   0   0  11   3   3 405   3   3   0   0   3   0   0   7   2   0   0
    0   0   0]
 [  0   3   0  16   2   4   6 380   2   0   0   4   0   0   5   4   3   0
    0   5   6]
 [  0   0   5   0   1   6  12   9 403   0   0   1   0   0   1   0   2   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 435   3   0   0   2   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  35 390   0   0  15   0   0   0   0
    0   0   0]
 [  0   5   9   8   0   7  14   0   0   1   0 388   4   0   0   2   0   1
    0   1   0]
 [  1   0  10   0   0   0   0   0   4   0   0   4 421   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  13   3   0   0 424   0   0   0   0
    0   0   0]
 [  0   2   0   3   0   0   0   0   0   0   0   0   0   0 426   0   0   6
    3   0   0]
 [  3   4   0   0   7   0   9  18   0   0   0   6   0   0   0 387   6   0
    0   0   0]
 [  0   2   0   0   0   3   1   6   0   0   0   1   0   0   0   0 417   0
    0   4   0]
 [  0   2   0   0   0   0   0   0   0   0   0   0   0   0  18   0   0 418
    1   1   0]
 [  0   0   0   2   0   0   0   0   0   0   0   0   0   0   6   0   0  15
  414   3   0]
 [  0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0   0
    3 435   0]
 [  8   0   0   0   0   0   5   3   0   0   0   3   0   0   0   9   2   0
    0   0 410]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.97      0.86      0.91       454
           B       0.94      0.91      0.93       446
           C       0.95      0.97      0.96       455
           D       0.86      0.90      0.88       440
           E       0.93      0.87      0.90       450
           F       0.93      0.94      0.93       421
           G       0.77      0.92      0.84       440
           I       0.85      0.86      0.86       440
           L       0.98      0.92      0.94       440
           M       0.90      0.99      0.94       440
           N       0.98      0.89      0.93       440
           O       0.87      0.88      0.87       440
           P       0.99      0.96      0.97       440
           Q       0.96      0.96      0.96       440
           R       0.88      0.97      0.92       440
           S       0.94      0.88      0.91       440
           T       0.95      0.96      0.95       434
           U       0.94      0.95      0.95       440
           V       0.98      0.94      0.96       440
           W       0.96      0.99      0.97       441
           Y       0.97      0.93      0.95       440

    accuracy                           0.93      9261
   macro avg       0.93      0.93      0.93      9261
weighted avg       0.93      0.93      0.93      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1554