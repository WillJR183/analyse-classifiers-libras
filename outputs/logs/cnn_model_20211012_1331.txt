[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_15 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_15 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_15 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_16 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_16 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_16 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_17 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_17 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_17 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 2048)              0         
_________________________________________________________________
dense_10 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_11 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 225s 444ms/step - loss: 2.9735 - acc: 0.0985 - val_loss: 2.7667 - val_acc: 0.1986
Epoch 2/100
506/506 [==============================] - 56s 111ms/step - loss: 2.3614 - acc: 0.3006 - val_loss: 2.0781 - val_acc: 0.3940
Epoch 3/100
506/506 [==============================] - 56s 110ms/step - loss: 1.7322 - acc: 0.5311 - val_loss: 1.5896 - val_acc: 0.5651
Epoch 4/100
506/506 [==============================] - 56s 112ms/step - loss: 1.3331 - acc: 0.6258 - val_loss: 1.2940 - val_acc: 0.6324
Epoch 5/100
506/506 [==============================] - 57s 112ms/step - loss: 1.0772 - acc: 0.7063 - val_loss: 1.0939 - val_acc: 0.7177
Epoch 6/100
506/506 [==============================] - 57s 112ms/step - loss: 0.9172 - acc: 0.7490 - val_loss: 0.9742 - val_acc: 0.7378
Epoch 7/100
506/506 [==============================] - 57s 112ms/step - loss: 0.8087 - acc: 0.7742 - val_loss: 0.8763 - val_acc: 0.7581
Epoch 8/100
506/506 [==============================] - 56s 112ms/step - loss: 0.7336 - acc: 0.7924 - val_loss: 0.8068 - val_acc: 0.7748
Epoch 9/100
506/506 [==============================] - 56s 112ms/step - loss: 0.6740 - acc: 0.8089 - val_loss: 0.7622 - val_acc: 0.7849
Epoch 10/100
506/506 [==============================] - 56s 112ms/step - loss: 0.6274 - acc: 0.8191 - val_loss: 0.7094 - val_acc: 0.7999
Epoch 11/100
506/506 [==============================] - 56s 111ms/step - loss: 0.5909 - acc: 0.8276 - val_loss: 0.6744 - val_acc: 0.8051
Epoch 12/100
506/506 [==============================] - 56s 112ms/step - loss: 0.5591 - acc: 0.8363 - val_loss: 0.7010 - val_acc: 0.7934
Epoch 13/100
506/506 [==============================] - 57s 112ms/step - loss: 0.5303 - acc: 0.8443 - val_loss: 0.6214 - val_acc: 0.8200
Epoch 14/100
506/506 [==============================] - 57s 112ms/step - loss: 0.5034 - acc: 0.8508 - val_loss: 0.5947 - val_acc: 0.8280
Epoch 15/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4856 - acc: 0.8559 - val_loss: 0.5833 - val_acc: 0.8358
Epoch 16/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4633 - acc: 0.8657 - val_loss: 0.5456 - val_acc: 0.8494
Epoch 17/100
506/506 [==============================] - 57s 112ms/step - loss: 0.4439 - acc: 0.8731 - val_loss: 0.5295 - val_acc: 0.8555
Epoch 18/100
506/506 [==============================] - 57s 113ms/step - loss: 0.4261 - acc: 0.8776 - val_loss: 0.5233 - val_acc: 0.8548
Epoch 19/100
506/506 [==============================] - 57s 112ms/step - loss: 0.4106 - acc: 0.8815 - val_loss: 0.4874 - val_acc: 0.8605
Epoch 20/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3939 - acc: 0.8861 - val_loss: 0.4772 - val_acc: 0.8628
Epoch 21/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3796 - acc: 0.8892 - val_loss: 0.4550 - val_acc: 0.8719
Epoch 22/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3646 - acc: 0.8948 - val_loss: 0.4700 - val_acc: 0.8646
Epoch 23/100
506/506 [==============================] - 56s 112ms/step - loss: 0.3512 - acc: 0.8973 - val_loss: 0.4191 - val_acc: 0.8765
Epoch 24/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3425 - acc: 0.8983 - val_loss: 0.4089 - val_acc: 0.8814
Epoch 25/100
506/506 [==============================] - 56s 112ms/step - loss: 0.3276 - acc: 0.9019 - val_loss: 0.3843 - val_acc: 0.8860
Epoch 26/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3152 - acc: 0.9048 - val_loss: 0.3826 - val_acc: 0.8823
Epoch 27/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3011 - acc: 0.9094 - val_loss: 0.3609 - val_acc: 0.8929
Epoch 28/100
506/506 [==============================] - 59s 117ms/step - loss: 0.2898 - acc: 0.9123 - val_loss: 0.3484 - val_acc: 0.8966
Epoch 29/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2797 - acc: 0.9150 - val_loss: 0.4076 - val_acc: 0.8723
Epoch 30/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2699 - acc: 0.9177 - val_loss: 0.3167 - val_acc: 0.9065
Epoch 31/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2570 - acc: 0.9213 - val_loss: 0.3126 - val_acc: 0.9046
Epoch 32/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2502 - acc: 0.9231 - val_loss: 0.3117 - val_acc: 0.9046
Epoch 33/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2391 - acc: 0.9275 - val_loss: 0.2915 - val_acc: 0.9132
Epoch 34/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2304 - acc: 0.9279 - val_loss: 0.2862 - val_acc: 0.9141
Epoch 35/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2224 - acc: 0.9316 - val_loss: 0.2670 - val_acc: 0.9193
Epoch 36/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2140 - acc: 0.9342 - val_loss: 0.2844 - val_acc: 0.9122
Epoch 37/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2053 - acc: 0.9366 - val_loss: 0.2569 - val_acc: 0.9202
Epoch 38/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1973 - acc: 0.9392 - val_loss: 0.2394 - val_acc: 0.9271
Epoch 39/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1907 - acc: 0.9410 - val_loss: 0.2577 - val_acc: 0.9191
Epoch 40/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1848 - acc: 0.9431 - val_loss: 0.2271 - val_acc: 0.9303
Epoch 41/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1788 - acc: 0.9455 - val_loss: 0.2414 - val_acc: 0.9228
Epoch 42/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1697 - acc: 0.9479 - val_loss: 0.2247 - val_acc: 0.9310
Epoch 43/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1676 - acc: 0.9485 - val_loss: 0.2073 - val_acc: 0.9375
Epoch 44/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1576 - acc: 0.9518 - val_loss: 0.2056 - val_acc: 0.9362
Epoch 45/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1536 - acc: 0.9526 - val_loss: 0.1885 - val_acc: 0.9435
Epoch 46/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1452 - acc: 0.9553 - val_loss: 0.1965 - val_acc: 0.9390
Epoch 47/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1433 - acc: 0.9559 - val_loss: 0.1888 - val_acc: 0.9392
Epoch 48/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1395 - acc: 0.9567 - val_loss: 0.1872 - val_acc: 0.9401
Epoch 49/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1319 - acc: 0.9603 - val_loss: 0.1736 - val_acc: 0.9468
Epoch 50/100
506/506 [==============================] - 57s 113ms/step - loss: 0.1259 - acc: 0.9628 - val_loss: 0.1761 - val_acc: 0.9448
Epoch 51/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1217 - acc: 0.9631 - val_loss: 0.1663 - val_acc: 0.9511
Epoch 52/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1172 - acc: 0.9644 - val_loss: 0.1619 - val_acc: 0.9461
Epoch 53/100
506/506 [==============================] - 55s 108ms/step - loss: 0.1139 - acc: 0.9659 - val_loss: 0.1542 - val_acc: 0.9524
Epoch 54/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1096 - acc: 0.9668 - val_loss: 0.1535 - val_acc: 0.9505
Epoch 55/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1057 - acc: 0.9692 - val_loss: 0.1454 - val_acc: 0.9574
Epoch 56/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1002 - acc: 0.9701 - val_loss: 0.1555 - val_acc: 0.9502
Epoch 57/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0989 - acc: 0.9701 - val_loss: 0.1364 - val_acc: 0.9556
Epoch 58/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0940 - acc: 0.9726 - val_loss: 0.1420 - val_acc: 0.9559
Epoch 59/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0921 - acc: 0.9724 - val_loss: 0.1327 - val_acc: 0.9589
Epoch 60/100
506/506 [==============================] - 60s 118ms/step - loss: 0.0900 - acc: 0.9741 - val_loss: 0.1266 - val_acc: 0.9611
Epoch 61/100
506/506 [==============================] - 66s 131ms/step - loss: 0.0844 - acc: 0.9749 - val_loss: 0.1259 - val_acc: 0.9595
Epoch 62/100
506/506 [==============================] - 58s 114ms/step - loss: 0.0832 - acc: 0.9757 - val_loss: 0.1279 - val_acc: 0.9628
Epoch 63/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0798 - acc: 0.9763 - val_loss: 0.1273 - val_acc: 0.9585
Epoch 64/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0770 - acc: 0.9767 - val_loss: 0.1103 - val_acc: 0.9665
Epoch 65/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0775 - acc: 0.9767 - val_loss: 0.1318 - val_acc: 0.9593
Epoch 66/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0732 - acc: 0.9783 - val_loss: 0.1112 - val_acc: 0.9630
Epoch 67/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0698 - acc: 0.9795 - val_loss: 0.1032 - val_acc: 0.9710
Epoch 68/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0687 - acc: 0.9792 - val_loss: 0.1046 - val_acc: 0.9675
Epoch 69/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0658 - acc: 0.9808 - val_loss: 0.1043 - val_acc: 0.9717
Epoch 70/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0629 - acc: 0.9817 - val_loss: 0.0982 - val_acc: 0.9693
Epoch 71/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0596 - acc: 0.9824 - val_loss: 0.0993 - val_acc: 0.9695
Epoch 72/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0621 - acc: 0.9812 - val_loss: 0.0987 - val_acc: 0.9706
Epoch 73/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0578 - acc: 0.9831 - val_loss: 0.0908 - val_acc: 0.9745
Epoch 74/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0560 - acc: 0.9831 - val_loss: 0.0931 - val_acc: 0.9743
Epoch 75/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0549 - acc: 0.9836 - val_loss: 0.0831 - val_acc: 0.9749
Epoch 76/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0525 - acc: 0.9845 - val_loss: 0.0908 - val_acc: 0.9766
Epoch 77/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0478 - acc: 0.9864 - val_loss: 0.0831 - val_acc: 0.9779
Epoch 78/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0477 - acc: 0.9871 - val_loss: 0.0806 - val_acc: 0.9773
Epoch 79/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0455 - acc: 0.9874 - val_loss: 0.0789 - val_acc: 0.9792
Epoch 80/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0455 - acc: 0.9873 - val_loss: 0.1077 - val_acc: 0.9697
Epoch 81/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0452 - acc: 0.9871 - val_loss: 0.0837 - val_acc: 0.9749
Epoch 82/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0401 - acc: 0.9891 - val_loss: 0.0789 - val_acc: 0.9790
Epoch 83/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0400 - acc: 0.9888 - val_loss: 0.0843 - val_acc: 0.9768
Epoch 84/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0379 - acc: 0.9899 - val_loss: 0.0831 - val_acc: 0.9762

[INFO] Duração do treinamento: 82.1 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 57s 394ms/step - loss: 0.0578 - acc: 0.9819

Perda do teste: 0.058 
Acurácia do Teste: 98.19%

Gerando matriz de confusão tradicional...

[[443   0   1   0   2   0   3   0   0   0   0   0   0   0   0   2   0   0
    0   0   3]
 [  1 430   0   0   6   1   0   1   0   1   0   0   0   1   0   3   0   2
    0   0   0]
 [  0   0 454   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   1]
 [  0   0   0 426   0   0   9   0   3   0   0   0   0   0   0   0   0   1
    1   0   0]
 [  1   6   1   2 437   0   0   0   1   0   0   0   0   0   0   0   0   2
    0   0   0]
 [  0   0   0   0   0 418   0   0   0   0   0   3   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   4   0   0 430   0   2   0   0   1   0   0   0   0   0   0
    3   0   0]
 [  0   0   0   5   0   0  10 418   0   0   0   3   0   0   0   1   0   1
    0   0   2]
 [  0   0   0   0   0   0   0   0 440   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 431   9   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 437   0   2   1   0   0   0   0
    0   0   0]
 [  0   0   7   0   0   1   2   1   0   0   0 427   1   0   0   0   0   0
    1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0 439   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0  18   0   0   0   0   0   0   0 416   0   0   1
    4   0   0]
 [  6   0   0   0   0   0   0   1   0   0   0   0   0   0   0 430   1   0
    0   0   2]
 [  0   0   0   0   0  15   0   0   0   0   0   0   0   0   0   0 419   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 440
    0   0   0]
 [  0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0
  439   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    2 439   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 440]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.98      0.98      0.98       454
           B       0.99      0.96      0.98       446
           C       0.98      1.00      0.99       455
           D       0.97      0.97      0.97       440
           E       0.98      0.97      0.98       450
           F       0.96      0.99      0.98       421
           G       0.91      0.98      0.94       440
           I       0.99      0.95      0.97       440
           L       0.98      1.00      0.99       440
           M       1.00      0.98      0.99       440
           N       0.98      0.99      0.99       440
           O       0.98      0.97      0.98       440
           P       0.99      1.00      1.00       440
           Q       1.00      1.00      1.00       440
           R       1.00      0.95      0.97       440
           S       0.99      0.98      0.98       440
           T       1.00      0.97      0.98       434
           U       0.98      1.00      0.99       440
           V       0.98      1.00      0.99       440
           W       1.00      1.00      1.00       441
           Y       0.98      1.00      0.99       440

    accuracy                           0.98      9261
   macro avg       0.98      0.98      0.98      9261
weighted avg       0.98      0.98      0.98      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_1332