[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 9.9 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            (None, 12288)             0         
_________________________________________________________________
dense (Dense)                (None, 80)                983120    
_________________________________________________________________
dense_1 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_2 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_3 (Dense)              (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 228s 451ms/step - loss: 2.9485 - acc: 0.1204 - val_loss: 2.8516 - val_acc: 0.1917
Epoch 2/100
506/506 [==============================] - 27s 53ms/step - loss: 2.7271 - acc: 0.2271 - val_loss: 2.5786 - val_acc: 0.3116
Epoch 3/100
506/506 [==============================] - 27s 53ms/step - loss: 2.4184 - acc: 0.3513 - val_loss: 2.2508 - val_acc: 0.4115
Epoch 4/100
506/506 [==============================] - 27s 54ms/step - loss: 2.1204 - acc: 0.4470 - val_loss: 1.9986 - val_acc: 0.4585
Epoch 5/100
506/506 [==============================] - 26s 52ms/step - loss: 1.8996 - acc: 0.4945 - val_loss: 1.8059 - val_acc: 0.5188
Epoch 6/100
506/506 [==============================] - 28s 55ms/step - loss: 1.7279 - acc: 0.5394 - val_loss: 1.6655 - val_acc: 0.5422
Epoch 7/100
506/506 [==============================] - 27s 53ms/step - loss: 1.5925 - acc: 0.5768 - val_loss: 1.5538 - val_acc: 0.5896
Epoch 8/100
506/506 [==============================] - 29s 56ms/step - loss: 1.4871 - acc: 0.6072 - val_loss: 1.4624 - val_acc: 0.5995
Epoch 9/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3947 - acc: 0.6330 - val_loss: 1.3471 - val_acc: 0.6497
Epoch 10/100
506/506 [==============================] - 23s 45ms/step - loss: 1.3244 - acc: 0.6546 - val_loss: 1.2871 - val_acc: 0.6597
Epoch 11/100
506/506 [==============================] - 22s 43ms/step - loss: 1.2580 - acc: 0.6755 - val_loss: 1.2463 - val_acc: 0.6895
Epoch 12/100
506/506 [==============================] - 21s 42ms/step - loss: 1.2046 - acc: 0.6921 - val_loss: 1.2033 - val_acc: 0.6926
Epoch 13/100
506/506 [==============================] - 22s 44ms/step - loss: 1.1524 - acc: 0.7086 - val_loss: 1.1421 - val_acc: 0.6939
Epoch 14/100
506/506 [==============================] - 22s 43ms/step - loss: 1.1096 - acc: 0.7183 - val_loss: 1.0931 - val_acc: 0.7066
Epoch 15/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0665 - acc: 0.7274 - val_loss: 1.0652 - val_acc: 0.7181
Epoch 16/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0315 - acc: 0.7382 - val_loss: 1.0171 - val_acc: 0.7326
Epoch 17/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9947 - acc: 0.7482 - val_loss: 0.9748 - val_acc: 0.7456
Epoch 18/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9618 - acc: 0.7558 - val_loss: 0.9378 - val_acc: 0.7585
Epoch 19/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9323 - acc: 0.7598 - val_loss: 0.9094 - val_acc: 0.7683
Epoch 20/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9028 - acc: 0.7694 - val_loss: 0.8840 - val_acc: 0.7733
Epoch 21/100
506/506 [==============================] - 22s 44ms/step - loss: 0.8767 - acc: 0.7758 - val_loss: 0.9010 - val_acc: 0.7666
Epoch 22/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8473 - acc: 0.7828 - val_loss: 0.8751 - val_acc: 0.7635
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8244 - acc: 0.7886 - val_loss: 0.8399 - val_acc: 0.7817
Epoch 24/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8013 - acc: 0.7923 - val_loss: 0.8034 - val_acc: 0.7897
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7781 - acc: 0.7979 - val_loss: 0.8115 - val_acc: 0.7847
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7518 - acc: 0.8045 - val_loss: 0.7318 - val_acc: 0.8074
Epoch 27/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7319 - acc: 0.8088 - val_loss: 0.7401 - val_acc: 0.8018
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7124 - acc: 0.8127 - val_loss: 0.7212 - val_acc: 0.8092
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6936 - acc: 0.8186 - val_loss: 0.6875 - val_acc: 0.8215
Epoch 30/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6782 - acc: 0.8200 - val_loss: 0.6984 - val_acc: 0.8124
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6596 - acc: 0.8260 - val_loss: 0.6913 - val_acc: 0.8025
Epoch 32/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6398 - acc: 0.8304 - val_loss: 0.6429 - val_acc: 0.8263
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6249 - acc: 0.8341 - val_loss: 0.6285 - val_acc: 0.8263
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6082 - acc: 0.8384 - val_loss: 0.6243 - val_acc: 0.8284
Epoch 35/100
506/506 [==============================] - 22s 44ms/step - loss: 0.5938 - acc: 0.8430 - val_loss: 0.6011 - val_acc: 0.8397
Epoch 36/100
506/506 [==============================] - 22s 44ms/step - loss: 0.5786 - acc: 0.8460 - val_loss: 0.5703 - val_acc: 0.8496
Epoch 37/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5651 - acc: 0.8485 - val_loss: 0.5663 - val_acc: 0.8468
Epoch 38/100
506/506 [==============================] - 22s 44ms/step - loss: 0.5522 - acc: 0.8513 - val_loss: 0.5575 - val_acc: 0.8579
Epoch 39/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5376 - acc: 0.8559 - val_loss: 0.5654 - val_acc: 0.8511
Epoch 40/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5266 - acc: 0.8580 - val_loss: 0.5417 - val_acc: 0.8488
Epoch 41/100
506/506 [==============================] - 22s 44ms/step - loss: 0.5135 - acc: 0.8620 - val_loss: 0.5122 - val_acc: 0.8646
Epoch 42/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4999 - acc: 0.8675 - val_loss: 0.4972 - val_acc: 0.8667
Epoch 43/100
506/506 [==============================] - 22s 44ms/step - loss: 0.4935 - acc: 0.8677 - val_loss: 0.4942 - val_acc: 0.8717
Epoch 44/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4805 - acc: 0.8715 - val_loss: 0.5127 - val_acc: 0.8561
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4725 - acc: 0.8738 - val_loss: 0.4777 - val_acc: 0.8736
Epoch 46/100
506/506 [==============================] - 22s 44ms/step - loss: 0.4610 - acc: 0.8770 - val_loss: 0.4729 - val_acc: 0.8760
Epoch 47/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4532 - acc: 0.8789 - val_loss: 0.4728 - val_acc: 0.8674
Epoch 48/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4427 - acc: 0.8822 - val_loss: 0.4521 - val_acc: 0.8767
Epoch 49/100
506/506 [==============================] - 22s 44ms/step - loss: 0.4345 - acc: 0.8844 - val_loss: 0.4649 - val_acc: 0.8704
Epoch 50/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4270 - acc: 0.8871 - val_loss: 0.4371 - val_acc: 0.8823
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4165 - acc: 0.8901 - val_loss: 0.4572 - val_acc: 0.8739
Epoch 52/100
506/506 [==============================] - 22s 44ms/step - loss: 0.4110 - acc: 0.8892 - val_loss: 0.4175 - val_acc: 0.8851
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4027 - acc: 0.8932 - val_loss: 0.3953 - val_acc: 0.8929
Epoch 54/100
506/506 [==============================] - 22s 44ms/step - loss: 0.3955 - acc: 0.8952 - val_loss: 0.4125 - val_acc: 0.8873
Epoch 55/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3874 - acc: 0.8964 - val_loss: 0.4093 - val_acc: 0.8834
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3807 - acc: 0.9002 - val_loss: 0.3945 - val_acc: 0.8985
Epoch 57/100
506/506 [==============================] - 22s 44ms/step - loss: 0.3747 - acc: 0.9002 - val_loss: 0.3773 - val_acc: 0.8918
Epoch 58/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3642 - acc: 0.9035 - val_loss: 0.3727 - val_acc: 0.8983
Epoch 59/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3573 - acc: 0.9064 - val_loss: 0.3870 - val_acc: 0.8929
Epoch 60/100
506/506 [==============================] - 22s 44ms/step - loss: 0.3509 - acc: 0.9071 - val_loss: 0.3565 - val_acc: 0.9057
Epoch 61/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3452 - acc: 0.9095 - val_loss: 0.3455 - val_acc: 0.9063
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3408 - acc: 0.9099 - val_loss: 0.3481 - val_acc: 0.9048
Epoch 63/100
506/506 [==============================] - 24s 47ms/step - loss: 0.3326 - acc: 0.9129 - val_loss: 0.3538 - val_acc: 0.9042
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3291 - acc: 0.9133 - val_loss: 0.3390 - val_acc: 0.9059
Epoch 65/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3223 - acc: 0.9144 - val_loss: 0.3359 - val_acc: 0.9093
Epoch 66/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3170 - acc: 0.9179 - val_loss: 0.3160 - val_acc: 0.9152
Epoch 67/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3120 - acc: 0.9178 - val_loss: 0.3268 - val_acc: 0.9098
Epoch 68/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3053 - acc: 0.9197 - val_loss: 0.3123 - val_acc: 0.9128
Epoch 69/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3003 - acc: 0.9207 - val_loss: 0.3247 - val_acc: 0.9065
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2944 - acc: 0.9244 - val_loss: 0.3081 - val_acc: 0.9189
Epoch 71/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2906 - acc: 0.9240 - val_loss: 0.3010 - val_acc: 0.9176
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2860 - acc: 0.9259 - val_loss: 0.2939 - val_acc: 0.9217
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2811 - acc: 0.9276 - val_loss: 0.2856 - val_acc: 0.9232
Epoch 74/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2770 - acc: 0.9278 - val_loss: 0.2966 - val_acc: 0.9208
Epoch 75/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2730 - acc: 0.9304 - val_loss: 0.2994 - val_acc: 0.9174
Epoch 76/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2651 - acc: 0.9312 - val_loss: 0.3394 - val_acc: 0.9050
Epoch 77/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2633 - acc: 0.9320 - val_loss: 0.2791 - val_acc: 0.9238
Epoch 78/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2612 - acc: 0.9312 - val_loss: 0.2695 - val_acc: 0.9290
Epoch 79/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2539 - acc: 0.9347 - val_loss: 0.2715 - val_acc: 0.9230
Epoch 80/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2507 - acc: 0.9358 - val_loss: 0.2668 - val_acc: 0.9273
Epoch 81/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2465 - acc: 0.9366 - val_loss: 0.2719 - val_acc: 0.9264
Epoch 82/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2422 - acc: 0.9385 - val_loss: 0.2604 - val_acc: 0.9299
Epoch 83/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2422 - acc: 0.9377 - val_loss: 0.2487 - val_acc: 0.9338
Epoch 84/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2353 - acc: 0.9401 - val_loss: 0.2395 - val_acc: 0.9386
Epoch 85/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2319 - acc: 0.9400 - val_loss: 0.2526 - val_acc: 0.9299
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2277 - acc: 0.9422 - val_loss: 0.2576 - val_acc: 0.9321
Epoch 87/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2232 - acc: 0.9442 - val_loss: 0.2465 - val_acc: 0.9336
Epoch 88/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2205 - acc: 0.9439 - val_loss: 0.2314 - val_acc: 0.9375
Epoch 89/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2165 - acc: 0.9452 - val_loss: 0.2573 - val_acc: 0.9290

[INFO] Duração do treinamento: 36.5 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 52s 360ms/step - loss: 0.2547 - acc: 0.9321

Perda do teste: 0.255 
Acurácia do Teste: 93.21%

Gerando matriz de confusão tradicional...

[[426   4   0   6   5   0   0   0   1   0   0   0   0   0   0   7   0   0
    0   0   5]
 [  0 406   0  18   4   0   0   9   0   0   0   2   0   0   0   4   1   0
    0   2   0]
 [  0   0 433   3   2   2   0   0   0   0   0   6   5   1   0   0   0   1
    1   1   0]
 [  2   0   0 430   3   0   3   0   2   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  6   2   0  16 414   0   1   4   0   0   0   0   0   0   0   3   0   0
    0   0   4]
 [  0  12   0  12   1 381   0   3   1   0   0   0   0   0   0   0   8   0
    0   2   1]
 [  1   0   0  49   3   0 365   3   1   0   0   0   0   0   6   8   2   0
    1   0   1]
 [  0   1   0  30   3   3   0 385   0   0   0   0   0   0   1  10   3   0
    0   3   1]
 [  6   0   1   6   1   2   8   4 408   0   0   2   0   0   1   1   0   0
    0   0   0]
 [  0   0   2   0   0   0   0   0   0 425   7   0   0   6   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 435   0   0   5   0   0   0   0
    0   0   0]
 [  7   2   0  13   3  12   0   7   3   0   0 382   4   0   0   0   0   0
    0   4   3]
 [  3   0   1   0   0   0   0   0   0   0   0   0 436   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   5   0   0 433   0   0   0   0
    0   0   0]
 [  0   0   0  21   0   0   4   0   0   0   0   0   0   0 406   0   0   0
    9   0   0]
 [  3   4   0   2   6   0   0   7   0   0   0   1   0   0   0 417   0   0
    0   0   0]
 [  0  11   0   1   2   6   0   3   1   0   0   0   0   0   0   0 405   0
    0   2   3]
 [  0   3   0   0   0   0   0   0   0   0   0   0   0   0  18   0   0 362
   52   5   0]
 [  0   0   0   2   0   0   0   4   0   0   0   0   0   0   3   0   0   1
  427   3   0]
 [  0   0   0   4   0   0   0   1   0   0   0   0   0   0   1   0   0   0
    0 435   0]
 [  2   0   0   4   3   0   0   2   0   0   0   0   0   0   0   7   1   0
    0   0 421]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.93      0.94      0.94       454
           B       0.91      0.91      0.91       446
           C       0.99      0.95      0.97       455
           D       0.70      0.98      0.81       440
           E       0.92      0.92      0.92       450
           F       0.94      0.90      0.92       421
           G       0.96      0.83      0.89       440
           I       0.89      0.88      0.88       440
           L       0.98      0.93      0.95       440
           M       1.00      0.97      0.98       440
           N       0.97      0.99      0.98       440
           O       0.97      0.87      0.92       440
           P       0.98      0.99      0.99       440
           Q       0.97      0.98      0.98       440
           R       0.93      0.92      0.93       440
           S       0.91      0.95      0.93       440
           T       0.96      0.93      0.95       434
           U       0.99      0.82      0.90       440
           V       0.87      0.97      0.92       440
           W       0.95      0.99      0.97       441
           Y       0.96      0.96      0.96       440

    accuracy                           0.93      9261
   macro avg       0.94      0.93      0.93      9261
weighted avg       0.94      0.93      0.93      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211014_2102