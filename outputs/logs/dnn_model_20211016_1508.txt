[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 7.9 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_4 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_16 (Dense)             (None, 80)                983120    
_________________________________________________________________
dense_17 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_18 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_19 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 202s 399ms/step - loss: 2.9326 - acc: 0.1608 - val_loss: 2.8055 - val_acc: 0.2244
Epoch 2/100
506/506 [==============================] - 28s 56ms/step - loss: 2.6392 - acc: 0.2892 - val_loss: 2.4556 - val_acc: 0.3295
Epoch 3/100
506/506 [==============================] - 27s 52ms/step - loss: 2.2741 - acc: 0.4124 - val_loss: 2.1045 - val_acc: 0.4505
Epoch 4/100
506/506 [==============================] - 27s 52ms/step - loss: 1.9958 - acc: 0.4818 - val_loss: 1.8584 - val_acc: 0.4996
Epoch 5/100
506/506 [==============================] - 26s 52ms/step - loss: 1.7980 - acc: 0.5344 - val_loss: 1.7195 - val_acc: 0.5450
Epoch 6/100
506/506 [==============================] - 26s 52ms/step - loss: 1.6522 - acc: 0.5755 - val_loss: 1.5628 - val_acc: 0.5736
Epoch 7/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5377 - acc: 0.6068 - val_loss: 1.4587 - val_acc: 0.6434
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.4430 - acc: 0.6333 - val_loss: 1.3736 - val_acc: 0.6476
Epoch 9/100
506/506 [==============================] - 27s 53ms/step - loss: 1.3603 - acc: 0.6604 - val_loss: 1.3001 - val_acc: 0.6718
Epoch 10/100
506/506 [==============================] - 27s 53ms/step - loss: 1.2901 - acc: 0.6767 - val_loss: 1.2317 - val_acc: 0.6889
Epoch 11/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2270 - acc: 0.6930 - val_loss: 1.1904 - val_acc: 0.6952
Epoch 12/100
506/506 [==============================] - 22s 43ms/step - loss: 1.1711 - acc: 0.7073 - val_loss: 1.1350 - val_acc: 0.7034
Epoch 13/100
506/506 [==============================] - 22s 43ms/step - loss: 1.1205 - acc: 0.7180 - val_loss: 1.0893 - val_acc: 0.7170
Epoch 14/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0732 - acc: 0.7282 - val_loss: 1.0328 - val_acc: 0.7380
Epoch 15/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0322 - acc: 0.7384 - val_loss: 1.0017 - val_acc: 0.7492
Epoch 16/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9899 - acc: 0.7479 - val_loss: 0.9571 - val_acc: 0.7629
Epoch 17/100
506/506 [==============================] - 22s 43ms/step - loss: 0.9548 - acc: 0.7555 - val_loss: 0.9464 - val_acc: 0.7566
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9196 - acc: 0.7645 - val_loss: 0.8939 - val_acc: 0.7795
Epoch 19/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8876 - acc: 0.7742 - val_loss: 0.8557 - val_acc: 0.7891
Epoch 20/100
506/506 [==============================] - 22s 44ms/step - loss: 0.8581 - acc: 0.7798 - val_loss: 0.8757 - val_acc: 0.7845
Epoch 21/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8288 - acc: 0.7869 - val_loss: 0.8080 - val_acc: 0.8027
Epoch 22/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8025 - acc: 0.7915 - val_loss: 0.7885 - val_acc: 0.8018
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7755 - acc: 0.7978 - val_loss: 0.7833 - val_acc: 0.8064
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7502 - acc: 0.8052 - val_loss: 0.7289 - val_acc: 0.8213
Epoch 25/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7272 - acc: 0.8106 - val_loss: 0.7179 - val_acc: 0.8198
Epoch 26/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7047 - acc: 0.8180 - val_loss: 0.7287 - val_acc: 0.8055
Epoch 27/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6797 - acc: 0.8237 - val_loss: 0.6655 - val_acc: 0.8369
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6595 - acc: 0.8281 - val_loss: 0.6745 - val_acc: 0.8228
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6375 - acc: 0.8336 - val_loss: 0.6304 - val_acc: 0.8451
Epoch 30/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6222 - acc: 0.8371 - val_loss: 0.6149 - val_acc: 0.8425
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6047 - acc: 0.8425 - val_loss: 0.5960 - val_acc: 0.8455
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5847 - acc: 0.8482 - val_loss: 0.5917 - val_acc: 0.8490
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5703 - acc: 0.8513 - val_loss: 0.5646 - val_acc: 0.8598
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5526 - acc: 0.8556 - val_loss: 0.5560 - val_acc: 0.8607
Epoch 35/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5374 - acc: 0.8597 - val_loss: 0.5516 - val_acc: 0.8574
Epoch 36/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5245 - acc: 0.8632 - val_loss: 0.5429 - val_acc: 0.8630
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5097 - acc: 0.8671 - val_loss: 0.5184 - val_acc: 0.8672
Epoch 38/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4981 - acc: 0.8709 - val_loss: 0.5060 - val_acc: 0.8702
Epoch 39/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4848 - acc: 0.8732 - val_loss: 0.5224 - val_acc: 0.8561
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4754 - acc: 0.8744 - val_loss: 0.5179 - val_acc: 0.8559
Epoch 41/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4610 - acc: 0.8797 - val_loss: 0.4816 - val_acc: 0.8700
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4526 - acc: 0.8806 - val_loss: 0.4574 - val_acc: 0.8868
Epoch 43/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4421 - acc: 0.8833 - val_loss: 0.4425 - val_acc: 0.8849
Epoch 44/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4298 - acc: 0.8871 - val_loss: 0.4361 - val_acc: 0.8892
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4209 - acc: 0.8881 - val_loss: 0.4170 - val_acc: 0.8970
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4120 - acc: 0.8928 - val_loss: 0.4456 - val_acc: 0.8834
Epoch 47/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4011 - acc: 0.8959 - val_loss: 0.4282 - val_acc: 0.8905
Epoch 48/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3936 - acc: 0.8968 - val_loss: 0.4179 - val_acc: 0.8897
Epoch 49/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3831 - acc: 0.8996 - val_loss: 0.3950 - val_acc: 0.8972
Epoch 50/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3757 - acc: 0.9021 - val_loss: 0.3917 - val_acc: 0.8990
Epoch 51/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3681 - acc: 0.9040 - val_loss: 0.4340 - val_acc: 0.8832
Epoch 52/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3624 - acc: 0.9058 - val_loss: 0.3765 - val_acc: 0.9029
Epoch 53/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3533 - acc: 0.9085 - val_loss: 0.4097 - val_acc: 0.8877
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3490 - acc: 0.9081 - val_loss: 0.3711 - val_acc: 0.9050
Epoch 55/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3399 - acc: 0.9101 - val_loss: 0.3509 - val_acc: 0.9119
Epoch 56/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3329 - acc: 0.9128 - val_loss: 0.3561 - val_acc: 0.9117
Epoch 57/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3262 - acc: 0.9149 - val_loss: 0.3379 - val_acc: 0.9122
Epoch 58/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3196 - acc: 0.9173 - val_loss: 0.3505 - val_acc: 0.9072
Epoch 59/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3144 - acc: 0.9173 - val_loss: 0.3369 - val_acc: 0.9113
Epoch 60/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3098 - acc: 0.9181 - val_loss: 0.3405 - val_acc: 0.9096
Epoch 61/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3027 - acc: 0.9215 - val_loss: 0.3364 - val_acc: 0.9098
Epoch 62/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2993 - acc: 0.9212 - val_loss: 0.3067 - val_acc: 0.9219
Epoch 63/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2933 - acc: 0.9233 - val_loss: 0.3024 - val_acc: 0.9208
Epoch 64/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2880 - acc: 0.9253 - val_loss: 0.2983 - val_acc: 0.9228
Epoch 65/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2823 - acc: 0.9267 - val_loss: 0.2942 - val_acc: 0.9228
Epoch 66/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2758 - acc: 0.9286 - val_loss: 0.2992 - val_acc: 0.9197
Epoch 67/100
506/506 [==============================] - 22s 42ms/step - loss: 0.2714 - acc: 0.9293 - val_loss: 0.2844 - val_acc: 0.9254
Epoch 68/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2653 - acc: 0.9312 - val_loss: 0.2871 - val_acc: 0.9251
Epoch 69/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2635 - acc: 0.9324 - val_loss: 0.2769 - val_acc: 0.9277
Epoch 70/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2539 - acc: 0.9353 - val_loss: 0.3022 - val_acc: 0.9167
Epoch 71/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2531 - acc: 0.9351 - val_loss: 0.2837 - val_acc: 0.9275
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2506 - acc: 0.9363 - val_loss: 0.2807 - val_acc: 0.9223
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2461 - acc: 0.9367 - val_loss: 0.2716 - val_acc: 0.9280
Epoch 74/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2414 - acc: 0.9387 - val_loss: 0.2611 - val_acc: 0.9334
Epoch 75/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2369 - acc: 0.9390 - val_loss: 0.2736 - val_acc: 0.9280
Epoch 76/100
506/506 [==============================] - 22s 42ms/step - loss: 0.2331 - acc: 0.9393 - val_loss: 0.2522 - val_acc: 0.9357
Epoch 77/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2300 - acc: 0.9411 - val_loss: 0.2421 - val_acc: 0.9364
Epoch 78/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2250 - acc: 0.9421 - val_loss: 0.2401 - val_acc: 0.9394
Epoch 79/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2225 - acc: 0.9439 - val_loss: 0.2474 - val_acc: 0.9375
Epoch 80/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2180 - acc: 0.9451 - val_loss: 0.2340 - val_acc: 0.9396
Epoch 81/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2154 - acc: 0.9462 - val_loss: 0.2460 - val_acc: 0.9375
Epoch 82/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2116 - acc: 0.9460 - val_loss: 0.2423 - val_acc: 0.9349
Epoch 83/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2095 - acc: 0.9460 - val_loss: 0.2422 - val_acc: 0.9366
Epoch 84/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2054 - acc: 0.9477 - val_loss: 0.2209 - val_acc: 0.9455
Epoch 85/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2008 - acc: 0.9503 - val_loss: 0.2302 - val_acc: 0.9420
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1973 - acc: 0.9504 - val_loss: 0.2270 - val_acc: 0.9405
Epoch 87/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1954 - acc: 0.9511 - val_loss: 0.2561 - val_acc: 0.9293
Epoch 88/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1932 - acc: 0.9509 - val_loss: 0.2207 - val_acc: 0.9418
Epoch 89/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1906 - acc: 0.9525 - val_loss: 0.2034 - val_acc: 0.9505
Epoch 90/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1868 - acc: 0.9537 - val_loss: 0.2120 - val_acc: 0.9459
Epoch 91/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1838 - acc: 0.9544 - val_loss: 0.2057 - val_acc: 0.9479
Epoch 92/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1817 - acc: 0.9550 - val_loss: 0.2089 - val_acc: 0.9483
Epoch 93/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1791 - acc: 0.9552 - val_loss: 0.2026 - val_acc: 0.9487
Epoch 94/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1749 - acc: 0.9573 - val_loss: 0.2079 - val_acc: 0.9515
Epoch 95/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1781 - acc: 0.9543 - val_loss: 0.1911 - val_acc: 0.9526
Epoch 96/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1712 - acc: 0.9571 - val_loss: 0.2086 - val_acc: 0.9457
Epoch 97/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1709 - acc: 0.9572 - val_loss: 0.1964 - val_acc: 0.9511
Epoch 98/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1646 - acc: 0.9597 - val_loss: 0.2058 - val_acc: 0.9468
Epoch 99/100
506/506 [==============================] - 22s 42ms/step - loss: 0.1628 - acc: 0.9599 - val_loss: 0.2119 - val_acc: 0.9427
Epoch 100/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1611 - acc: 0.9599 - val_loss: 0.1769 - val_acc: 0.9576

[INFO] Duração do treinamento: 39.8 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 46s 316ms/step - loss: 0.1803 - acc: 0.9550

Perda do teste: 0.180 
Acurácia do Teste: 95.50%

Gerando matriz de confusão tradicional...

[[436   1   0   0   6   0   0   0   1   0   0   4   0   0   0   5   0   0
    0   1   0]
 [  1 425   0   7   3   0   0   4   3   0   0   0   0   0   0   0   2   1
    0   0   0]
 [  0   0 448   0   0   0   2   0   0   0   0   2   0   0   0   0   1   0
    0   1   1]
 [  1   0   0 417  10   1   3   1   4   0   0   0   0   0   1   0   0   0
    2   0   0]
 [  3   3   0   2 424   0   4   5   6   0   0   1   0   0   0   2   0   0
    0   0   0]
 [  2   8   0   0   0 391   1   5   2   0   0   4   0   0   0   0   8   0
    0   0   0]
 [  0   0   1   8   3   2 401   8   6   0   0   3   0   0   0   5   2   0
    0   1   0]
 [  5   4   0   6   6   4   0 395   2   0   0   7   0   0   0   8   2   0
    0   0   1]
 [  0   1   1   1   4   0   3   2 424   0   0   0   0   0   1   2   0   0
    0   1   0]
 [  0   0   1   0   0   0   0   0   0 434   5   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   8 428   0   0   4   0   0   0   0
    0   0   0]
 [  9   2   3   1   1   3   1   2   2   0   0 411   1   0   0   0   0   0
    1   0   3]
 [  0   0   1   0   0   0   0   0   3   0   0   0 436   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   4   0   0 429   0   0   0   0
    0   0   0]
 [  0   3   0   9   1   0   2   0   0   0   0   0   0   0 415   0   0  10
    0   0   0]
 [ 13   2   0   0   3   0   3   0   0   0   0   2   0   0   0 417   0   0
    0   0   0]
 [  4   1   0   0   0   2   0   5   1   0   0   1   0   0   0   0 419   0
    0   1   0]
 [  0   5   0   0   0   0   0   0   0   0   0   0   0   0   4   0   0 430
    1   0   0]
 [  0   0   0   0   0   0   0   2   0   0   0   0   0   0   5   0   0  17
  415   1   0]
 [  0   4   0   1   0   1   0   1   0   0   0   1   0   0   0   0   0   0
    0 433   0]
 [ 19   0   0   0   0   0   0   4   0   0   0   0   0   0   0   1   0   0
    0   0 416]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.88      0.96      0.92       454
           B       0.93      0.95      0.94       446
           C       0.98      0.98      0.98       455
           D       0.92      0.95      0.93       440
           E       0.92      0.94      0.93       450
           F       0.97      0.93      0.95       421
           G       0.95      0.91      0.93       440
           I       0.91      0.90      0.90       440
           L       0.93      0.96      0.95       440
           M       0.97      0.99      0.98       440
           N       0.98      0.97      0.98       440
           O       0.94      0.93      0.94       440
           P       1.00      0.99      0.99       440
           Q       0.99      0.97      0.98       440
           R       0.97      0.94      0.96       440
           S       0.95      0.95      0.95       440
           T       0.97      0.97      0.97       434
           U       0.94      0.98      0.96       440
           V       0.99      0.94      0.97       440
           W       0.99      0.98      0.98       441
           Y       0.99      0.95      0.97       440

    accuracy                           0.95      9261
   macro avg       0.96      0.95      0.96      9261
weighted avg       0.96      0.95      0.96      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1509