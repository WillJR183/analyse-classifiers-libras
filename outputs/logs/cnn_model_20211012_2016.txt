[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_30 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_30 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_30 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_31 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_31 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_31 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_32 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_32 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_32 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_10 (Flatten)         (None, 2048)              0         
_________________________________________________________________
dense_20 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_21 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 229s 452ms/step - loss: 2.9540 - acc: 0.0801 - val_loss: 2.7714 - val_acc: 0.1101
Epoch 2/100
506/506 [==============================] - 55s 109ms/step - loss: 2.4572 - acc: 0.2049 - val_loss: 2.1870 - val_acc: 0.3118
Epoch 3/100
506/506 [==============================] - 55s 108ms/step - loss: 1.8811 - acc: 0.4205 - val_loss: 1.6778 - val_acc: 0.4712
Epoch 4/100
506/506 [==============================] - 55s 108ms/step - loss: 1.4258 - acc: 0.5686 - val_loss: 1.3007 - val_acc: 0.6073
Epoch 5/100
506/506 [==============================] - 55s 108ms/step - loss: 1.1540 - acc: 0.6690 - val_loss: 1.1339 - val_acc: 0.6962
Epoch 6/100
506/506 [==============================] - 55s 109ms/step - loss: 0.9974 - acc: 0.7211 - val_loss: 0.9649 - val_acc: 0.7356
Epoch 7/100
506/506 [==============================] - 55s 110ms/step - loss: 0.8799 - acc: 0.7590 - val_loss: 0.8748 - val_acc: 0.7657
Epoch 8/100
506/506 [==============================] - 56s 111ms/step - loss: 0.7955 - acc: 0.7811 - val_loss: 0.8680 - val_acc: 0.7425
Epoch 9/100
506/506 [==============================] - 56s 110ms/step - loss: 0.7265 - acc: 0.8008 - val_loss: 0.7234 - val_acc: 0.8016
Epoch 10/100
506/506 [==============================] - 56s 111ms/step - loss: 0.6671 - acc: 0.8152 - val_loss: 0.6887 - val_acc: 0.8113
Epoch 11/100
506/506 [==============================] - 56s 110ms/step - loss: 0.6122 - acc: 0.8294 - val_loss: 0.6481 - val_acc: 0.8094
Epoch 12/100
506/506 [==============================] - 56s 111ms/step - loss: 0.5629 - acc: 0.8429 - val_loss: 0.5959 - val_acc: 0.8397
Epoch 13/100
506/506 [==============================] - 56s 110ms/step - loss: 0.5186 - acc: 0.8527 - val_loss: 0.5130 - val_acc: 0.8589
Epoch 14/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4829 - acc: 0.8625 - val_loss: 0.4861 - val_acc: 0.8661
Epoch 15/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4494 - acc: 0.8715 - val_loss: 0.4552 - val_acc: 0.8643
Epoch 16/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4179 - acc: 0.8803 - val_loss: 0.4474 - val_acc: 0.8760
Epoch 17/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3854 - acc: 0.8889 - val_loss: 0.3764 - val_acc: 0.8953
Epoch 18/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3621 - acc: 0.8957 - val_loss: 0.3870 - val_acc: 0.8886
Epoch 19/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3376 - acc: 0.9018 - val_loss: 0.3407 - val_acc: 0.9046
Epoch 20/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3155 - acc: 0.9083 - val_loss: 0.3154 - val_acc: 0.9096
Epoch 21/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2966 - acc: 0.9150 - val_loss: 0.2913 - val_acc: 0.9171
Epoch 22/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2781 - acc: 0.9210 - val_loss: 0.2876 - val_acc: 0.9169
Epoch 23/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2588 - acc: 0.9271 - val_loss: 0.2561 - val_acc: 0.9264
Epoch 24/100
506/506 [==============================] - 57s 112ms/step - loss: 0.2459 - acc: 0.9305 - val_loss: 0.2606 - val_acc: 0.9284
Epoch 25/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2305 - acc: 0.9355 - val_loss: 0.2340 - val_acc: 0.9355
Epoch 26/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2132 - acc: 0.9412 - val_loss: 0.2097 - val_acc: 0.9433
Epoch 27/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2057 - acc: 0.9422 - val_loss: 0.2222 - val_acc: 0.9383
Epoch 28/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1922 - acc: 0.9451 - val_loss: 0.2030 - val_acc: 0.9468
Epoch 29/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1822 - acc: 0.9487 - val_loss: 0.2241 - val_acc: 0.9334
Epoch 30/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1681 - acc: 0.9529 - val_loss: 0.1732 - val_acc: 0.9546
Epoch 31/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1610 - acc: 0.9556 - val_loss: 0.1635 - val_acc: 0.9572
Epoch 32/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1524 - acc: 0.9565 - val_loss: 0.1687 - val_acc: 0.9502
Epoch 33/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1426 - acc: 0.9611 - val_loss: 0.1524 - val_acc: 0.9585
Epoch 34/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1412 - acc: 0.9596 - val_loss: 0.1611 - val_acc: 0.9548
Epoch 35/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1288 - acc: 0.9638 - val_loss: 0.1323 - val_acc: 0.9691
Epoch 36/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1205 - acc: 0.9663 - val_loss: 0.1234 - val_acc: 0.9678
Epoch 37/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1170 - acc: 0.9664 - val_loss: 0.1230 - val_acc: 0.9669
Epoch 38/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1071 - acc: 0.9711 - val_loss: 0.1699 - val_acc: 0.9492
Epoch 39/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1039 - acc: 0.9719 - val_loss: 0.1159 - val_acc: 0.9704
Epoch 40/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0993 - acc: 0.9736 - val_loss: 0.1045 - val_acc: 0.9736
Epoch 41/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0922 - acc: 0.9759 - val_loss: 0.1044 - val_acc: 0.9745
Epoch 42/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0891 - acc: 0.9763 - val_loss: 0.1025 - val_acc: 0.9749
Epoch 43/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0853 - acc: 0.9771 - val_loss: 0.0912 - val_acc: 0.9788
Epoch 44/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0848 - acc: 0.9766 - val_loss: 0.1188 - val_acc: 0.9675
Epoch 45/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0767 - acc: 0.9798 - val_loss: 0.0835 - val_acc: 0.9805
Epoch 46/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0711 - acc: 0.9818 - val_loss: 0.0743 - val_acc: 0.9823
Epoch 47/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0689 - acc: 0.9819 - val_loss: 0.0795 - val_acc: 0.9812
Epoch 48/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0662 - acc: 0.9834 - val_loss: 0.0904 - val_acc: 0.9749
Epoch 49/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0655 - acc: 0.9829 - val_loss: 0.0805 - val_acc: 0.9786
Epoch 50/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0626 - acc: 0.9840 - val_loss: 0.0737 - val_acc: 0.9818
Epoch 51/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0580 - acc: 0.9845 - val_loss: 0.0631 - val_acc: 0.9846
Epoch 52/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0539 - acc: 0.9866 - val_loss: 0.0624 - val_acc: 0.9844
Epoch 53/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0513 - acc: 0.9873 - val_loss: 0.0617 - val_acc: 0.9859
Epoch 54/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0488 - acc: 0.9878 - val_loss: 0.0709 - val_acc: 0.9840
Epoch 55/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0495 - acc: 0.9878 - val_loss: 0.0583 - val_acc: 0.9857
Epoch 56/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0480 - acc: 0.9876 - val_loss: 0.0513 - val_acc: 0.9883
Epoch 57/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0457 - acc: 0.9891 - val_loss: 0.0563 - val_acc: 0.9879
Epoch 58/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0452 - acc: 0.9885 - val_loss: 0.0611 - val_acc: 0.9859
Epoch 59/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0411 - acc: 0.9893 - val_loss: 0.0477 - val_acc: 0.9894
Epoch 60/100
506/506 [==============================] - 58s 116ms/step - loss: 0.0408 - acc: 0.9897 - val_loss: 0.0725 - val_acc: 0.9812
Epoch 61/100
506/506 [==============================] - 66s 130ms/step - loss: 0.0385 - acc: 0.9903 - val_loss: 0.0488 - val_acc: 0.9877
Epoch 62/100
506/506 [==============================] - 59s 116ms/step - loss: 0.0381 - acc: 0.9905 - val_loss: 0.1148 - val_acc: 0.9634
Epoch 63/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0351 - acc: 0.9914 - val_loss: 0.0548 - val_acc: 0.9868
Epoch 64/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0357 - acc: 0.9912 - val_loss: 0.0626 - val_acc: 0.9831

[INFO] Duração do treinamento: 62.9 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 60s 412ms/step - loss: 0.0608 - acc: 0.9822

Perda do teste: 0.061 
Acurácia do Teste: 98.22%

Gerando matriz de confusão tradicional...

[[453   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0 446   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 446   0   0   0   0   0   0   0   0   5   2   2   0   0   0   0
    0   0   0]
 [  0   0   0 434   0   0   3   1   1   0   0   1   0   0   0   0   0   0
    0   0   0]
 [  8   0   0   0 442   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0 412   0   0   0   0   0   9   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   4   1   0 421   1  11   0   0   2   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0 433   0   0   0   7   0   0   0   0   0   0
    0   0   0]
 [  0   0   2   0   0   0   0   0 434   0   0   4   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 429   4   0   0   7   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   2 424   0   0  14   0   0   0   0
    0   0   0]
 [  0   0   2   0   0   0   0   1   0   0   0 437   0   0   0   0   0   0
    0   0   0]
 [  0   0   1   0   0   0   0   0   0   0   0   0 439   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0
    0   0   0]
 [  0   0   0   6   0   0   1   0   0   0   0   0   0   0 417   0   0  16
    0   0   0]
 [  0   0   0   0   2   0   0   0   0   0   0   0   0   0   0 437   0   0
    0   0   1]
 [  0   0   0   0   0   5   0   8   0   0   0   0   0   0   0   0 418   0
    0   0   3]
 [  0   0   0   1   0   0   0   0   1   0   0   0   0   0   0   0   0 438
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   3   0   0   0   0   0   0
  437   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   5   0
   16 420   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0
    0   0 439]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.98      1.00      0.99       454
           B       1.00      1.00      1.00       446
           C       0.99      0.98      0.98       455
           D       0.98      0.99      0.98       440
           E       0.99      0.98      0.99       450
           F       0.99      0.98      0.98       421
           G       0.99      0.96      0.97       440
           I       0.98      0.98      0.98       440
           L       0.97      0.99      0.98       440
           M       1.00      0.97      0.99       440
           N       0.99      0.96      0.98       440
           O       0.93      0.99      0.96       440
           P       1.00      1.00      1.00       440
           Q       0.95      1.00      0.97       440
           R       1.00      0.95      0.97       440
           S       1.00      0.99      1.00       440
           T       0.99      0.96      0.98       434
           U       0.96      1.00      0.98       440
           V       0.96      0.99      0.98       440
           W       1.00      0.95      0.98       441
           Y       0.99      1.00      0.99       440

    accuracy                           0.98      9261
   macro avg       0.98      0.98      0.98      9261
weighted avg       0.98      0.98      0.98      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_2018