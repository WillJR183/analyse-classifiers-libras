[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_12 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_12 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_12 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_13 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_13 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_14 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_14 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2048)              0         
_________________________________________________________________
dense_8 (Dense)              (None, 16)                32784     
_________________________________________________________________
dense_9 (Dense)              (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 228s 450ms/step - loss: 2.9733 - acc: 0.1066 - val_loss: 2.7041 - val_acc: 0.2270
Epoch 2/100
506/506 [==============================] - 55s 109ms/step - loss: 2.1863 - acc: 0.3640 - val_loss: 1.7486 - val_acc: 0.4723
Epoch 3/100
506/506 [==============================] - 56s 110ms/step - loss: 1.5361 - acc: 0.5547 - val_loss: 1.3344 - val_acc: 0.6207
Epoch 4/100
506/506 [==============================] - 56s 110ms/step - loss: 1.2374 - acc: 0.6585 - val_loss: 1.1153 - val_acc: 0.7014
Epoch 5/100
506/506 [==============================] - 56s 110ms/step - loss: 1.0463 - acc: 0.7224 - val_loss: 0.9626 - val_acc: 0.7391
Epoch 6/100
506/506 [==============================] - 56s 111ms/step - loss: 0.9093 - acc: 0.7605 - val_loss: 0.8502 - val_acc: 0.7776
Epoch 7/100
506/506 [==============================] - 56s 110ms/step - loss: 0.8080 - acc: 0.7882 - val_loss: 0.7448 - val_acc: 0.8001
Epoch 8/100
506/506 [==============================] - 56s 111ms/step - loss: 0.7261 - acc: 0.8074 - val_loss: 0.6667 - val_acc: 0.8224
Epoch 9/100
506/506 [==============================] - 56s 110ms/step - loss: 0.6587 - acc: 0.8236 - val_loss: 0.6108 - val_acc: 0.8328
Epoch 10/100
506/506 [==============================] - 58s 115ms/step - loss: 0.6042 - acc: 0.8363 - val_loss: 0.5596 - val_acc: 0.8425
Epoch 11/100
506/506 [==============================] - 57s 112ms/step - loss: 0.5551 - acc: 0.8478 - val_loss: 0.5299 - val_acc: 0.8483
Epoch 12/100
506/506 [==============================] - 57s 113ms/step - loss: 0.5138 - acc: 0.8579 - val_loss: 0.4755 - val_acc: 0.8665
Epoch 13/100
506/506 [==============================] - 57s 112ms/step - loss: 0.4736 - acc: 0.8674 - val_loss: 0.4360 - val_acc: 0.8756
Epoch 14/100
506/506 [==============================] - 57s 112ms/step - loss: 0.4342 - acc: 0.8787 - val_loss: 0.4150 - val_acc: 0.8823
Epoch 15/100
506/506 [==============================] - 57s 112ms/step - loss: 0.4052 - acc: 0.8872 - val_loss: 0.4053 - val_acc: 0.8871
Epoch 16/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3747 - acc: 0.8951 - val_loss: 0.3643 - val_acc: 0.8968
Epoch 17/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3464 - acc: 0.9040 - val_loss: 0.3341 - val_acc: 0.9044
Epoch 18/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3232 - acc: 0.9110 - val_loss: 0.3148 - val_acc: 0.9128
Epoch 19/100
506/506 [==============================] - 57s 112ms/step - loss: 0.3018 - acc: 0.9177 - val_loss: 0.2879 - val_acc: 0.9234
Epoch 20/100
506/506 [==============================] - 57s 112ms/step - loss: 0.2804 - acc: 0.9232 - val_loss: 0.2723 - val_acc: 0.9236
Epoch 21/100
506/506 [==============================] - 56s 112ms/step - loss: 0.2620 - acc: 0.9300 - val_loss: 0.2568 - val_acc: 0.9318
Epoch 22/100
506/506 [==============================] - 56s 112ms/step - loss: 0.2456 - acc: 0.9340 - val_loss: 0.2432 - val_acc: 0.9316
Epoch 23/100
506/506 [==============================] - 56s 112ms/step - loss: 0.2283 - acc: 0.9403 - val_loss: 0.2210 - val_acc: 0.9433
Epoch 24/100
506/506 [==============================] - 57s 112ms/step - loss: 0.2140 - acc: 0.9443 - val_loss: 0.2167 - val_acc: 0.9424
Epoch 25/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1981 - acc: 0.9474 - val_loss: 0.1993 - val_acc: 0.9487
Epoch 26/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1851 - acc: 0.9522 - val_loss: 0.1896 - val_acc: 0.9515
Epoch 27/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1749 - acc: 0.9516 - val_loss: 0.1668 - val_acc: 0.9593
Epoch 28/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1663 - acc: 0.9553 - val_loss: 0.1642 - val_acc: 0.9587
Epoch 29/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1509 - acc: 0.9608 - val_loss: 0.1504 - val_acc: 0.9628
Epoch 30/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1412 - acc: 0.9631 - val_loss: 0.1424 - val_acc: 0.9621
Epoch 31/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1316 - acc: 0.9659 - val_loss: 0.1607 - val_acc: 0.9550
Epoch 32/100
506/506 [==============================] - 57s 113ms/step - loss: 0.1211 - acc: 0.9686 - val_loss: 0.1521 - val_acc: 0.9600
Epoch 33/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1138 - acc: 0.9715 - val_loss: 0.1166 - val_acc: 0.9710
Epoch 34/100
506/506 [==============================] - 57s 113ms/step - loss: 0.1063 - acc: 0.9730 - val_loss: 0.1121 - val_acc: 0.9704
Epoch 35/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0981 - acc: 0.9757 - val_loss: 0.1055 - val_acc: 0.9730
Epoch 36/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0916 - acc: 0.9775 - val_loss: 0.1178 - val_acc: 0.9706
Epoch 37/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0864 - acc: 0.9784 - val_loss: 0.0896 - val_acc: 0.9775
Epoch 38/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0795 - acc: 0.9801 - val_loss: 0.0937 - val_acc: 0.9760
Epoch 39/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0781 - acc: 0.9804 - val_loss: 0.0830 - val_acc: 0.9812
Epoch 40/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0701 - acc: 0.9836 - val_loss: 0.0872 - val_acc: 0.9786
Epoch 41/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0659 - acc: 0.9838 - val_loss: 0.0763 - val_acc: 0.9803
Epoch 42/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0618 - acc: 0.9857 - val_loss: 0.0664 - val_acc: 0.9838
Epoch 43/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0576 - acc: 0.9866 - val_loss: 0.0678 - val_acc: 0.9857
Epoch 44/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0546 - acc: 0.9880 - val_loss: 0.0590 - val_acc: 0.9885
Epoch 45/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0511 - acc: 0.9875 - val_loss: 0.0792 - val_acc: 0.9788
Epoch 46/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0471 - acc: 0.9895 - val_loss: 0.0547 - val_acc: 0.9885
Epoch 47/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0456 - acc: 0.9897 - val_loss: 0.0544 - val_acc: 0.9877
Epoch 48/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0417 - acc: 0.9910 - val_loss: 0.0523 - val_acc: 0.9879
Epoch 49/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0402 - acc: 0.9910 - val_loss: 0.0462 - val_acc: 0.9894
Epoch 50/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0386 - acc: 0.9917 - val_loss: 0.0503 - val_acc: 0.9885
Epoch 51/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0368 - acc: 0.9916 - val_loss: 0.0480 - val_acc: 0.9887
Epoch 52/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0318 - acc: 0.9939 - val_loss: 0.0382 - val_acc: 0.9924
Epoch 53/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0316 - acc: 0.9936 - val_loss: 0.0620 - val_acc: 0.9855
Epoch 54/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0322 - acc: 0.9926 - val_loss: 0.0458 - val_acc: 0.9898
Epoch 55/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0289 - acc: 0.9941 - val_loss: 0.0459 - val_acc: 0.9883
Epoch 56/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0266 - acc: 0.9945 - val_loss: 0.0368 - val_acc: 0.9926
Epoch 57/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0253 - acc: 0.9950 - val_loss: 0.0364 - val_acc: 0.9926
Epoch 58/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0239 - acc: 0.9954 - val_loss: 0.0419 - val_acc: 0.9916
Epoch 59/100
506/506 [==============================] - 58s 114ms/step - loss: 0.0221 - acc: 0.9960 - val_loss: 0.0331 - val_acc: 0.9918
Epoch 60/100
506/506 [==============================] - 68s 134ms/step - loss: 0.0221 - acc: 0.9955 - val_loss: 0.0333 - val_acc: 0.9918
Epoch 61/100
506/506 [==============================] - 62s 123ms/step - loss: 0.0211 - acc: 0.9959 - val_loss: 0.0420 - val_acc: 0.9887
[INFO] Duração do treinamento: 60.9 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 59s 404ms/step - loss: 0.0423 - acc: 0.9881

Perda do teste: 0.042 
Acurácia do Teste: 98.81%

Gerando matriz de confusão tradicional...

[[446   0   0   0   3   0   1   0   0   0   0   1   0   0   0   2   0   0
    0   0   1]
 [  0 433   0   3   0   0   0  10   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 451   0   0   0   0   0   1   0   0   3   0   0   0   0   0   0
    0   0   0]
 [  0   0   0 429   0   0   6   0   0   0   0   0   0   0   3   1   0   0
    0   0   1]
 [  1   0   0   0 443   0   2   0   0   0   0   1   0   0   0   3   0   0
    0   0   0]
 [  0   0   0   0   0 421   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0 435   0   2   0   0   2   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0   9 427   0   0   0   1   0   0   0   2   0   0
    0   0   0]
 [  0   0   0   0   0   1   1   0 438   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 440   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   1   0   0   0   5 433   0   0   1   0   0   0   0
    0   0   0]
 [  2   0   0   0   0   4   0   0   0   0   0 434   0   0   0   0   0   0
    0   0   0]
 [  0   0   7   0   0   0   0   0   0   0   0   2 431   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0
    0   0   0]
 [  0   0   0   7   0   0   1   0   0   0   0   0   0   0 432   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 439   0   0
    0   0   1]
 [  0   0   0   0   0   4   0   0   0   0   0   0   0   0   0   0 430   0
    0   0   0]
 [  0   0   0   1   0   0   0   0   0   0   0   0   0   0  10   0   0 429
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  439   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0 441   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 440]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.99      0.98      0.99       454
           B       1.00      0.97      0.99       446
           C       0.98      0.99      0.99       455
           D       0.97      0.97      0.97       440
           E       0.99      0.98      0.99       450
           F       0.98      1.00      0.99       421
           G       0.96      0.99      0.97       440
           I       0.98      0.97      0.97       440
           L       0.99      1.00      0.99       440
           M       0.99      1.00      0.99       440
           N       1.00      0.98      0.99       440
           O       0.98      0.99      0.98       440
           P       1.00      0.98      0.99       440
           Q       1.00      1.00      1.00       440
           R       0.97      0.98      0.98       440
           S       0.98      1.00      0.99       440
           T       1.00      0.99      1.00       434
           U       1.00      0.97      0.99       440
           V       1.00      1.00      1.00       440
           W       1.00      1.00      1.00       441
           Y       0.99      1.00      1.00       440

    accuracy                           0.99      9261
   macro avg       0.99      0.99      0.99      9261
weighted avg       0.99      0.99      0.99      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_1154