[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 4.5 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_1 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_4 (Dense)              (None, 80)                983120    
_________________________________________________________________
dense_5 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_6 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_7 (Dense)              (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 201s 398ms/step - loss: 2.9287 - acc: 0.1155 - val_loss: 2.7919 - val_acc: 0.1696
Epoch 2/100
506/506 [==============================] - 27s 53ms/step - loss: 2.6133 - acc: 0.2797 - val_loss: 2.4345 - val_acc: 0.3609
Epoch 3/100
506/506 [==============================] - 26s 52ms/step - loss: 2.2674 - acc: 0.4045 - val_loss: 2.1363 - val_acc: 0.4340
Epoch 4/100
506/506 [==============================] - 28s 56ms/step - loss: 2.0023 - acc: 0.4749 - val_loss: 1.8940 - val_acc: 0.5087
Epoch 5/100
506/506 [==============================] - 26s 52ms/step - loss: 1.8012 - acc: 0.5197 - val_loss: 1.7314 - val_acc: 0.5260
Epoch 6/100
506/506 [==============================] - 26s 52ms/step - loss: 1.6470 - acc: 0.5666 - val_loss: 1.5831 - val_acc: 0.5909
Epoch 7/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5227 - acc: 0.6088 - val_loss: 1.4870 - val_acc: 0.5984
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.4248 - acc: 0.6375 - val_loss: 1.4205 - val_acc: 0.6417
Epoch 9/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3475 - acc: 0.6598 - val_loss: 1.3244 - val_acc: 0.6869
Epoch 10/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2787 - acc: 0.6802 - val_loss: 1.2773 - val_acc: 0.6882
Epoch 11/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2207 - acc: 0.6975 - val_loss: 1.2301 - val_acc: 0.7172
Epoch 12/100
506/506 [==============================] - 23s 46ms/step - loss: 1.1675 - acc: 0.7135 - val_loss: 1.1567 - val_acc: 0.7324
Epoch 13/100
506/506 [==============================] - 22s 43ms/step - loss: 1.1235 - acc: 0.7264 - val_loss: 1.1336 - val_acc: 0.7241
Epoch 14/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0763 - acc: 0.7396 - val_loss: 1.0915 - val_acc: 0.7354
Epoch 15/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0374 - acc: 0.7448 - val_loss: 1.0559 - val_acc: 0.7408
Epoch 16/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0046 - acc: 0.7538 - val_loss: 1.0407 - val_acc: 0.7492
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9690 - acc: 0.7599 - val_loss: 0.9992 - val_acc: 0.7564
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9419 - acc: 0.7669 - val_loss: 0.9748 - val_acc: 0.7482
Epoch 19/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9115 - acc: 0.7709 - val_loss: 0.9291 - val_acc: 0.7666
Epoch 20/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8814 - acc: 0.7797 - val_loss: 0.9016 - val_acc: 0.7754
Epoch 21/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8521 - acc: 0.7856 - val_loss: 0.8822 - val_acc: 0.7789
Epoch 22/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8256 - acc: 0.7905 - val_loss: 0.8545 - val_acc: 0.7834
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8041 - acc: 0.7939 - val_loss: 0.8426 - val_acc: 0.7878
Epoch 24/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7807 - acc: 0.8016 - val_loss: 0.8151 - val_acc: 0.7856
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7623 - acc: 0.8026 - val_loss: 0.8196 - val_acc: 0.7964
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7396 - acc: 0.8094 - val_loss: 0.7760 - val_acc: 0.7979
Epoch 27/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7206 - acc: 0.8128 - val_loss: 0.7494 - val_acc: 0.8012
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7037 - acc: 0.8149 - val_loss: 0.7212 - val_acc: 0.8133
Epoch 29/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6864 - acc: 0.8186 - val_loss: 0.7170 - val_acc: 0.8048
Epoch 30/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6676 - acc: 0.8228 - val_loss: 0.7013 - val_acc: 0.8191
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6485 - acc: 0.8281 - val_loss: 0.6756 - val_acc: 0.8235
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6321 - acc: 0.8330 - val_loss: 0.6965 - val_acc: 0.8057
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6184 - acc: 0.8349 - val_loss: 0.6865 - val_acc: 0.8144
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6043 - acc: 0.8387 - val_loss: 0.6405 - val_acc: 0.8304
Epoch 35/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5905 - acc: 0.8418 - val_loss: 0.6587 - val_acc: 0.8243
Epoch 36/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5752 - acc: 0.8459 - val_loss: 0.6423 - val_acc: 0.8239
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5621 - acc: 0.8486 - val_loss: 0.6151 - val_acc: 0.8343
Epoch 38/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5493 - acc: 0.8517 - val_loss: 0.5662 - val_acc: 0.8520
Epoch 39/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5355 - acc: 0.8570 - val_loss: 0.5547 - val_acc: 0.8537
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5232 - acc: 0.8579 - val_loss: 0.5487 - val_acc: 0.8529
Epoch 41/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5112 - acc: 0.8625 - val_loss: 0.5731 - val_acc: 0.8529
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5028 - acc: 0.8647 - val_loss: 0.5315 - val_acc: 0.8544
Epoch 43/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4943 - acc: 0.8663 - val_loss: 0.5123 - val_acc: 0.8617
Epoch 44/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4814 - acc: 0.8703 - val_loss: 0.5088 - val_acc: 0.8615
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4716 - acc: 0.8719 - val_loss: 0.5051 - val_acc: 0.8579
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4579 - acc: 0.8770 - val_loss: 0.5169 - val_acc: 0.8542
Epoch 47/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4512 - acc: 0.8776 - val_loss: 0.4960 - val_acc: 0.8652
Epoch 48/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4465 - acc: 0.8801 - val_loss: 0.4769 - val_acc: 0.8704
Epoch 49/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4282 - acc: 0.8853 - val_loss: 0.4651 - val_acc: 0.8721
Epoch 50/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4244 - acc: 0.8851 - val_loss: 0.4784 - val_acc: 0.8706
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4179 - acc: 0.8875 - val_loss: 0.4369 - val_acc: 0.8806
Epoch 52/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4083 - acc: 0.8896 - val_loss: 0.4348 - val_acc: 0.8817
Epoch 53/100
506/506 [==============================] - 22s 42ms/step - loss: 0.3975 - acc: 0.8927 - val_loss: 0.4448 - val_acc: 0.8786
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3897 - acc: 0.8957 - val_loss: 0.4255 - val_acc: 0.8804
Epoch 55/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3803 - acc: 0.8996 - val_loss: 0.4390 - val_acc: 0.8739
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3746 - acc: 0.9001 - val_loss: 0.4006 - val_acc: 0.8866
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3681 - acc: 0.9016 - val_loss: 0.3912 - val_acc: 0.8957
Epoch 58/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3605 - acc: 0.9035 - val_loss: 0.3873 - val_acc: 0.8966
Epoch 59/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3547 - acc: 0.9061 - val_loss: 0.3871 - val_acc: 0.8951
Epoch 60/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3476 - acc: 0.9085 - val_loss: 0.3683 - val_acc: 0.9013
Epoch 61/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3428 - acc: 0.9085 - val_loss: 0.3733 - val_acc: 0.8985
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3333 - acc: 0.9120 - val_loss: 0.3851 - val_acc: 0.8910
Epoch 63/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3265 - acc: 0.9143 - val_loss: 0.3947 - val_acc: 0.8842
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3234 - acc: 0.9145 - val_loss: 0.3702 - val_acc: 0.8953
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3177 - acc: 0.9166 - val_loss: 0.3629 - val_acc: 0.8970

[INFO] Duração do treinamento: 27.1 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 46s 317ms/step - loss: 0.3573 - acc: 0.9007

Perda do teste: 0.357 
Acurácia do Teste: 90.07%

Gerando matriz de confusão tradicional...

[[360   0   2   2  14   0  11   8   7   0   0  19   2   0   0   2   2   0
    3   2  20]
 [  0 408   0   4   0   2   6   5   0   0   0   2   0   0   0   0   8   8
    0   3   0]
 [  2   0 435   0   2   1   0   0   0   0   4   5   4   0   0   0   0   1
    0   0   1]
 [  0   0   6 385   4   2  18   5  13   0   0   1   0   0   2   0   1   0
    3   0   0]
 [  3   5   5  15 394   2   9   2   0   0   0   0   0   0   0   0   7   0
    0   0   8]
 [  0   2   1   2   0 388   3   2   0   0   0  13   0   0   0   0   6   1
    0   0   3]
 [  0   0   1   7   5   0 390   1  16   0   0   9   0   0   0   0   0   0
    4   3   4]
 [  0   3   0  11   0   7  10 352   0   0   0  20   0   0   0   1  12   2
    3   2  17]
 [  0   0   4   1   0   0   8   2 408   0   0   3   0   0   1   0   2   2
    7   0   2]
 [  0   0   0   0   0   0   0   0   0 436   4   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  40 400   0   0   0   0   0   0   0
    0   0   0]
 [  1   1  13   4   0   7   2   2   0   0   0 401   0   0   0   0   0   0
    4   0   5]
 [  0   0   8   0   0   0   0   0   0   0   0   3 429   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  20   5   0   0 415   0   0   0   0
    0   0   0]
 [  0   1   1   6   0   2  26   1   9   0   0   0   0   0 339   0   0  17
   33   2   3]
 [ 10  13   0   2  12   3   8  10   5   0   0   4   0   0   0 355  11   0
    0   0   7]
 [  0   3   0   0   0   7   0   3   0   0   0   1   0   0   0   0 409   0
    0   2   9]
 [  0  10   0   1   0   1   0   0   2   0   0   0   0   0   2   0   0 405
   19   0   0]
 [  0   0   0   3   0   1   3   0   0   0   0   0   0   0   0   0   0  25
  408   0   0]
 [  0   8   1   0   0   4   0   1   0   0   0   0   0   0   0   0   5  17
    8 397   0]
 [  0   0   0   0   0   0   1   2   0   0   0   2   0   0   0   7   1   0
    0   0 427]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.96      0.79      0.87       454
           B       0.90      0.91      0.91       446
           C       0.91      0.96      0.93       455
           D       0.87      0.88      0.87       440
           E       0.91      0.88      0.89       450
           F       0.91      0.92      0.92       421
           G       0.79      0.89      0.83       440
           I       0.89      0.80      0.84       440
           L       0.89      0.93      0.91       440
           M       0.88      0.99      0.93       440
           N       0.97      0.91      0.94       440
           O       0.83      0.91      0.87       440
           P       0.99      0.97      0.98       440
           Q       1.00      0.94      0.97       440
           R       0.99      0.77      0.86       440
           S       0.97      0.81      0.88       440
           T       0.88      0.94      0.91       434
           U       0.85      0.92      0.88       440
           V       0.83      0.93      0.88       440
           W       0.97      0.90      0.93       441
           Y       0.84      0.97      0.90       440

    accuracy                           0.90      9261
   macro avg       0.91      0.90      0.90      9261
weighted avg       0.91      0.90      0.90      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1130