[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_7 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_28 (Dense)             (None, 80)                983120    
_________________________________________________________________
dense_29 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_30 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_31 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 198s 391ms/step - loss: 2.9272 - acc: 0.1192 - val_loss: 2.7936 - val_acc: 0.1733
Epoch 2/100
506/506 [==============================] - 27s 54ms/step - loss: 2.6036 - acc: 0.2803 - val_loss: 2.4276 - val_acc: 0.3068
Epoch 3/100
506/506 [==============================] - 27s 53ms/step - loss: 2.2650 - acc: 0.4061 - val_loss: 2.1189 - val_acc: 0.4892
Epoch 4/100
506/506 [==============================] - 27s 54ms/step - loss: 1.9994 - acc: 0.4756 - val_loss: 1.8885 - val_acc: 0.4952
Epoch 5/100
506/506 [==============================] - 27s 54ms/step - loss: 1.8003 - acc: 0.5281 - val_loss: 1.7089 - val_acc: 0.5560
Epoch 6/100
506/506 [==============================] - 27s 53ms/step - loss: 1.6462 - acc: 0.5700 - val_loss: 1.5738 - val_acc: 0.5868
Epoch 7/100
506/506 [==============================] - 27s 53ms/step - loss: 1.5290 - acc: 0.5995 - val_loss: 1.4703 - val_acc: 0.6106
Epoch 8/100
506/506 [==============================] - 27s 53ms/step - loss: 1.4340 - acc: 0.6217 - val_loss: 1.4136 - val_acc: 0.6365
Epoch 9/100
506/506 [==============================] - 27s 53ms/step - loss: 1.3601 - acc: 0.6412 - val_loss: 1.3145 - val_acc: 0.6623
Epoch 10/100
506/506 [==============================] - 27s 54ms/step - loss: 1.2957 - acc: 0.6580 - val_loss: 1.2640 - val_acc: 0.6668
Epoch 11/100
506/506 [==============================] - 27s 54ms/step - loss: 1.2398 - acc: 0.6719 - val_loss: 1.2101 - val_acc: 0.6716
Epoch 12/100
506/506 [==============================] - 27s 53ms/step - loss: 1.1934 - acc: 0.6880 - val_loss: 1.1654 - val_acc: 0.7040
Epoch 13/100
506/506 [==============================] - 29s 57ms/step - loss: 1.1477 - acc: 0.7041 - val_loss: 1.1068 - val_acc: 0.7118
Epoch 14/100
506/506 [==============================] - 27s 54ms/step - loss: 1.1075 - acc: 0.7160 - val_loss: 1.0639 - val_acc: 0.7205
Epoch 15/100
506/506 [==============================] - 23s 46ms/step - loss: 1.0667 - acc: 0.7251 - val_loss: 1.0476 - val_acc: 0.7367
Epoch 16/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0313 - acc: 0.7378 - val_loss: 0.9977 - val_acc: 0.7425
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9977 - acc: 0.7442 - val_loss: 0.9689 - val_acc: 0.7547
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9676 - acc: 0.7522 - val_loss: 0.9631 - val_acc: 0.7471
Epoch 19/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9370 - acc: 0.7615 - val_loss: 0.9152 - val_acc: 0.7704
Epoch 20/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9074 - acc: 0.7675 - val_loss: 0.8789 - val_acc: 0.7754
Epoch 21/100
506/506 [==============================] - 22s 42ms/step - loss: 0.8773 - acc: 0.7772 - val_loss: 0.8669 - val_acc: 0.7793
Epoch 22/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8536 - acc: 0.7801 - val_loss: 0.8247 - val_acc: 0.7925
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8276 - acc: 0.7874 - val_loss: 0.8145 - val_acc: 0.7929
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8045 - acc: 0.7928 - val_loss: 0.7813 - val_acc: 0.8014
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7806 - acc: 0.7979 - val_loss: 0.7655 - val_acc: 0.7964
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7584 - acc: 0.8018 - val_loss: 0.7464 - val_acc: 0.8083
Epoch 27/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7381 - acc: 0.8050 - val_loss: 0.7378 - val_acc: 0.8085
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7171 - acc: 0.8112 - val_loss: 0.6935 - val_acc: 0.8206
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6977 - acc: 0.8156 - val_loss: 0.6834 - val_acc: 0.8222
Epoch 30/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6816 - acc: 0.8183 - val_loss: 0.6628 - val_acc: 0.8254
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6647 - acc: 0.8232 - val_loss: 0.6623 - val_acc: 0.8254
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6479 - acc: 0.8263 - val_loss: 0.6291 - val_acc: 0.8358
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6327 - acc: 0.8304 - val_loss: 0.6446 - val_acc: 0.8243
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6161 - acc: 0.8356 - val_loss: 0.6221 - val_acc: 0.8278
Epoch 35/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6020 - acc: 0.8356 - val_loss: 0.5982 - val_acc: 0.8384
Epoch 36/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5874 - acc: 0.8409 - val_loss: 0.5834 - val_acc: 0.8449
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5732 - acc: 0.8434 - val_loss: 0.5740 - val_acc: 0.8470
Epoch 38/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5585 - acc: 0.8492 - val_loss: 0.5482 - val_acc: 0.8533
Epoch 39/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5455 - acc: 0.8505 - val_loss: 0.5528 - val_acc: 0.8479
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5349 - acc: 0.8535 - val_loss: 0.5323 - val_acc: 0.8542
Epoch 41/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5223 - acc: 0.8559 - val_loss: 0.5174 - val_acc: 0.8615
Epoch 42/100
506/506 [==============================] - 23s 44ms/step - loss: 0.5112 - acc: 0.8597 - val_loss: 0.5095 - val_acc: 0.8661
Epoch 43/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4989 - acc: 0.8611 - val_loss: 0.4879 - val_acc: 0.8656
Epoch 44/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4883 - acc: 0.8649 - val_loss: 0.5047 - val_acc: 0.8646
Epoch 45/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4807 - acc: 0.8664 - val_loss: 0.4900 - val_acc: 0.8656
Epoch 46/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4698 - acc: 0.8703 - val_loss: 0.4721 - val_acc: 0.8698
Epoch 47/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4589 - acc: 0.8724 - val_loss: 0.4826 - val_acc: 0.8661
Epoch 48/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4488 - acc: 0.8763 - val_loss: 0.4628 - val_acc: 0.8747
Epoch 49/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4411 - acc: 0.8780 - val_loss: 0.4566 - val_acc: 0.8689
Epoch 50/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4309 - acc: 0.8804 - val_loss: 0.4299 - val_acc: 0.8858
Epoch 51/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4230 - acc: 0.8824 - val_loss: 0.4309 - val_acc: 0.8827
Epoch 52/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4146 - acc: 0.8836 - val_loss: 0.4608 - val_acc: 0.8708
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4058 - acc: 0.8865 - val_loss: 0.4165 - val_acc: 0.8873
Epoch 54/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3982 - acc: 0.8887 - val_loss: 0.4120 - val_acc: 0.8823
Epoch 55/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3922 - acc: 0.8920 - val_loss: 0.3974 - val_acc: 0.8931
Epoch 56/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3835 - acc: 0.8933 - val_loss: 0.4079 - val_acc: 0.8892
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3769 - acc: 0.8942 - val_loss: 0.3767 - val_acc: 0.9007
Epoch 58/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3698 - acc: 0.8968 - val_loss: 0.3940 - val_acc: 0.8959
Epoch 59/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3636 - acc: 0.8987 - val_loss: 0.3859 - val_acc: 0.8936
Epoch 60/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3573 - acc: 0.9004 - val_loss: 0.3712 - val_acc: 0.8985
Epoch 61/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3504 - acc: 0.9017 - val_loss: 0.3658 - val_acc: 0.8974
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3454 - acc: 0.9055 - val_loss: 0.3521 - val_acc: 0.9050
Epoch 63/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3373 - acc: 0.9061 - val_loss: 0.3440 - val_acc: 0.9063
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3312 - acc: 0.9079 - val_loss: 0.3423 - val_acc: 0.9061
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3252 - acc: 0.9105 - val_loss: 0.3484 - val_acc: 0.8996
Epoch 66/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3204 - acc: 0.9124 - val_loss: 0.3351 - val_acc: 0.9145
Epoch 67/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3143 - acc: 0.9146 - val_loss: 0.3218 - val_acc: 0.9137
Epoch 68/100
506/506 [==============================] - 23s 46ms/step - loss: 0.3095 - acc: 0.9155 - val_loss: 0.3381 - val_acc: 0.9091
Epoch 69/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3023 - acc: 0.9182 - val_loss: 0.3351 - val_acc: 0.9039
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2998 - acc: 0.9189 - val_loss: 0.3162 - val_acc: 0.9156
Epoch 71/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2942 - acc: 0.9213 - val_loss: 0.3097 - val_acc: 0.9171
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2898 - acc: 0.9202 - val_loss: 0.3098 - val_acc: 0.9158
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2844 - acc: 0.9228 - val_loss: 0.3010 - val_acc: 0.9230
Epoch 74/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2814 - acc: 0.9236 - val_loss: 0.2891 - val_acc: 0.9234
Epoch 75/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2763 - acc: 0.9254 - val_loss: 0.3002 - val_acc: 0.9184
Epoch 76/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2704 - acc: 0.9273 - val_loss: 0.2829 - val_acc: 0.9247
Epoch 77/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2673 - acc: 0.9295 - val_loss: 0.3054 - val_acc: 0.9135
Epoch 78/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2637 - acc: 0.9281 - val_loss: 0.2914 - val_acc: 0.9191
Epoch 79/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2588 - acc: 0.9314 - val_loss: 0.2785 - val_acc: 0.9262
Epoch 80/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2540 - acc: 0.9328 - val_loss: 0.2860 - val_acc: 0.9256
Epoch 81/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2511 - acc: 0.9324 - val_loss: 0.2737 - val_acc: 0.9273
Epoch 82/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2458 - acc: 0.9353 - val_loss: 0.2661 - val_acc: 0.9284
Epoch 83/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2444 - acc: 0.9351 - val_loss: 0.2675 - val_acc: 0.9303
Epoch 84/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2381 - acc: 0.9373 - val_loss: 0.2660 - val_acc: 0.9256
Epoch 85/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2367 - acc: 0.9380 - val_loss: 0.2456 - val_acc: 0.9366
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2330 - acc: 0.9382 - val_loss: 0.2476 - val_acc: 0.9357
Epoch 87/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2287 - acc: 0.9407 - val_loss: 0.2471 - val_acc: 0.9344
Epoch 88/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2249 - acc: 0.9417 - val_loss: 0.2456 - val_acc: 0.9327
Epoch 89/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2221 - acc: 0.9422 - val_loss: 0.2470 - val_acc: 0.9349
Epoch 90/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2192 - acc: 0.9432 - val_loss: 0.2402 - val_acc: 0.9394
Epoch 91/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2152 - acc: 0.9435 - val_loss: 0.2421 - val_acc: 0.9364
Epoch 92/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2120 - acc: 0.9448 - val_loss: 0.2308 - val_acc: 0.9401
Epoch 93/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2082 - acc: 0.9462 - val_loss: 0.2212 - val_acc: 0.9448
Epoch 94/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2067 - acc: 0.9455 - val_loss: 0.2264 - val_acc: 0.9399
Epoch 95/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2017 - acc: 0.9478 - val_loss: 0.2219 - val_acc: 0.9427
Epoch 96/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1986 - acc: 0.9484 - val_loss: 0.2364 - val_acc: 0.9360
Epoch 97/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1971 - acc: 0.9489 - val_loss: 0.2256 - val_acc: 0.9399
Epoch 98/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1927 - acc: 0.9503 - val_loss: 0.2131 - val_acc: 0.9453
Epoch 99/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1912 - acc: 0.9507 - val_loss: 0.2080 - val_acc: 0.9463
Epoch 100/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1871 - acc: 0.9518 - val_loss: 0.2098 - val_acc: 0.9427

[INFO] Duração do treinamento: 40.1 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 45s 310ms/step - loss: 0.2044 - acc: 0.9478

Perda do teste: 0.204 
Acurácia do Teste: 94.78%

Gerando matriz de confusão tradicional...

[[436   0   0   0   7   0   0   1   1   0   0   1   0   0   0   2   0   0
    0   0   6]
 [  0 404   0   0   4   5   7  13   0   0   0   0   0   0   0   0   4   2
    0   7   0]
 [  3   0 442   1   0   0   0   0   0   0   1   3   4   0   0   0   0   1
    0   0   0]
 [  0   0   0 405  10   0   5   3   3   0   0   0   0   0  10   0   0   1
    2   0   1]
 [  2   0   0   1 426   0   2   9   1   0   0   0   0   0   0   5   0   0
    0   0   4]
 [  0   5   0   0   2 387   0  10   0   0   0   8   0   0   1   0   8   0
    0   0   0]
 [  3   0   2   3   2   0 408   5   2   0   0   1   0   0   4   6   0   0
    3   0   1]
 [  6   0   0   7   6   2   8 385   0   0   0   4   0   0   5  13   0   0
    0   2   2]
 [  0   0   3   0   1   0   5   3 421   0   0   2   0   0   3   2   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 437   2   0   0   1   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  29 408   0   0   3   0   0   0   0
    0   0   0]
 [  6   3   2   1   8   1   1   2   4   0   0 404   1   0   0   0   0   6
    0   0   1]
 [  1   0   5   0   0   0   0   0   0   0   0   0 434   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   3   0   0 425   0   0   0   0
    0   0   0]
 [  0   0   0   3   0   2   0   0   0   0   0   0   0   0 425   0   0   3
    7   0   0]
 [ 11   1   0   0   1   0   3   2   0   0   0   1   0   0   0 420   1   0
    0   0   0]
 [  0   0   0   0   0   4   0   8   3   0   0   0   0   0   0   0 415   0
    0   4   0]
 [  0   0   1   1   0   0   2   1   0   0   0   0   0   0   3   0   0 418
   13   1   0]
 [  0   1   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0  11
  421   1   0]
 [  0   3   0   0   0   0   0   2   0   0   0   0   0   0   2   0   4   2
    1 427   0]
 [  7   0   0   0   1   0   0   0   0   0   0   0   0   0   0   2   0   0
    0   0 430]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.92      0.96      0.94       454
           B       0.97      0.91      0.94       446
           C       0.97      0.97      0.97       455
           D       0.96      0.92      0.94       440
           E       0.91      0.95      0.93       450
           F       0.97      0.92      0.94       421
           G       0.93      0.93      0.93       440
           I       0.86      0.88      0.87       440
           L       0.97      0.96      0.96       440
           M       0.91      0.99      0.95       440
           N       0.99      0.93      0.96       440
           O       0.95      0.92      0.94       440
           P       0.99      0.99      0.99       440
           Q       0.99      0.97      0.98       440
           R       0.93      0.97      0.95       440
           S       0.93      0.95      0.94       440
           T       0.96      0.96      0.96       434
           U       0.94      0.95      0.95       440
           V       0.94      0.96      0.95       440
           W       0.97      0.97      0.97       441
           Y       0.97      0.98      0.97       440

    accuracy                           0.95      9261
   macro avg       0.95      0.95      0.95      9261
weighted avg       0.95      0.95      0.95      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1744