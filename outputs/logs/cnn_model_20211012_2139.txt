[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.8 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_11"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_33 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_33 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_33 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_34 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_34 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_34 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_35 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_35 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_35 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_11 (Flatten)         (None, 2048)              0         
_________________________________________________________________
dense_22 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_23 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 224s 443ms/step - loss: 2.9096 - acc: 0.1474 - val_loss: 2.5068 - val_acc: 0.2676
Epoch 2/100
506/506 [==============================] - 55s 109ms/step - loss: 1.9567 - acc: 0.4401 - val_loss: 1.5882 - val_acc: 0.5316
Epoch 3/100
506/506 [==============================] - 54s 107ms/step - loss: 1.3619 - acc: 0.6198 - val_loss: 1.2358 - val_acc: 0.6696
Epoch 4/100
506/506 [==============================] - 55s 108ms/step - loss: 1.1025 - acc: 0.7179 - val_loss: 1.0375 - val_acc: 0.7462
Epoch 5/100
506/506 [==============================] - 54s 108ms/step - loss: 0.9480 - acc: 0.7664 - val_loss: 0.9191 - val_acc: 0.7737
Epoch 6/100
506/506 [==============================] - 55s 108ms/step - loss: 0.8390 - acc: 0.7902 - val_loss: 0.8270 - val_acc: 0.7912
Epoch 7/100
506/506 [==============================] - 55s 109ms/step - loss: 0.7526 - acc: 0.8076 - val_loss: 0.7470 - val_acc: 0.8053
Epoch 8/100
506/506 [==============================] - 55s 109ms/step - loss: 0.6774 - acc: 0.8219 - val_loss: 0.6943 - val_acc: 0.8044
Epoch 9/100
506/506 [==============================] - 55s 109ms/step - loss: 0.6165 - acc: 0.8339 - val_loss: 0.6359 - val_acc: 0.8280
Epoch 10/100
506/506 [==============================] - 55s 109ms/step - loss: 0.5662 - acc: 0.8453 - val_loss: 0.5874 - val_acc: 0.8379
Epoch 11/100
506/506 [==============================] - 56s 110ms/step - loss: 0.5174 - acc: 0.8577 - val_loss: 0.5363 - val_acc: 0.8561
Epoch 12/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4780 - acc: 0.8674 - val_loss: 0.5152 - val_acc: 0.8585
Epoch 13/100
506/506 [==============================] - 55s 110ms/step - loss: 0.4408 - acc: 0.8778 - val_loss: 0.4680 - val_acc: 0.8778
Epoch 14/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4078 - acc: 0.8874 - val_loss: 0.4304 - val_acc: 0.8871
Epoch 15/100
506/506 [==============================] - 55s 109ms/step - loss: 0.3811 - acc: 0.8932 - val_loss: 0.4218 - val_acc: 0.8849
Epoch 16/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3537 - acc: 0.9023 - val_loss: 0.3829 - val_acc: 0.8959
Epoch 17/100
506/506 [==============================] - 55s 110ms/step - loss: 0.3309 - acc: 0.9077 - val_loss: 0.3643 - val_acc: 0.8981
Epoch 18/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3062 - acc: 0.9159 - val_loss: 0.3300 - val_acc: 0.9083
Epoch 19/100
506/506 [==============================] - 55s 110ms/step - loss: 0.2875 - acc: 0.9205 - val_loss: 0.3160 - val_acc: 0.9163
Epoch 20/100
506/506 [==============================] - 55s 110ms/step - loss: 0.2689 - acc: 0.9252 - val_loss: 0.2936 - val_acc: 0.9212
Epoch 21/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2557 - acc: 0.9295 - val_loss: 0.2969 - val_acc: 0.9184
Epoch 22/100
506/506 [==============================] - 55s 109ms/step - loss: 0.2364 - acc: 0.9359 - val_loss: 0.2741 - val_acc: 0.9260
Epoch 23/100
506/506 [==============================] - 55s 109ms/step - loss: 0.2245 - acc: 0.9383 - val_loss: 0.2501 - val_acc: 0.9334
Epoch 24/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2107 - acc: 0.9414 - val_loss: 0.2407 - val_acc: 0.9379
Epoch 25/100
506/506 [==============================] - 55s 110ms/step - loss: 0.1968 - acc: 0.9472 - val_loss: 0.2297 - val_acc: 0.9366
Epoch 26/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1867 - acc: 0.9493 - val_loss: 0.2191 - val_acc: 0.9420
Epoch 27/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1734 - acc: 0.9534 - val_loss: 0.2208 - val_acc: 0.9392
Epoch 28/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1681 - acc: 0.9543 - val_loss: 0.1895 - val_acc: 0.9481
Epoch 29/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1564 - acc: 0.9581 - val_loss: 0.1905 - val_acc: 0.9466
Epoch 30/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1486 - acc: 0.9598 - val_loss: 0.1900 - val_acc: 0.9476
Epoch 31/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1396 - acc: 0.9623 - val_loss: 0.1633 - val_acc: 0.9598
Epoch 32/100
506/506 [==============================] - 55s 109ms/step - loss: 0.1325 - acc: 0.9636 - val_loss: 0.1620 - val_acc: 0.9572
Epoch 33/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1272 - acc: 0.9656 - val_loss: 0.1528 - val_acc: 0.9598
Epoch 34/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1176 - acc: 0.9680 - val_loss: 0.1597 - val_acc: 0.9548
Epoch 35/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1152 - acc: 0.9681 - val_loss: 0.1402 - val_acc: 0.9667
Epoch 36/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1068 - acc: 0.9718 - val_loss: 0.1340 - val_acc: 0.9634
Epoch 37/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1026 - acc: 0.9722 - val_loss: 0.1405 - val_acc: 0.9632
Epoch 38/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0975 - acc: 0.9731 - val_loss: 0.1399 - val_acc: 0.9611
Epoch 39/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0922 - acc: 0.9740 - val_loss: 0.1221 - val_acc: 0.9704
Epoch 40/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0851 - acc: 0.9770 - val_loss: 0.1099 - val_acc: 0.9699
Epoch 41/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0848 - acc: 0.9766 - val_loss: 0.1143 - val_acc: 0.9684
Epoch 42/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0806 - acc: 0.9779 - val_loss: 0.1134 - val_acc: 0.9680
Epoch 43/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0739 - acc: 0.9807 - val_loss: 0.0938 - val_acc: 0.9781
Epoch 44/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0716 - acc: 0.9807 - val_loss: 0.1079 - val_acc: 0.9712
Epoch 45/100
506/506 [==============================] - 55s 109ms/step - loss: 0.0674 - acc: 0.9819 - val_loss: 0.0942 - val_acc: 0.9777
Epoch 46/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0657 - acc: 0.9820 - val_loss: 0.0938 - val_acc: 0.9758
Epoch 47/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0622 - acc: 0.9838 - val_loss: 0.1008 - val_acc: 0.9738
Epoch 48/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0595 - acc: 0.9847 - val_loss: 0.0937 - val_acc: 0.9749

[INFO] Duração do treinamento: 47.3 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 54s 370ms/step - loss: 0.0594 - acc: 0.9822

Perda do teste: 0.059 
Acurácia do Teste: 98.22%

Gerando matriz de confusão tradicional...

[[445   0   0   0   4   0   0   0   0   0   0   0   0   0   0   5   0   0
    0   0   0]
 [  1 444   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  3   1 446   0   0   0   0   1   0   0   1   1   2   0   0   0   0   0
    0   0   0]
 [  0   2   0 423   2   0   9   0   3   0   0   0   0   0   1   0   0   0
    0   0   0]
 [  7   2   0   0 440   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0]
 [  0   0   0   0   0 400   1   2   1   0   0   0   0   1   0   0  14   0
    0   0   2]
 [  0   2   0   1   0   0 424   0  12   1   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   1   0   0   2   0   2 430   0   0   0   0   0   3   0   2   0   0
    0   0   0]
 [  1   0   0   0   0   0   2   0 434   0   0   0   0   0   0   0   2   0
    1   0   0]
 [  0   0   0   0   0   0   0   0   0 436   3   0   0   1   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  16 421   0   0   3   0   0   0   0
    0   0   0]
 [  1   0   1   0   0   0   0   0   1   0   0 436   0   0   0   0   0   0
    0   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0 428   0   0   0   0
    0   0   0]
 [  0   2   0   1   0   0   1   0   2   0   0   0   0   0 434   0   0   0
    0   0   0]
 [  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0 436   0   0
    0   0   0]
 [  0   0   0   0   0   2   0   0   0   0   0   0   0   0   0   0 432   0
    0   0   0]
 [  0   1   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0 438
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   4   0   0   0
  436   0   0]
 [  0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   7   0
    0 433   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 440]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.96      0.98      0.97       454
           B       0.98      1.00      0.99       446
           C       1.00      0.98      0.99       455
           D       0.99      0.96      0.98       440
           E       0.98      0.98      0.98       450
           F       0.99      0.95      0.97       421
           G       0.97      0.96      0.96       440
           I       0.99      0.98      0.99       440
           L       0.96      0.99      0.97       440
           M       0.94      0.99      0.96       440
           N       0.99      0.96      0.97       440
           O       1.00      0.99      0.99       440
           P       1.00      1.00      1.00       440
           Q       0.98      0.97      0.98       440
           R       0.99      0.99      0.99       440
           S       0.98      0.99      0.99       440
           T       0.95      1.00      0.97       434
           U       1.00      1.00      1.00       440
           V       1.00      0.99      0.99       440
           W       1.00      0.98      0.99       441
           Y       0.99      1.00      1.00       440

    accuracy                           0.98      9261
   macro avg       0.98      0.98      0.98      9261
weighted avg       0.98      0.98      0.98      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_2141