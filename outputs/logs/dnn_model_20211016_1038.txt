[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 21.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            (None, 12288)             0         
_________________________________________________________________
dense (Dense)                (None, 80)                983120    
_________________________________________________________________
dense_1 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_2 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_3 (Dense)              (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 198s 392ms/step - loss: 2.9924 - acc: 0.0678 - val_loss: 2.9215 - val_acc: 0.1231
Epoch 2/100
506/506 [==============================] - 27s 54ms/step - loss: 2.8435 - acc: 0.1825 - val_loss: 2.7370 - val_acc: 0.2704
Epoch 3/100
506/506 [==============================] - 26s 51ms/step - loss: 2.6207 - acc: 0.3230 - val_loss: 2.4646 - val_acc: 0.3730
Epoch 4/100
506/506 [==============================] - 27s 54ms/step - loss: 2.3269 - acc: 0.4085 - val_loss: 2.1777 - val_acc: 0.4455
Epoch 5/100
506/506 [==============================] - 27s 52ms/step - loss: 2.0702 - acc: 0.4635 - val_loss: 1.9506 - val_acc: 0.4859
Epoch 6/100
506/506 [==============================] - 26s 52ms/step - loss: 1.8751 - acc: 0.5137 - val_loss: 1.7679 - val_acc: 0.5400
Epoch 7/100
506/506 [==============================] - 27s 52ms/step - loss: 1.7242 - acc: 0.5519 - val_loss: 1.6410 - val_acc: 0.5937
Epoch 8/100
506/506 [==============================] - 22s 43ms/step - loss: 1.6032 - acc: 0.5849 - val_loss: 1.5386 - val_acc: 0.5963
Epoch 9/100
506/506 [==============================] - 22s 44ms/step - loss: 1.5042 - acc: 0.6094 - val_loss: 1.4244 - val_acc: 0.6376
Epoch 10/100
506/506 [==============================] - 24s 47ms/step - loss: 1.4198 - acc: 0.6297 - val_loss: 1.3599 - val_acc: 0.6270
Epoch 11/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3438 - acc: 0.6529 - val_loss: 1.2981 - val_acc: 0.6370
Epoch 12/100
506/506 [==============================] - 28s 55ms/step - loss: 1.2847 - acc: 0.6686 - val_loss: 1.2282 - val_acc: 0.6962
Epoch 13/100
506/506 [==============================] - 28s 55ms/step - loss: 1.2294 - acc: 0.6855 - val_loss: 1.1751 - val_acc: 0.6971
Epoch 14/100
506/506 [==============================] - 27s 54ms/step - loss: 1.1824 - acc: 0.6981 - val_loss: 1.1237 - val_acc: 0.7185
Epoch 15/100
506/506 [==============================] - 26s 52ms/step - loss: 1.1364 - acc: 0.7101 - val_loss: 1.1042 - val_acc: 0.7293
Epoch 16/100
506/506 [==============================] - 26s 52ms/step - loss: 1.0989 - acc: 0.7204 - val_loss: 1.0665 - val_acc: 0.7399
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0622 - acc: 0.7288 - val_loss: 1.0366 - val_acc: 0.7352
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0275 - acc: 0.7391 - val_loss: 0.9841 - val_acc: 0.7518
Epoch 19/100
506/506 [==============================] - 22s 44ms/step - loss: 0.9931 - acc: 0.7454 - val_loss: 0.9532 - val_acc: 0.7566
Epoch 20/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9638 - acc: 0.7508 - val_loss: 0.9370 - val_acc: 0.7633
Epoch 21/100
506/506 [==============================] - 22s 44ms/step - loss: 0.9316 - acc: 0.7611 - val_loss: 0.9155 - val_acc: 0.7724
Epoch 22/100
506/506 [==============================] - 22s 44ms/step - loss: 0.9075 - acc: 0.7644 - val_loss: 0.8885 - val_acc: 0.7577
Epoch 23/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8794 - acc: 0.7716 - val_loss: 0.8526 - val_acc: 0.7847
Epoch 24/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8521 - acc: 0.7766 - val_loss: 0.8372 - val_acc: 0.7806
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8293 - acc: 0.7801 - val_loss: 0.8070 - val_acc: 0.7945
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8065 - acc: 0.7868 - val_loss: 0.8126 - val_acc: 0.7869
Epoch 27/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7826 - acc: 0.7915 - val_loss: 0.7600 - val_acc: 0.7958
Epoch 28/100
506/506 [==============================] - 21s 41ms/step - loss: 0.7650 - acc: 0.7956 - val_loss: 0.7402 - val_acc: 0.8081
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7431 - acc: 0.8008 - val_loss: 0.7256 - val_acc: 0.8053
Epoch 30/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7244 - acc: 0.8054 - val_loss: 0.6897 - val_acc: 0.8189
Epoch 31/100
506/506 [==============================] - 21s 41ms/step - loss: 0.7045 - acc: 0.8097 - val_loss: 0.6982 - val_acc: 0.8077
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6858 - acc: 0.8136 - val_loss: 0.7017 - val_acc: 0.8053
Epoch 33/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6661 - acc: 0.8187 - val_loss: 0.6271 - val_acc: 0.8289
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6495 - acc: 0.8231 - val_loss: 0.6099 - val_acc: 0.8369
Epoch 35/100
506/506 [==============================] - 25s 49ms/step - loss: 0.6315 - acc: 0.8277 - val_loss: 0.6121 - val_acc: 0.8265
Epoch 36/100
506/506 [==============================] - 24s 48ms/step - loss: 0.6154 - acc: 0.8308 - val_loss: 0.5803 - val_acc: 0.8434
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6031 - acc: 0.8341 - val_loss: 0.5736 - val_acc: 0.8390
Epoch 38/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5866 - acc: 0.8392 - val_loss: 0.5779 - val_acc: 0.8403
Epoch 39/100
506/506 [==============================] - 21s 41ms/step - loss: 0.5726 - acc: 0.8443 - val_loss: 0.5541 - val_acc: 0.8511
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5547 - acc: 0.8497 - val_loss: 0.5266 - val_acc: 0.8598
Epoch 41/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5457 - acc: 0.8502 - val_loss: 0.5289 - val_acc: 0.8548
Epoch 42/100
506/506 [==============================] - 21s 41ms/step - loss: 0.5327 - acc: 0.8537 - val_loss: 0.5485 - val_acc: 0.8447
Epoch 43/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5193 - acc: 0.8582 - val_loss: 0.5142 - val_acc: 0.8518
Epoch 44/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5068 - acc: 0.8620 - val_loss: 0.4897 - val_acc: 0.8695
Epoch 45/100
506/506 [==============================] - 21s 41ms/step - loss: 0.4970 - acc: 0.8644 - val_loss: 0.5511 - val_acc: 0.8392
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4827 - acc: 0.8695 - val_loss: 0.5576 - val_acc: 0.8434
Epoch 47/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4764 - acc: 0.8719 - val_loss: 0.4487 - val_acc: 0.8778
Epoch 48/100
506/506 [==============================] - 21s 41ms/step - loss: 0.4634 - acc: 0.8761 - val_loss: 0.4488 - val_acc: 0.8767
Epoch 49/100
506/506 [==============================] - 22s 44ms/step - loss: 0.4531 - acc: 0.8774 - val_loss: 0.4540 - val_acc: 0.8715
Epoch 50/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4449 - acc: 0.8787 - val_loss: 0.4415 - val_acc: 0.8795
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4348 - acc: 0.8825 - val_loss: 0.4199 - val_acc: 0.8832
Epoch 52/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4266 - acc: 0.8860 - val_loss: 0.4097 - val_acc: 0.8847
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4221 - acc: 0.8867 - val_loss: 0.4170 - val_acc: 0.8814
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4098 - acc: 0.8905 - val_loss: 0.3898 - val_acc: 0.8918
Epoch 55/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3989 - acc: 0.8939 - val_loss: 0.3992 - val_acc: 0.8847
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3946 - acc: 0.8932 - val_loss: 0.4003 - val_acc: 0.8907
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3863 - acc: 0.8953 - val_loss: 0.3676 - val_acc: 0.9011
Epoch 58/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3743 - acc: 0.9004 - val_loss: 0.3630 - val_acc: 0.9003
Epoch 59/100
506/506 [==============================] - 21s 41ms/step - loss: 0.3682 - acc: 0.9030 - val_loss: 0.3780 - val_acc: 0.8953
Epoch 60/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3633 - acc: 0.9031 - val_loss: 0.3545 - val_acc: 0.9080
Epoch 61/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3565 - acc: 0.9044 - val_loss: 0.3668 - val_acc: 0.8964
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3463 - acc: 0.9083 - val_loss: 0.3334 - val_acc: 0.9106
Epoch 63/100
506/506 [==============================] - 22s 44ms/step - loss: 0.3439 - acc: 0.9081 - val_loss: 0.3364 - val_acc: 0.9076
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3326 - acc: 0.9119 - val_loss: 0.3271 - val_acc: 0.9124
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3298 - acc: 0.9132 - val_loss: 0.3564 - val_acc: 0.9003
Epoch 66/100
506/506 [==============================] - 22s 44ms/step - loss: 0.3231 - acc: 0.9145 - val_loss: 0.3600 - val_acc: 0.8996
Epoch 67/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3257 - acc: 0.9131 - val_loss: 0.3118 - val_acc: 0.9098
Epoch 68/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3133 - acc: 0.9168 - val_loss: 0.3179 - val_acc: 0.9113
Epoch 69/100
506/506 [==============================] - 22s 44ms/step - loss: 0.3066 - acc: 0.9187 - val_loss: 0.2973 - val_acc: 0.9234
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2999 - acc: 0.9199 - val_loss: 0.2850 - val_acc: 0.9260
Epoch 71/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3211 - acc: 0.9161 - val_loss: 0.3151 - val_acc: 0.9089
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2888 - acc: 0.9245 - val_loss: 0.2790 - val_acc: 0.9275
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2853 - acc: 0.9249 - val_loss: 0.2881 - val_acc: 0.9223
Epoch 74/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2819 - acc: 0.9264 - val_loss: 0.2837 - val_acc: 0.9264
Epoch 75/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2757 - acc: 0.9280 - val_loss: 0.2978 - val_acc: 0.9152
Epoch 76/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2728 - acc: 0.9287 - val_loss: 0.2859 - val_acc: 0.9219
Epoch 77/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2672 - acc: 0.9300 - val_loss: 0.2614 - val_acc: 0.9334
Epoch 78/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2631 - acc: 0.9307 - val_loss: 0.2565 - val_acc: 0.9342
Epoch 79/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2602 - acc: 0.9316 - val_loss: 0.2503 - val_acc: 0.9336
Epoch 80/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2547 - acc: 0.9338 - val_loss: 0.2587 - val_acc: 0.9273
Epoch 81/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2515 - acc: 0.9336 - val_loss: 0.3094 - val_acc: 0.9122
Epoch 82/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2488 - acc: 0.9348 - val_loss: 0.2462 - val_acc: 0.9399
Epoch 83/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2407 - acc: 0.9393 - val_loss: 0.2520 - val_acc: 0.9293
Epoch 84/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2368 - acc: 0.9384 - val_loss: 0.2433 - val_acc: 0.9366
Epoch 85/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2350 - acc: 0.9397 - val_loss: 0.2402 - val_acc: 0.9364
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2313 - acc: 0.9399 - val_loss: 0.2339 - val_acc: 0.9366
Epoch 87/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2239 - acc: 0.9435 - val_loss: 0.2292 - val_acc: 0.9407
Epoch 88/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2224 - acc: 0.9427 - val_loss: 0.2290 - val_acc: 0.9375
Epoch 89/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2172 - acc: 0.9450 - val_loss: 0.2582 - val_acc: 0.9295
Epoch 90/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2142 - acc: 0.9456 - val_loss: 0.2744 - val_acc: 0.9260
Epoch 91/100
506/506 [==============================] - 22s 44ms/step - loss: 0.2154 - acc: 0.9446 - val_loss: 0.2191 - val_acc: 0.9409
Epoch 92/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2101 - acc: 0.9472 - val_loss: 0.2178 - val_acc: 0.9431
Epoch 93/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2085 - acc: 0.9466 - val_loss: 0.2173 - val_acc: 0.9466
Epoch 94/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2013 - acc: 0.9497 - val_loss: 0.2010 - val_acc: 0.9500
Epoch 95/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1998 - acc: 0.9499 - val_loss: 0.2075 - val_acc: 0.9498
Epoch 96/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1972 - acc: 0.9492 - val_loss: 0.1949 - val_acc: 0.9485
Epoch 97/100
506/506 [==============================] - 22s 44ms/step - loss: 0.1918 - acc: 0.9516 - val_loss: 0.2126 - val_acc: 0.9429
Epoch 98/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1897 - acc: 0.9524 - val_loss: 0.1910 - val_acc: 0.9498
Epoch 99/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1876 - acc: 0.9522 - val_loss: 0.1893 - val_acc: 0.9476

[INFO] Duração do treinamento: 39.7 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 45s 310ms/step - loss: 0.1923 - acc: 0.9483

Perda do teste: 0.192 
Acurácia do Teste: 94.83%

Gerando matriz de confusão tradicional...

[[396   2   0   2  16   0   2   0  12   0   0   4   0   0   1  15   0   0
    0   0   4]
 [  0 431   0   8   0   0   6   1   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 446   1   0   0   0   0   0   0   1   3   2   0   0   0   0   2
    0   0   0]
 [  0   1   0 429   1   1   2   0   0   0   0   0   0   0   4   0   0   1
    1   0   0]
 [  0   2   0  16 422   0   4   3   0   0   0   0   0   0   0   3   0   0
    0   0   0]
 [  0   9   0   7   2 394   1   3   1   0   0   1   0   0   0   1   2   0
    0   0   0]
 [  0   0   0  25   6   2 392   2   6   0   0   0   0   0   0   7   0   0
    0   0   0]
 [  0   0   0  28   3   8   2 383   1   0   0   0   0   0   0   8   0   0
    0   0   7]
 [  0   0   3   3   2   0   7   1 420   0   0   0   0   0   3   0   1   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 438   1   0   0   1   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  11 428   0   0   1   0   0   0   0
    0   0   0]
 [  2  12   2   1   1  18   2   1   4   0   0 391   2   0   0   0   0   0
    3   1   0]
 [  0   0  15   0   0   0   0   0   1   0   0   0 424   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   3   0   0 435   0   0   0   0
    0   0   0]
 [  0   3   0   7   0   0   1   1   0   0   0   0   0   0 424   0   0   4
    0   0   0]
 [  2   3   0   1   1   0   3   1   1   0   0   2   0   0   0 426   0   0
    0   0   0]
 [  0  11   0   6   1   4   0   4   0   0   0   1   0   0   0   1 405   0
    0   1   0]
 [  0  13   0   0   0   0   0   0   0   0   0   0   0   0   8   0   0 417
    1   1   0]
 [  0   0   0   0   0   0   0   2   0   0   0   0   0   0   1   0   0  15
  422   0   0]
 [  0   0   0   4   0   1   0   2   0   0   0   0   0   0   0   0   0   0
    1 433   0]
 [  0   0   0   0   0   1   1   3   0   0   0   1   0   0   0   8   0   0
    0   0 426]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.99      0.87      0.93       454
           B       0.89      0.97      0.92       446
           C       0.96      0.98      0.97       455
           D       0.80      0.97      0.88       440
           E       0.93      0.94      0.93       450
           F       0.92      0.94      0.93       421
           G       0.93      0.89      0.91       440
           I       0.94      0.87      0.90       440
           L       0.94      0.95      0.95       440
           M       0.97      1.00      0.98       440
           N       0.99      0.97      0.98       440
           O       0.97      0.89      0.93       440
           P       0.99      0.96      0.98       440
           Q       1.00      0.99      0.99       440
           R       0.96      0.96      0.96       440
           S       0.91      0.97      0.94       440
           T       0.99      0.93      0.96       434
           U       0.95      0.95      0.95       440
           V       0.99      0.96      0.97       440
           W       0.99      0.98      0.99       441
           Y       0.97      0.97      0.97       440

    accuracy                           0.95      9261
   macro avg       0.95      0.95      0.95      9261
weighted avg       0.95      0.95      0.95      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1039