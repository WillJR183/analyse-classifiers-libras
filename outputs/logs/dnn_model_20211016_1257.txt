[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.8 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_2 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_8 (Dense)              (None, 80)                983120    
_________________________________________________________________
dense_9 (Dense)              (None, 80)                6480      
_________________________________________________________________
dense_10 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_11 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 193s 382ms/step - loss: 2.9360 - acc: 0.1292 - val_loss: 2.8287 - val_acc: 0.1932
Epoch 2/100
506/506 [==============================] - 27s 53ms/step - loss: 2.6967 - acc: 0.2322 - val_loss: 2.5588 - val_acc: 0.2551
Epoch 3/100
506/506 [==============================] - 26s 52ms/step - loss: 2.4216 - acc: 0.2855 - val_loss: 2.2908 - val_acc: 0.3074
Epoch 4/100
506/506 [==============================] - 27s 53ms/step - loss: 2.1883 - acc: 0.3636 - val_loss: 2.0871 - val_acc: 0.4057
Epoch 5/100
506/506 [==============================] - 26s 52ms/step - loss: 1.9999 - acc: 0.4327 - val_loss: 1.9287 - val_acc: 0.4479
Epoch 6/100
506/506 [==============================] - 26s 52ms/step - loss: 1.8442 - acc: 0.4941 - val_loss: 1.7740 - val_acc: 0.5100
Epoch 7/100
506/506 [==============================] - 26s 52ms/step - loss: 1.7122 - acc: 0.5443 - val_loss: 1.6581 - val_acc: 0.5446
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5997 - acc: 0.5822 - val_loss: 1.5481 - val_acc: 0.5924
Epoch 9/100
506/506 [==============================] - 26s 52ms/step - loss: 1.4985 - acc: 0.6134 - val_loss: 1.4696 - val_acc: 0.6125
Epoch 10/100
506/506 [==============================] - 26s 52ms/step - loss: 1.4183 - acc: 0.6370 - val_loss: 1.3851 - val_acc: 0.6205
Epoch 11/100
506/506 [==============================] - 26s 52ms/step - loss: 1.3451 - acc: 0.6584 - val_loss: 1.3301 - val_acc: 0.6480
Epoch 12/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2827 - acc: 0.6752 - val_loss: 1.2711 - val_acc: 0.6588
Epoch 13/100
506/506 [==============================] - 29s 57ms/step - loss: 1.2282 - acc: 0.6864 - val_loss: 1.2196 - val_acc: 0.6724
Epoch 14/100
506/506 [==============================] - 26s 52ms/step - loss: 1.1801 - acc: 0.6996 - val_loss: 1.2084 - val_acc: 0.6724
Epoch 15/100
506/506 [==============================] - 23s 46ms/step - loss: 1.1363 - acc: 0.7105 - val_loss: 1.1766 - val_acc: 0.6893
Epoch 16/100
506/506 [==============================] - 22s 43ms/step - loss: 1.0971 - acc: 0.7205 - val_loss: 1.0833 - val_acc: 0.7252
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0586 - acc: 0.7316 - val_loss: 1.0528 - val_acc: 0.7220
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 1.0259 - acc: 0.7394 - val_loss: 1.0605 - val_acc: 0.7164
Epoch 19/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9909 - acc: 0.7455 - val_loss: 0.9818 - val_acc: 0.7391
Epoch 20/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9629 - acc: 0.7538 - val_loss: 0.9710 - val_acc: 0.7311
Epoch 21/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9344 - acc: 0.7615 - val_loss: 0.9168 - val_acc: 0.7620
Epoch 22/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9077 - acc: 0.7682 - val_loss: 0.8982 - val_acc: 0.7631
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8822 - acc: 0.7723 - val_loss: 0.8722 - val_acc: 0.7663
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8573 - acc: 0.7786 - val_loss: 0.8611 - val_acc: 0.7644
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8334 - acc: 0.7833 - val_loss: 0.8192 - val_acc: 0.7800
Epoch 26/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8131 - acc: 0.7886 - val_loss: 0.8234 - val_acc: 0.7843
Epoch 27/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7880 - acc: 0.7948 - val_loss: 0.8010 - val_acc: 0.7828
Epoch 28/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7682 - acc: 0.7984 - val_loss: 0.8076 - val_acc: 0.7696
Epoch 29/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7506 - acc: 0.8012 - val_loss: 0.7821 - val_acc: 0.7808
Epoch 30/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7300 - acc: 0.8062 - val_loss: 0.7231 - val_acc: 0.7999
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7128 - acc: 0.8094 - val_loss: 0.7023 - val_acc: 0.8051
Epoch 32/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6986 - acc: 0.8127 - val_loss: 0.7025 - val_acc: 0.8020
Epoch 33/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6815 - acc: 0.8180 - val_loss: 0.6976 - val_acc: 0.8018
Epoch 34/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6649 - acc: 0.8199 - val_loss: 0.6971 - val_acc: 0.7955
Epoch 35/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6487 - acc: 0.8253 - val_loss: 0.6933 - val_acc: 0.8077
Epoch 36/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6351 - acc: 0.8291 - val_loss: 0.6308 - val_acc: 0.8235
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6197 - acc: 0.8339 - val_loss: 0.6327 - val_acc: 0.8213
Epoch 38/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6065 - acc: 0.8345 - val_loss: 0.6080 - val_acc: 0.8258
Epoch 39/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5934 - acc: 0.8388 - val_loss: 0.5998 - val_acc: 0.8319
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5806 - acc: 0.8426 - val_loss: 0.5837 - val_acc: 0.8367
Epoch 41/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5685 - acc: 0.8436 - val_loss: 0.5574 - val_acc: 0.8460
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5587 - acc: 0.8476 - val_loss: 0.5579 - val_acc: 0.8447
Epoch 43/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5443 - acc: 0.8519 - val_loss: 0.5436 - val_acc: 0.8464
Epoch 44/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5340 - acc: 0.8541 - val_loss: 0.5416 - val_acc: 0.8533
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5247 - acc: 0.8562 - val_loss: 0.5402 - val_acc: 0.8481
Epoch 46/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5120 - acc: 0.8607 - val_loss: 0.5331 - val_acc: 0.8466
Epoch 47/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5015 - acc: 0.8627 - val_loss: 0.5085 - val_acc: 0.8576
Epoch 48/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4904 - acc: 0.8660 - val_loss: 0.5071 - val_acc: 0.8583
Epoch 49/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4819 - acc: 0.8676 - val_loss: 0.4983 - val_acc: 0.8615
Epoch 50/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4772 - acc: 0.8685 - val_loss: 0.5192 - val_acc: 0.8531
Epoch 51/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4642 - acc: 0.8729 - val_loss: 0.4615 - val_acc: 0.8711
Epoch 52/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4548 - acc: 0.8734 - val_loss: 0.4624 - val_acc: 0.8704
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4485 - acc: 0.8759 - val_loss: 0.4630 - val_acc: 0.8656
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4394 - acc: 0.8803 - val_loss: 0.4658 - val_acc: 0.8672
Epoch 55/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4315 - acc: 0.8799 - val_loss: 0.4899 - val_acc: 0.8460
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4245 - acc: 0.8833 - val_loss: 0.4254 - val_acc: 0.8825
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4140 - acc: 0.8860 - val_loss: 0.4162 - val_acc: 0.8849
Epoch 58/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4076 - acc: 0.8880 - val_loss: 0.4226 - val_acc: 0.8793
Epoch 59/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4028 - acc: 0.8882 - val_loss: 0.4295 - val_acc: 0.8801
Epoch 60/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3972 - acc: 0.8897 - val_loss: 0.3998 - val_acc: 0.8860
Epoch 61/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3867 - acc: 0.8932 - val_loss: 0.3931 - val_acc: 0.8877
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3827 - acc: 0.8960 - val_loss: 0.3995 - val_acc: 0.8849
Epoch 63/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3725 - acc: 0.8977 - val_loss: 0.4044 - val_acc: 0.8881
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3685 - acc: 0.8982 - val_loss: 0.3707 - val_acc: 0.8949
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3643 - acc: 0.9001 - val_loss: 0.3792 - val_acc: 0.8910
Epoch 66/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3567 - acc: 0.9011 - val_loss: 0.3914 - val_acc: 0.8855
Epoch 67/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3526 - acc: 0.9028 - val_loss: 0.3697 - val_acc: 0.8951
Epoch 68/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3451 - acc: 0.9054 - val_loss: 0.3542 - val_acc: 0.8994
Epoch 69/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3409 - acc: 0.9046 - val_loss: 0.3425 - val_acc: 0.9033
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3346 - acc: 0.9077 - val_loss: 0.3465 - val_acc: 0.9011
Epoch 71/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3299 - acc: 0.9092 - val_loss: 0.3496 - val_acc: 0.8987
Epoch 72/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3257 - acc: 0.9096 - val_loss: 0.3430 - val_acc: 0.9042
Epoch 73/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3193 - acc: 0.9127 - val_loss: 0.3324 - val_acc: 0.9044
Epoch 74/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3140 - acc: 0.9130 - val_loss: 0.3287 - val_acc: 0.9063
Epoch 75/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3075 - acc: 0.9175 - val_loss: 0.3300 - val_acc: 0.9104
Epoch 76/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3041 - acc: 0.9162 - val_loss: 0.3479 - val_acc: 0.9039
Epoch 77/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2989 - acc: 0.9176 - val_loss: 0.3080 - val_acc: 0.9141
Epoch 78/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2950 - acc: 0.9196 - val_loss: 0.3028 - val_acc: 0.9132
Epoch 79/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2915 - acc: 0.9201 - val_loss: 0.3060 - val_acc: 0.9115
Epoch 80/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2856 - acc: 0.9228 - val_loss: 0.3080 - val_acc: 0.9113
Epoch 81/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2826 - acc: 0.9238 - val_loss: 0.3306 - val_acc: 0.9022
Epoch 82/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2770 - acc: 0.9253 - val_loss: 0.3035 - val_acc: 0.9182
Epoch 83/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2769 - acc: 0.9250 - val_loss: 0.3210 - val_acc: 0.9124
Epoch 84/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2705 - acc: 0.9266 - val_loss: 0.2945 - val_acc: 0.9148
Epoch 85/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2679 - acc: 0.9285 - val_loss: 0.2891 - val_acc: 0.9141
Epoch 86/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2626 - acc: 0.9292 - val_loss: 0.2908 - val_acc: 0.9161
Epoch 87/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2589 - acc: 0.9310 - val_loss: 0.2796 - val_acc: 0.9228
Epoch 88/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2548 - acc: 0.9302 - val_loss: 0.2750 - val_acc: 0.9234
Epoch 89/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2608 - acc: 0.9299 - val_loss: 0.2749 - val_acc: 0.9221
Epoch 90/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2486 - acc: 0.9334 - val_loss: 0.2676 - val_acc: 0.9251
Epoch 91/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2443 - acc: 0.9347 - val_loss: 0.2653 - val_acc: 0.9238
Epoch 92/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2395 - acc: 0.9368 - val_loss: 0.2759 - val_acc: 0.9241
Epoch 93/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2377 - acc: 0.9375 - val_loss: 0.2823 - val_acc: 0.9225
Epoch 94/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2360 - acc: 0.9373 - val_loss: 0.2732 - val_acc: 0.9215
Epoch 95/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2306 - acc: 0.9391 - val_loss: 0.2664 - val_acc: 0.9254
Epoch 96/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2287 - acc: 0.9397 - val_loss: 0.2877 - val_acc: 0.9182
Epoch 97/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2263 - acc: 0.9414 - val_loss: 0.2809 - val_acc: 0.9189
Epoch 98/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2214 - acc: 0.9424 - val_loss: 0.2408 - val_acc: 0.9344
Epoch 99/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2202 - acc: 0.9426 - val_loss: 0.2385 - val_acc: 0.9351
Epoch 100/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2171 - acc: 0.9443 - val_loss: 0.2336 - val_acc: 0.9368

[INFO] Duração do treinamento: 39.7 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 46s 319ms/step - loss: 0.2269 - acc: 0.9388

Perda do teste: 0.227 
Acurácia do Teste: 93.88%

Gerando matriz de confusão tradicional...

[[404   1   0   3  13   2   1   8   5   0   0  10   0   0   0   1   0   0
    0   1   5]
 [  0 422   0   7   1   0   1   0   0   0   0   0   0   0   1   0  11   0
    0   3   0]
 [  0   0 440   0   4   0   0   0   0   0   1   6   0   0   0   0   0   0
    3   0   1]
 [  1   0   3 420   4   0   3   2   1   0   0   1   0   0   2   2   0   0
    1   0   0]
 [  2   1   0  12 412   0   7   7   1   0   0   4   0   0   0   2   1   0
    0   0   1]
 [  0   6   0   9   0 388   2   7   0   0   0   1   0   0   0   0   7   0
    0   1   0]
 [  0   0   0  34   3   1 379   9   6   0   0   2   0   0   1   3   1   0
    1   0   0]
 [  0   0   0  26   2   3   1 376   0   0   0   2   1   0   1  14   3   0
    0   3   8]
 [  0   0   1   4   1   0   7   0 411   0   0   1   0   0   5   6   1   0
    3   0   0]
 [  0   0   1   0   0   0   0   0   0 434   4   0   0   1   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  34 404   0   0   2   0   0   0   0
    0   0   0]
 [  0   2   3   4   1   2   1   4   0   0   0 414   5   0   0   1   0   0
    0   1   2]
 [  1   0   6   0   0   0   0   0   0   0   0   0 433   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   6   0   0 425   0   0   0   0
    0   0   0]
 [  0   2   0   2   0   0   0   0   0   0   0   0   0   0 411   0   0  23
    2   0   0]
 [  4   0   0   5   1   0   2   3   0   0   0   2   0   0   0 421   2   0
    0   0   0]
 [  0   1   0   2   0   6   0   2   0   0   0   0   0   0   0   1 412   0
    0   7   3]
 [  0   4   0   4   0   0   0   0   0   0   0   0   1   0   4   0   0 420
    6   1   0]
 [  0   0   0   2   0   0   0   2   0   0   0   0   0   0   2   0   0  24
  410   0   0]
 [  0   0   0   0   0   0   0   3   0   0   0   1   0   0   0   0   0   2
    0 435   0]
 [  2   0   1   0   0   0   0   3   3   0   0   0   0   0   0   8   0   0
    0   0 423]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.98      0.89      0.93       454
           B       0.96      0.95      0.95       446
           C       0.97      0.97      0.97       455
           D       0.79      0.95      0.86       440
           E       0.93      0.92      0.92       450
           F       0.97      0.92      0.94       421
           G       0.94      0.86      0.90       440
           I       0.88      0.85      0.87       440
           L       0.96      0.93      0.95       440
           M       0.91      0.99      0.95       440
           N       0.97      0.92      0.95       440
           O       0.93      0.94      0.94       440
           P       0.98      0.98      0.98       440
           Q       0.99      0.97      0.98       440
           R       0.96      0.93      0.95       440
           S       0.92      0.96      0.94       440
           T       0.94      0.95      0.94       434
           U       0.90      0.95      0.92       440
           V       0.96      0.93      0.95       440
           W       0.96      0.99      0.97       441
           Y       0.95      0.96      0.96       440

    accuracy                           0.94      9261
   macro avg       0.94      0.94      0.94      9261
weighted avg       0.94      0.94      0.94      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1258