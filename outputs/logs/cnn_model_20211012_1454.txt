[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_18 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_18 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_18 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_19 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_19 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_19 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_20 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_20 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_20 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_6 (Flatten)          (None, 2048)              0         
_________________________________________________________________
dense_12 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_13 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 223s 441ms/step - loss: 2.8832 - acc: 0.1022 - val_loss: 2.5150 - val_acc: 0.1874
Epoch 2/100
506/506 [==============================] - 57s 112ms/step - loss: 2.0437 - acc: 0.3883 - val_loss: 1.5524 - val_acc: 0.5848
Epoch 3/100
506/506 [==============================] - 56s 112ms/step - loss: 1.3371 - acc: 0.6295 - val_loss: 1.1567 - val_acc: 0.6761
Epoch 4/100
506/506 [==============================] - 57s 113ms/step - loss: 1.0496 - acc: 0.7192 - val_loss: 0.9351 - val_acc: 0.7577
Epoch 5/100
506/506 [==============================] - 57s 113ms/step - loss: 0.8850 - acc: 0.7703 - val_loss: 0.7932 - val_acc: 0.8018
Epoch 6/100
506/506 [==============================] - 57s 112ms/step - loss: 0.7667 - acc: 0.8017 - val_loss: 0.7101 - val_acc: 0.8170
Epoch 7/100
506/506 [==============================] - 57s 113ms/step - loss: 0.6722 - acc: 0.8243 - val_loss: 0.6214 - val_acc: 0.8351
Epoch 8/100
506/506 [==============================] - 57s 112ms/step - loss: 0.5949 - acc: 0.8414 - val_loss: 0.5476 - val_acc: 0.8559
Epoch 9/100
506/506 [==============================] - 57s 113ms/step - loss: 0.5294 - acc: 0.8566 - val_loss: 0.4863 - val_acc: 0.8734
Epoch 10/100
506/506 [==============================] - 57s 112ms/step - loss: 0.4696 - acc: 0.8699 - val_loss: 0.4428 - val_acc: 0.8845
Epoch 11/100
506/506 [==============================] - 57s 113ms/step - loss: 0.4180 - acc: 0.8846 - val_loss: 0.3939 - val_acc: 0.8990
Epoch 12/100
506/506 [==============================] - 57s 113ms/step - loss: 0.3768 - acc: 0.8947 - val_loss: 0.3608 - val_acc: 0.9065
Epoch 13/100
506/506 [==============================] - 57s 114ms/step - loss: 0.3398 - acc: 0.9060 - val_loss: 0.3552 - val_acc: 0.9003
Epoch 14/100
506/506 [==============================] - 58s 115ms/step - loss: 0.3032 - acc: 0.9175 - val_loss: 0.3009 - val_acc: 0.9221
Epoch 15/100
506/506 [==============================] - 57s 113ms/step - loss: 0.2796 - acc: 0.9228 - val_loss: 0.3305 - val_acc: 0.9076
Epoch 16/100
506/506 [==============================] - 58s 115ms/step - loss: 0.2491 - acc: 0.9325 - val_loss: 0.2560 - val_acc: 0.9327
Epoch 17/100
506/506 [==============================] - 57s 113ms/step - loss: 0.2271 - acc: 0.9392 - val_loss: 0.2278 - val_acc: 0.9403
Epoch 18/100
506/506 [==============================] - 58s 114ms/step - loss: 0.2073 - acc: 0.9455 - val_loss: 0.2156 - val_acc: 0.9435
Epoch 19/100
506/506 [==============================] - 58s 114ms/step - loss: 0.1916 - acc: 0.9487 - val_loss: 0.2448 - val_acc: 0.9357
Epoch 20/100
506/506 [==============================] - 57s 113ms/step - loss: 0.1746 - acc: 0.9537 - val_loss: 0.1863 - val_acc: 0.9548
Epoch 21/100
506/506 [==============================] - 57s 113ms/step - loss: 0.1631 - acc: 0.9570 - val_loss: 0.1816 - val_acc: 0.9567
Epoch 22/100
506/506 [==============================] - 58s 114ms/step - loss: 0.1503 - acc: 0.9607 - val_loss: 0.1590 - val_acc: 0.9602
Epoch 23/100
506/506 [==============================] - 58s 114ms/step - loss: 0.1394 - acc: 0.9629 - val_loss: 0.1526 - val_acc: 0.9619
Epoch 24/100
506/506 [==============================] - 58s 115ms/step - loss: 0.1270 - acc: 0.9673 - val_loss: 0.1675 - val_acc: 0.9550
Epoch 25/100
506/506 [==============================] - 59s 116ms/step - loss: 0.1191 - acc: 0.9694 - val_loss: 0.1457 - val_acc: 0.9593
Epoch 26/100
506/506 [==============================] - 59s 116ms/step - loss: 0.1107 - acc: 0.9713 - val_loss: 0.1534 - val_acc: 0.9615
Epoch 27/100
506/506 [==============================] - 58s 114ms/step - loss: 0.1037 - acc: 0.9739 - val_loss: 0.1212 - val_acc: 0.9699
Epoch 28/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0952 - acc: 0.9763 - val_loss: 0.1113 - val_acc: 0.9712
Epoch 29/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0884 - acc: 0.9785 - val_loss: 0.1149 - val_acc: 0.9725
Epoch 30/100
506/506 [==============================] - 58s 114ms/step - loss: 0.0839 - acc: 0.9781 - val_loss: 0.1039 - val_acc: 0.9717
Epoch 31/100
506/506 [==============================] - 59s 116ms/step - loss: 0.0795 - acc: 0.9806 - val_loss: 0.0997 - val_acc: 0.9738
Epoch 32/100
506/506 [==============================] - 58s 116ms/step - loss: 0.0737 - acc: 0.9821 - val_loss: 0.1019 - val_acc: 0.9747
Epoch 33/100
506/506 [==============================] - 58s 114ms/step - loss: 0.0700 - acc: 0.9830 - val_loss: 0.0889 - val_acc: 0.9756
Epoch 34/100
506/506 [==============================] - 65s 129ms/step - loss: 0.0652 - acc: 0.9841 - val_loss: 0.0838 - val_acc: 0.9797
Epoch 35/100
506/506 [==============================] - 58s 114ms/step - loss: 0.0609 - acc: 0.9856 - val_loss: 0.0779 - val_acc: 0.9799
Epoch 36/100
506/506 [==============================] - 59s 116ms/step - loss: 0.0574 - acc: 0.9857 - val_loss: 0.0946 - val_acc: 0.9727
Epoch 37/100
506/506 [==============================] - 58s 115ms/step - loss: 0.0527 - acc: 0.9872 - val_loss: 0.0820 - val_acc: 0.9801
Epoch 38/100
506/506 [==============================] - 57s 114ms/step - loss: 0.0492 - acc: 0.9888 - val_loss: 0.0738 - val_acc: 0.9794
Epoch 39/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0485 - acc: 0.9886 - val_loss: 0.0643 - val_acc: 0.9829
Epoch 40/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0451 - acc: 0.9899 - val_loss: 0.0633 - val_acc: 0.9840
Epoch 41/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0418 - acc: 0.9901 - val_loss: 0.0553 - val_acc: 0.9862
Epoch 42/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0425 - acc: 0.9899 - val_loss: 0.0599 - val_acc: 0.9849
Epoch 43/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0391 - acc: 0.9910 - val_loss: 0.0730 - val_acc: 0.9805
Epoch 44/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0346 - acc: 0.9926 - val_loss: 0.0634 - val_acc: 0.9846
Epoch 45/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0323 - acc: 0.9928 - val_loss: 0.0475 - val_acc: 0.9879
Epoch 46/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0333 - acc: 0.9918 - val_loss: 0.0637 - val_acc: 0.9842
Epoch 47/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0291 - acc: 0.9940 - val_loss: 0.0455 - val_acc: 0.9890
Epoch 48/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0275 - acc: 0.9939 - val_loss: 0.0392 - val_acc: 0.9907
Epoch 49/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0249 - acc: 0.9945 - val_loss: 0.0456 - val_acc: 0.9892
Epoch 50/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0250 - acc: 0.9944 - val_loss: 0.0444 - val_acc: 0.9890
Epoch 51/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0250 - acc: 0.9939 - val_loss: 0.0405 - val_acc: 0.9898
Epoch 52/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0245 - acc: 0.9939 - val_loss: 0.0351 - val_acc: 0.9926
Epoch 53/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0199 - acc: 0.9957 - val_loss: 0.0599 - val_acc: 0.9836
Epoch 54/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0204 - acc: 0.9955 - val_loss: 0.0319 - val_acc: 0.9916
Epoch 55/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0176 - acc: 0.9964 - val_loss: 0.0320 - val_acc: 0.9922
Epoch 56/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0194 - acc: 0.9960 - val_loss: 0.0336 - val_acc: 0.9926
Epoch 57/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0165 - acc: 0.9965 - val_loss: 0.0376 - val_acc: 0.9903

[INFO] Duração do treinamento: 57.5 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 55s 381ms/step - loss: 0.0429 - acc: 0.9897

Perda do teste: 0.043 
Acurácia do Teste: 98.97%

Gerando matriz de confusão tradicional...

[[449   0   0   0   2   0   0   0   0   0   0   0   0   0   0   3   0   0
    0   0   0]
 [  0 445   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0 455   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0 436   0   0   0   0   0   0   0   0   0   0   4   0   0   0
    0   0   0]
 [  0   0   0   0 449   0   0   0   0   0   0   0   0   0   0   1   0   0
    0   0   0]
 [  0   0   0   0   0 413   0   0   0   0   0   6   0   0   0   0   2   0
    0   0   0]
 [  0   0   0  13   0   0 427   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   9   0   1 430   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   1   0   0   0   7   0 432   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 438   2   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   9 428   0   0   3   0   0   0   0
    0   0   0]
 [  0   0   3   0   0   1   0   0   0   1   0 435   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0   0   0   0   0   0   0   0   0 436   0   0   3
    0   0   0]
 [  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0 436   0   0
    0   0   0]
 [  0   0   0   0   0   1   0   5   0   0   0   0   0   0   0   0 428   0
    0   0   0]
 [  0   0   1   0   0   0   1   0   0   0   0   0   0   0   0   0   0 438
    0   0   0]
 [  0   0   0   0   0   0   0   0   2   0   0   1   0   0   2   0   0   0
  432   3   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0 441   0]
 [  0   0   0   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    0   0 438]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.99      0.99      0.99       454
           B       1.00      1.00      1.00       446
           C       0.99      1.00      0.99       455
           D       0.97      0.99      0.98       440
           E       0.98      1.00      0.99       450
           F       1.00      0.98      0.99       421
           G       0.98      0.97      0.97       440
           I       0.99      0.98      0.98       440
           L       1.00      0.98      0.99       440
           M       0.98      1.00      0.99       440
           N       1.00      0.97      0.98       440
           O       0.98      0.99      0.98       440
           P       1.00      1.00      1.00       440
           Q       0.99      1.00      1.00       440
           R       0.99      0.99      0.99       440
           S       0.99      0.99      0.99       440
           T       1.00      0.99      0.99       434
           U       0.99      1.00      0.99       440
           V       1.00      0.98      0.99       440
           W       0.99      1.00      1.00       441
           Y       1.00      1.00      1.00       440

    accuracy                           0.99      9261
   macro avg       0.99      0.99      0.99      9261
weighted avg       0.99      0.99      0.99      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_1456