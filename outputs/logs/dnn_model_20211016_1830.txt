[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten_8 (Flatten)          (None, 12288)             0         
_________________________________________________________________
dense_32 (Dense)             (None, 80)                983120    
_________________________________________________________________
dense_33 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_34 (Dense)             (None, 80)                6480      
_________________________________________________________________
dense_35 (Dense)             (None, 21)                1701      
=================================================================
Total params: 997,781
Trainable params: 997,781
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 188s 372ms/step - loss: 2.9541 - acc: 0.1204 - val_loss: 2.8638 - val_acc: 0.1952
Epoch 2/100
506/506 [==============================] - 27s 53ms/step - loss: 2.7402 - acc: 0.2335 - val_loss: 2.6009 - val_acc: 0.2906
Epoch 3/100
506/506 [==============================] - 26s 52ms/step - loss: 2.4225 - acc: 0.3349 - val_loss: 2.2514 - val_acc: 0.4161
Epoch 4/100
506/506 [==============================] - 27s 52ms/step - loss: 2.0866 - acc: 0.4489 - val_loss: 1.9681 - val_acc: 0.4386
Epoch 5/100
506/506 [==============================] - 27s 53ms/step - loss: 1.8417 - acc: 0.5178 - val_loss: 1.7688 - val_acc: 0.5485
Epoch 6/100
506/506 [==============================] - 27s 52ms/step - loss: 1.6611 - acc: 0.5691 - val_loss: 1.6001 - val_acc: 0.6136
Epoch 7/100
506/506 [==============================] - 26s 52ms/step - loss: 1.5241 - acc: 0.6092 - val_loss: 1.4708 - val_acc: 0.6151
Epoch 8/100
506/506 [==============================] - 26s 52ms/step - loss: 1.4153 - acc: 0.6396 - val_loss: 1.3917 - val_acc: 0.6465
Epoch 9/100
506/506 [==============================] - 27s 53ms/step - loss: 1.3311 - acc: 0.6637 - val_loss: 1.3125 - val_acc: 0.6688
Epoch 10/100
506/506 [==============================] - 28s 56ms/step - loss: 1.2609 - acc: 0.6822 - val_loss: 1.2958 - val_acc: 0.6350
Epoch 11/100
506/506 [==============================] - 26s 52ms/step - loss: 1.2006 - acc: 0.6998 - val_loss: 1.1782 - val_acc: 0.7034
Epoch 12/100
506/506 [==============================] - 26s 52ms/step - loss: 1.1507 - acc: 0.7136 - val_loss: 1.1607 - val_acc: 0.6850
Epoch 13/100
506/506 [==============================] - 26s 52ms/step - loss: 1.1051 - acc: 0.7247 - val_loss: 1.1046 - val_acc: 0.7298
Epoch 14/100
506/506 [==============================] - 26s 52ms/step - loss: 1.0614 - acc: 0.7360 - val_loss: 1.0433 - val_acc: 0.7419
Epoch 15/100
506/506 [==============================] - 26s 52ms/step - loss: 1.0242 - acc: 0.7433 - val_loss: 1.0163 - val_acc: 0.7430
Epoch 16/100
506/506 [==============================] - 23s 45ms/step - loss: 0.9904 - acc: 0.7500 - val_loss: 0.9947 - val_acc: 0.7492
Epoch 17/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9572 - acc: 0.7580 - val_loss: 0.9573 - val_acc: 0.7618
Epoch 18/100
506/506 [==============================] - 21s 42ms/step - loss: 0.9256 - acc: 0.7648 - val_loss: 0.9280 - val_acc: 0.7694
Epoch 19/100
506/506 [==============================] - 21s 42ms/step - loss: 0.8982 - acc: 0.7731 - val_loss: 0.9219 - val_acc: 0.7678
Epoch 20/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8704 - acc: 0.7786 - val_loss: 0.8681 - val_acc: 0.7828
Epoch 21/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8417 - acc: 0.7835 - val_loss: 0.8439 - val_acc: 0.7802
Epoch 22/100
506/506 [==============================] - 22s 43ms/step - loss: 0.8174 - acc: 0.7896 - val_loss: 0.8179 - val_acc: 0.7910
Epoch 23/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7924 - acc: 0.7956 - val_loss: 0.7983 - val_acc: 0.7994
Epoch 24/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7705 - acc: 0.7990 - val_loss: 0.7749 - val_acc: 0.8005
Epoch 25/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7479 - acc: 0.8052 - val_loss: 0.7867 - val_acc: 0.7945
Epoch 26/100
506/506 [==============================] - 22s 43ms/step - loss: 0.7268 - acc: 0.8098 - val_loss: 0.7294 - val_acc: 0.8090
Epoch 27/100
506/506 [==============================] - 21s 42ms/step - loss: 0.7048 - acc: 0.8165 - val_loss: 0.7270 - val_acc: 0.8072
Epoch 28/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6859 - acc: 0.8208 - val_loss: 0.6932 - val_acc: 0.8209
Epoch 29/100
506/506 [==============================] - 22s 43ms/step - loss: 0.6702 - acc: 0.8224 - val_loss: 0.6818 - val_acc: 0.8202
Epoch 30/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6489 - acc: 0.8279 - val_loss: 0.6642 - val_acc: 0.8241
Epoch 31/100
506/506 [==============================] - 21s 42ms/step - loss: 0.6310 - acc: 0.8320 - val_loss: 0.6372 - val_acc: 0.8347
Epoch 32/100
506/506 [==============================] - 22s 42ms/step - loss: 0.6154 - acc: 0.8367 - val_loss: 0.6320 - val_acc: 0.8336
Epoch 33/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5995 - acc: 0.8397 - val_loss: 0.6345 - val_acc: 0.8282
Epoch 34/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5835 - acc: 0.8448 - val_loss: 0.5973 - val_acc: 0.8444
Epoch 35/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5705 - acc: 0.8468 - val_loss: 0.5671 - val_acc: 0.8535
Epoch 36/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5565 - acc: 0.8514 - val_loss: 0.5688 - val_acc: 0.8488
Epoch 37/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5400 - acc: 0.8544 - val_loss: 0.5489 - val_acc: 0.8594
Epoch 38/100
506/506 [==============================] - 22s 43ms/step - loss: 0.5272 - acc: 0.8587 - val_loss: 0.5258 - val_acc: 0.8596
Epoch 39/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5151 - acc: 0.8604 - val_loss: 0.5227 - val_acc: 0.8594
Epoch 40/100
506/506 [==============================] - 21s 42ms/step - loss: 0.5027 - acc: 0.8633 - val_loss: 0.5039 - val_acc: 0.8704
Epoch 41/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4901 - acc: 0.8682 - val_loss: 0.4948 - val_acc: 0.8711
Epoch 42/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4811 - acc: 0.8693 - val_loss: 0.4737 - val_acc: 0.8773
Epoch 43/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4696 - acc: 0.8726 - val_loss: 0.4771 - val_acc: 0.8736
Epoch 44/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4588 - acc: 0.8759 - val_loss: 0.4661 - val_acc: 0.8797
Epoch 45/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4484 - acc: 0.8779 - val_loss: 0.4660 - val_acc: 0.8782
Epoch 46/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4386 - acc: 0.8813 - val_loss: 0.4480 - val_acc: 0.8832
Epoch 47/100
506/506 [==============================] - 22s 42ms/step - loss: 0.4300 - acc: 0.8854 - val_loss: 0.4412 - val_acc: 0.8888
Epoch 48/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4193 - acc: 0.8886 - val_loss: 0.4316 - val_acc: 0.8845
Epoch 49/100
506/506 [==============================] - 22s 43ms/step - loss: 0.4123 - acc: 0.8885 - val_loss: 0.4274 - val_acc: 0.8830
Epoch 50/100
506/506 [==============================] - 21s 42ms/step - loss: 0.4028 - acc: 0.8924 - val_loss: 0.4216 - val_acc: 0.8830
Epoch 51/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3950 - acc: 0.8942 - val_loss: 0.4032 - val_acc: 0.8970
Epoch 52/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3894 - acc: 0.8944 - val_loss: 0.3863 - val_acc: 0.8994
Epoch 53/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3812 - acc: 0.8989 - val_loss: 0.4043 - val_acc: 0.8905
Epoch 54/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3735 - acc: 0.9018 - val_loss: 0.3969 - val_acc: 0.8944
Epoch 55/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3665 - acc: 0.9031 - val_loss: 0.3989 - val_acc: 0.8903
Epoch 56/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3587 - acc: 0.9043 - val_loss: 0.3694 - val_acc: 0.9046
Epoch 57/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3515 - acc: 0.9080 - val_loss: 0.3609 - val_acc: 0.9085
Epoch 58/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3457 - acc: 0.9085 - val_loss: 0.3741 - val_acc: 0.8992
Epoch 59/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3396 - acc: 0.9102 - val_loss: 0.3550 - val_acc: 0.9100
Epoch 60/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3333 - acc: 0.9126 - val_loss: 0.3474 - val_acc: 0.9124
Epoch 61/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3289 - acc: 0.9132 - val_loss: 0.3491 - val_acc: 0.9087
Epoch 62/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3216 - acc: 0.9153 - val_loss: 0.3390 - val_acc: 0.9124
Epoch 63/100
506/506 [==============================] - 22s 43ms/step - loss: 0.3168 - acc: 0.9185 - val_loss: 0.3139 - val_acc: 0.9206
Epoch 64/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3104 - acc: 0.9188 - val_loss: 0.3597 - val_acc: 0.8972
Epoch 65/100
506/506 [==============================] - 21s 42ms/step - loss: 0.3040 - acc: 0.9211 - val_loss: 0.3132 - val_acc: 0.9202
Epoch 66/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2998 - acc: 0.9223 - val_loss: 0.3323 - val_acc: 0.9124
Epoch 67/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2973 - acc: 0.9222 - val_loss: 0.3146 - val_acc: 0.9156
Epoch 68/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2889 - acc: 0.9259 - val_loss: 0.2964 - val_acc: 0.9271
Epoch 69/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2841 - acc: 0.9278 - val_loss: 0.3114 - val_acc: 0.9191
Epoch 70/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2796 - acc: 0.9288 - val_loss: 0.2890 - val_acc: 0.9232
Epoch 71/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2748 - acc: 0.9305 - val_loss: 0.2817 - val_acc: 0.9297
Epoch 72/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2705 - acc: 0.9317 - val_loss: 0.3042 - val_acc: 0.9156
Epoch 73/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2648 - acc: 0.9337 - val_loss: 0.2785 - val_acc: 0.9288
Epoch 74/100
506/506 [==============================] - 22s 42ms/step - loss: 0.2638 - acc: 0.9330 - val_loss: 0.3039 - val_acc: 0.9208
Epoch 75/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2592 - acc: 0.9338 - val_loss: 0.2668 - val_acc: 0.9314
Epoch 76/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2539 - acc: 0.9352 - val_loss: 0.2676 - val_acc: 0.9308
Epoch 77/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2504 - acc: 0.9368 - val_loss: 0.2580 - val_acc: 0.9314
Epoch 78/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2443 - acc: 0.9402 - val_loss: 0.2647 - val_acc: 0.9305
Epoch 79/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2407 - acc: 0.9394 - val_loss: 0.2546 - val_acc: 0.9342
Epoch 80/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2366 - acc: 0.9411 - val_loss: 0.2538 - val_acc: 0.9366
Epoch 81/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2354 - acc: 0.9406 - val_loss: 0.2572 - val_acc: 0.9331
Epoch 82/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2290 - acc: 0.9435 - val_loss: 0.2529 - val_acc: 0.9362
Epoch 83/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2261 - acc: 0.9439 - val_loss: 0.2356 - val_acc: 0.9420
Epoch 84/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2229 - acc: 0.9443 - val_loss: 0.2392 - val_acc: 0.9401
Epoch 85/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2195 - acc: 0.9452 - val_loss: 0.2385 - val_acc: 0.9392
Epoch 86/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2177 - acc: 0.9463 - val_loss: 0.2231 - val_acc: 0.9450
Epoch 87/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2133 - acc: 0.9487 - val_loss: 0.2197 - val_acc: 0.9442
Epoch 88/100
506/506 [==============================] - 22s 43ms/step - loss: 0.2096 - acc: 0.9487 - val_loss: 0.2268 - val_acc: 0.9366
Epoch 89/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2080 - acc: 0.9498 - val_loss: 0.2371 - val_acc: 0.9377
Epoch 90/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2026 - acc: 0.9509 - val_loss: 0.2303 - val_acc: 0.9405
Epoch 91/100
506/506 [==============================] - 21s 42ms/step - loss: 0.2006 - acc: 0.9515 - val_loss: 0.2235 - val_acc: 0.9463
Epoch 92/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1964 - acc: 0.9530 - val_loss: 0.2028 - val_acc: 0.9472
Epoch 93/100
506/506 [==============================] - 21s 42ms/step - loss: 0.1944 - acc: 0.9530 - val_loss: 0.2220 - val_acc: 0.9399
Epoch 94/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1918 - acc: 0.9532 - val_loss: 0.1983 - val_acc: 0.9509
Epoch 95/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1881 - acc: 0.9552 - val_loss: 0.1947 - val_acc: 0.9505
Epoch 96/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1860 - acc: 0.9552 - val_loss: 0.2144 - val_acc: 0.9453
Epoch 97/100
506/506 [==============================] - 23s 46ms/step - loss: 0.1841 - acc: 0.9557 - val_loss: 0.1966 - val_acc: 0.9518
Epoch 98/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1798 - acc: 0.9565 - val_loss: 0.2067 - val_acc: 0.9468
Epoch 99/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1757 - acc: 0.9580 - val_loss: 0.1870 - val_acc: 0.9567
Epoch 100/100
506/506 [==============================] - 22s 43ms/step - loss: 0.1760 - acc: 0.9582 - val_loss: 0.1973 - val_acc: 0.9531

[INFO] Duração do treinamento: 39.9 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 44s 307ms/step - loss: 0.2043 - acc: 0.9487

Perda do teste: 0.204 
Acurácia do Teste: 94.87%

Gerando matriz de confusão tradicional...

[[440   0   0   0   5   0   4   0   1   0   0   0   0   0   0   4   0   0
    0   0   0]
 [  0 411   0   0   7   3   4  13   0   0   0   1   0   0   0   1   6   0
    0   0   0]
 [  1   0 438   0   3   0   0   0   1   0   0   5   0   0   0   1   1   2
    2   0   1]
 [  5   0   0 382   6   0  31   0   2   0   0   0   0   0  10   0   0   0
    4   0   0]
 [  8   0   0   1 417   0  18   4   1   0   0   0   0   0   0   1   0   0
    0   0   0]
 [  0   4   0   0   0 376   3   7   0   0   0   9   0   0   3   1  18   0
    0   0   0]
 [  4   0   0   0   1   0 422   3   3   0   0   1   0   0   2   3   0   0
    0   0   1]
 [  3   2   0   2   3   3  16 382   0   0   0   1   0   0   7  17   1   0
    0   0   3]
 [  2   0   2   0   0   0  15   2 417   0   0   1   0   0   1   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 425  13   0   0   2   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 434   0   0   6   0   0   0   0
    0   0   0]
 [  9   6   1   0   4   3   4   3   4   0   0 398   1   0   0   0   0   0
    1   2   4]
 [  0   0   1   0   0   0   0   0   4   0   0   2 433   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   2   0   0 432   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0   2   0   1   0   0   0   0   0 433   0   0   2
    1   0   0]
 [  7   2   0   0   0   0   2   0   0   0   0   1   0   0   0 428   0   0
    0   0   0]
 [  0   0   0   0   0   2   0   3   0   0   0   0   0   0   0   0 427   0
    0   2   0]
 [  0   2   0   0   0   0   0   0   0   0   0   1   0   0  11   0   0 424
    0   2   0]
 [  0   1   0   0   0   0   0   0   0   0   0   0   0   0   7   0   0  12
  417   3   0]
 [  0   3   0   0   0   1   0   1   0   0   0   0   0   0   0   0   4   0
    0 432   0]
 [ 10   0   0   0   0   0   0   3   0   0   0   0   0   0   0   9   0   0
    0   0 418]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.90      0.97      0.93       454
           B       0.95      0.92      0.94       446
           C       0.99      0.96      0.98       455
           D       0.99      0.87      0.92       440
           E       0.93      0.93      0.93       450
           F       0.97      0.89      0.93       421
           G       0.81      0.96      0.88       440
           I       0.91      0.87      0.89       440
           L       0.96      0.95      0.95       440
           M       0.99      0.97      0.98       440
           N       0.97      0.99      0.98       440
           O       0.95      0.90      0.93       440
           P       1.00      0.98      0.99       440
           Q       0.98      0.98      0.98       440
           R       0.91      0.98      0.95       440
           S       0.92      0.97      0.95       440
           T       0.93      0.98      0.96       434
           U       0.96      0.96      0.96       440
           V       0.98      0.95      0.96       440
           W       0.98      0.98      0.98       441
           Y       0.98      0.95      0.96       440

    accuracy                           0.95      9261
   macro avg       0.95      0.95      0.95      9261
weighted avg       0.95      0.95      0.95      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211016_1831