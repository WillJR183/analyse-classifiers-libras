[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.7 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_27 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_27 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_27 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_28 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_28 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_28 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_29 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_29 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_29 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_9 (Flatten)          (None, 2048)              0         
_________________________________________________________________
dense_18 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_19 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 221s 437ms/step - loss: 2.9326 - acc: 0.1198 - val_loss: 2.6052 - val_acc: 0.2114
Epoch 2/100
506/506 [==============================] - 55s 109ms/step - loss: 2.1797 - acc: 0.3259 - val_loss: 1.8388 - val_acc: 0.4604
Epoch 3/100
506/506 [==============================] - 54s 107ms/step - loss: 1.5825 - acc: 0.5419 - val_loss: 1.3859 - val_acc: 0.6034
Epoch 4/100
506/506 [==============================] - 55s 109ms/step - loss: 1.2698 - acc: 0.6349 - val_loss: 1.1484 - val_acc: 0.6709
Epoch 5/100
506/506 [==============================] - 55s 109ms/step - loss: 1.0898 - acc: 0.6821 - val_loss: 1.0141 - val_acc: 0.7038
Epoch 6/100
506/506 [==============================] - 56s 110ms/step - loss: 0.9627 - acc: 0.7217 - val_loss: 0.9026 - val_acc: 0.7475
Epoch 7/100
506/506 [==============================] - 56s 110ms/step - loss: 0.8671 - acc: 0.7560 - val_loss: 0.8247 - val_acc: 0.7635
Epoch 8/100
506/506 [==============================] - 55s 109ms/step - loss: 0.7954 - acc: 0.7753 - val_loss: 0.7536 - val_acc: 0.7910
Epoch 9/100
506/506 [==============================] - 55s 109ms/step - loss: 0.7402 - acc: 0.7877 - val_loss: 0.7026 - val_acc: 0.7999
Epoch 10/100
506/506 [==============================] - 55s 110ms/step - loss: 0.6851 - acc: 0.8051 - val_loss: 0.6697 - val_acc: 0.8048
Epoch 11/100
506/506 [==============================] - 56s 110ms/step - loss: 0.6439 - acc: 0.8126 - val_loss: 0.6392 - val_acc: 0.8131
Epoch 12/100
506/506 [==============================] - 55s 109ms/step - loss: 0.6084 - acc: 0.8240 - val_loss: 0.6081 - val_acc: 0.8245
Epoch 13/100
506/506 [==============================] - 56s 110ms/step - loss: 0.5780 - acc: 0.8316 - val_loss: 0.5642 - val_acc: 0.8360
Epoch 14/100
506/506 [==============================] - 56s 110ms/step - loss: 0.5495 - acc: 0.8381 - val_loss: 0.5353 - val_acc: 0.8490
Epoch 15/100
506/506 [==============================] - 56s 111ms/step - loss: 0.5265 - acc: 0.8439 - val_loss: 0.5159 - val_acc: 0.8501
Epoch 16/100
506/506 [==============================] - 56s 110ms/step - loss: 0.5061 - acc: 0.8485 - val_loss: 0.5004 - val_acc: 0.8514
Epoch 17/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4856 - acc: 0.8535 - val_loss: 0.5095 - val_acc: 0.8462
Epoch 18/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4720 - acc: 0.8557 - val_loss: 0.4758 - val_acc: 0.8544
Epoch 19/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4509 - acc: 0.8620 - val_loss: 0.4482 - val_acc: 0.8682
Epoch 20/100
506/506 [==============================] - 56s 111ms/step - loss: 0.4385 - acc: 0.8658 - val_loss: 0.4244 - val_acc: 0.8726
Epoch 21/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4240 - acc: 0.8706 - val_loss: 0.4130 - val_acc: 0.8769
Epoch 22/100
506/506 [==============================] - 56s 110ms/step - loss: 0.4115 - acc: 0.8744 - val_loss: 0.4859 - val_acc: 0.8524
Epoch 23/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3977 - acc: 0.8783 - val_loss: 0.4003 - val_acc: 0.8799
Epoch 24/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3849 - acc: 0.8831 - val_loss: 0.3725 - val_acc: 0.8881
Epoch 25/100
506/506 [==============================] - 58s 114ms/step - loss: 0.3741 - acc: 0.8858 - val_loss: 0.3713 - val_acc: 0.8873
Epoch 26/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3620 - acc: 0.8910 - val_loss: 0.3653 - val_acc: 0.8884
Epoch 27/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3542 - acc: 0.8923 - val_loss: 0.3514 - val_acc: 0.8951
Epoch 28/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3401 - acc: 0.8959 - val_loss: 0.3377 - val_acc: 0.8966
Epoch 29/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3331 - acc: 0.8987 - val_loss: 0.3299 - val_acc: 0.8987
Epoch 30/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3218 - acc: 0.9017 - val_loss: 0.3133 - val_acc: 0.9065
Epoch 31/100
506/506 [==============================] - 56s 110ms/step - loss: 0.3123 - acc: 0.9050 - val_loss: 0.3368 - val_acc: 0.9018
Epoch 32/100
506/506 [==============================] - 56s 111ms/step - loss: 0.3061 - acc: 0.9056 - val_loss: 0.3022 - val_acc: 0.9083
Epoch 33/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2971 - acc: 0.9104 - val_loss: 0.2971 - val_acc: 0.9152
Epoch 34/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2880 - acc: 0.9129 - val_loss: 0.2896 - val_acc: 0.9141
Epoch 35/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2827 - acc: 0.9140 - val_loss: 0.2764 - val_acc: 0.9158
Epoch 36/100
506/506 [==============================] - 56s 112ms/step - loss: 0.2773 - acc: 0.9161 - val_loss: 0.2825 - val_acc: 0.9132
Epoch 37/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2678 - acc: 0.9180 - val_loss: 0.2655 - val_acc: 0.9217
Epoch 38/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2623 - acc: 0.9199 - val_loss: 0.2718 - val_acc: 0.9180
Epoch 39/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2538 - acc: 0.9221 - val_loss: 0.2583 - val_acc: 0.9247
Epoch 40/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2477 - acc: 0.9248 - val_loss: 0.2712 - val_acc: 0.9195
Epoch 41/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2443 - acc: 0.9262 - val_loss: 0.2534 - val_acc: 0.9260
Epoch 42/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2336 - acc: 0.9305 - val_loss: 0.2346 - val_acc: 0.9316
Epoch 43/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2311 - acc: 0.9308 - val_loss: 0.2368 - val_acc: 0.9258
Epoch 44/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2275 - acc: 0.9315 - val_loss: 0.2305 - val_acc: 0.9316
Epoch 45/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2207 - acc: 0.9337 - val_loss: 0.2142 - val_acc: 0.9405
Epoch 46/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2156 - acc: 0.9344 - val_loss: 0.2116 - val_acc: 0.9407
Epoch 47/100
506/506 [==============================] - 56s 111ms/step - loss: 0.2081 - acc: 0.9384 - val_loss: 0.2153 - val_acc: 0.9401
Epoch 48/100
506/506 [==============================] - 56s 110ms/step - loss: 0.2056 - acc: 0.9387 - val_loss: 0.2136 - val_acc: 0.9362
Epoch 49/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1983 - acc: 0.9411 - val_loss: 0.2016 - val_acc: 0.9429
Epoch 50/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1942 - acc: 0.9417 - val_loss: 0.2124 - val_acc: 0.9325
Epoch 51/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1912 - acc: 0.9424 - val_loss: 0.1931 - val_acc: 0.9455
Epoch 52/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1874 - acc: 0.9438 - val_loss: 0.1827 - val_acc: 0.9483
Epoch 53/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1780 - acc: 0.9476 - val_loss: 0.1899 - val_acc: 0.9435
Epoch 54/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1793 - acc: 0.9471 - val_loss: 0.2055 - val_acc: 0.9383
Epoch 55/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1732 - acc: 0.9486 - val_loss: 0.1944 - val_acc: 0.9414
Epoch 56/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1676 - acc: 0.9497 - val_loss: 0.1687 - val_acc: 0.9485
Epoch 57/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1654 - acc: 0.9507 - val_loss: 0.1627 - val_acc: 0.9505
Epoch 58/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1633 - acc: 0.9510 - val_loss: 0.1626 - val_acc: 0.9511
Epoch 59/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1582 - acc: 0.9528 - val_loss: 0.1629 - val_acc: 0.9511
Epoch 60/100
506/506 [==============================] - 57s 113ms/step - loss: 0.1527 - acc: 0.9548 - val_loss: 0.1548 - val_acc: 0.9548
Epoch 61/100
506/506 [==============================] - 64s 126ms/step - loss: 0.1522 - acc: 0.9542 - val_loss: 0.1569 - val_acc: 0.9515
Epoch 62/100
506/506 [==============================] - 60s 119ms/step - loss: 0.1463 - acc: 0.9559 - val_loss: 0.1638 - val_acc: 0.9509
Epoch 63/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1454 - acc: 0.9560 - val_loss: 0.1555 - val_acc: 0.9522
Epoch 64/100
506/506 [==============================] - 56s 112ms/step - loss: 0.1415 - acc: 0.9561 - val_loss: 0.1749 - val_acc: 0.9455
Epoch 65/100
506/506 [==============================] - 56s 111ms/step - loss: 0.1384 - acc: 0.9591 - val_loss: 0.1615 - val_acc: 0.9515

[INFO] Duração do treinamento: 63.7 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 61s 421ms/step - loss: 0.1729 - acc: 0.9501

Perda do teste: 0.173 
Acurácia do Teste: 95.01%

Gerando matriz de confusão tradicional...

[[392   0   1   6  22   0   2   5   0   0   0  13   2   0   1  10   0   0
    0   0   0]
 [  0 429   3   1   1   0   0   0   0   0   0  12   0   0   0   0   0   0
    0   0   0]
 [  0   4 439   7   0   0   0   0   0   0   0   1   4   0   0   0   0   0
    0   0   0]
 [  2   0   0 408   1   0   4   3  14   0   0   3   2   0   2   0   0   1
    0   0   0]
 [  2   7   0   6 421   0   8   0   0   0   0   1   0   0   0   5   0   0
    0   0   0]
 [  0   0   0   6   1 359   7   1   6   0   0   0   0   0   0   0  41   0
    0   0   0]
 [  0   0   0  18   0   0 414   0   4   0   0   2   0   0   2   0   0   0
    0   0   0]
 [  0   0   0  14   0   0  11 394   4   1   0   6   2   0   1   2   1   1
    0   0   3]
 [  0   0   1   4   1   0   0   0 429   0   0   4   0   0   0   0   1   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 432   1   0   6   1   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0  12 427   0   0   1   0   0   0   0
    0   0   0]
 [  4  11  13   7   1   0   2   0   0   0   0 400   2   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   2 438   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   0   0   0 434   0   0   0   0
    0   0   0]
 [  3   0   0   9   6   0  10   0   0   0   0   0   0   0 411   0   0   1
    0   0   0]
 [  3   2   0   0   6   0   0   0   0   0   0   1   2   0   0 426   0   0
    0   0   0]
 [  0   0   3   1   0   5   0   2   0   0   0   0   0   0   0   0 423   0
    0   0   0]
 [  2   2   0   4   3   0   0   0   0   0   0   2   0   0   2   0   0 425
    0   0   0]
 [  2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  437   1   0]
 [  0   0   0   0   0   5   0   0   1   0   0   0   0   0   0   0   0   0
    3 432   0]
 [  1   0   0   0   0   0   0   9   0   0   0   0   0   0   0   1   0   0
    0   0 429]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.95      0.86      0.91       454
           B       0.94      0.96      0.95       446
           C       0.95      0.96      0.96       455
           D       0.83      0.93      0.88       440
           E       0.91      0.94      0.92       450
           F       0.97      0.85      0.91       421
           G       0.90      0.94      0.92       440
           I       0.95      0.90      0.92       440
           L       0.94      0.97      0.96       440
           M       0.96      0.98      0.97       440
           N       1.00      0.97      0.98       440
           O       0.89      0.91      0.90       440
           P       0.96      1.00      0.98       440
           Q       1.00      0.99      0.99       440
           R       0.98      0.93      0.96       440
           S       0.96      0.97      0.96       440
           T       0.91      0.97      0.94       434
           U       0.99      0.97      0.98       440
           V       0.99      0.99      0.99       440
           W       1.00      0.98      0.99       441
           Y       0.99      0.97      0.98       440

    accuracy                           0.95      9261
   macro avg       0.95      0.95      0.95      9261
weighted avg       0.95      0.95      0.95      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_1908