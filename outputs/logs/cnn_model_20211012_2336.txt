[INFO] Inicializando script...

[INFO] Criando sub-conjuntos de dados...

[INFO] Tempo de execução: 1.8 min

[INFO] Redimensionando intensidade dos pixels...

[INFO] Separando conjuntos e embaralhando dados...

Found 32379 images belonging to 21 classes.
Found 4622 images belonging to 21 classes.
Found 9261 images belonging to 21 classes.
[INFO] Construindo modelo neural...

Model: "sequential_12"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_36 (Conv2D)           (None, 64, 64, 8)         224       
_________________________________________________________________
activation_36 (Activation)   (None, 64, 64, 8)         0         
_________________________________________________________________
max_pooling2d_36 (MaxPooling (None, 32, 32, 8)         0         
_________________________________________________________________
conv2d_37 (Conv2D)           (None, 32, 32, 16)        1168      
_________________________________________________________________
activation_37 (Activation)   (None, 32, 32, 16)        0         
_________________________________________________________________
max_pooling2d_37 (MaxPooling (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_38 (Conv2D)           (None, 16, 16, 32)        4640      
_________________________________________________________________
activation_38 (Activation)   (None, 16, 16, 32)        0         
_________________________________________________________________
max_pooling2d_38 (MaxPooling (None, 8, 8, 32)          0         
_________________________________________________________________
flatten_12 (Flatten)         (None, 2048)              0         
_________________________________________________________________
dense_24 (Dense)             (None, 16)                32784     
_________________________________________________________________
dense_25 (Dense)             (None, 21)                357       
=================================================================
Total params: 39,173
Trainable params: 39,173
Non-trainable params: 0
_________________________________________________________________

[INFO] Treinando modelo...

Epoch 1/100
506/506 [==============================] - 229s 452ms/step - loss: 2.9006 - acc: 0.1427 - val_loss: 2.4891 - val_acc: 0.3379
Epoch 2/100
506/506 [==============================] - 60s 119ms/step - loss: 1.9905 - acc: 0.4526 - val_loss: 1.5376 - val_acc: 0.5857
Epoch 3/100
506/506 [==============================] - 66s 130ms/step - loss: 1.3367 - acc: 0.6349 - val_loss: 1.0871 - val_acc: 0.6943
Epoch 4/100
506/506 [==============================] - 68s 133ms/step - loss: 1.0144 - acc: 0.7115 - val_loss: 0.8692 - val_acc: 0.7640
Epoch 5/100
506/506 [==============================] - 64s 126ms/step - loss: 0.8392 - acc: 0.7557 - val_loss: 0.7183 - val_acc: 0.7953
Epoch 6/100
506/506 [==============================] - 61s 121ms/step - loss: 0.7229 - acc: 0.7859 - val_loss: 0.6549 - val_acc: 0.8120
Epoch 7/100
506/506 [==============================] - 62s 123ms/step - loss: 0.6461 - acc: 0.8085 - val_loss: 0.5779 - val_acc: 0.8347
Epoch 8/100
506/506 [==============================] - 62s 123ms/step - loss: 0.5767 - acc: 0.8297 - val_loss: 0.5204 - val_acc: 0.8498
Epoch 9/100
506/506 [==============================] - 62s 122ms/step - loss: 0.5201 - acc: 0.8447 - val_loss: 0.4717 - val_acc: 0.8617
Epoch 10/100
506/506 [==============================] - 63s 124ms/step - loss: 0.4747 - acc: 0.8607 - val_loss: 0.4368 - val_acc: 0.8741
Epoch 11/100
506/506 [==============================] - 62s 123ms/step - loss: 0.4451 - acc: 0.8690 - val_loss: 0.3994 - val_acc: 0.8871
Epoch 12/100
506/506 [==============================] - 62s 123ms/step - loss: 0.4079 - acc: 0.8796 - val_loss: 0.3706 - val_acc: 0.8966
Epoch 13/100
506/506 [==============================] - 62s 123ms/step - loss: 0.3765 - acc: 0.8898 - val_loss: 0.3512 - val_acc: 0.9011
Epoch 14/100
506/506 [==============================] - 62s 122ms/step - loss: 0.3443 - acc: 0.9015 - val_loss: 0.3354 - val_acc: 0.9005
Epoch 15/100
506/506 [==============================] - 62s 123ms/step - loss: 0.3235 - acc: 0.9077 - val_loss: 0.3135 - val_acc: 0.9128
Epoch 16/100
506/506 [==============================] - 63s 124ms/step - loss: 0.2996 - acc: 0.9137 - val_loss: 0.3061 - val_acc: 0.9106
Epoch 17/100
506/506 [==============================] - 63s 124ms/step - loss: 0.2765 - acc: 0.9218 - val_loss: 0.2569 - val_acc: 0.9327
Epoch 18/100
506/506 [==============================] - 62s 122ms/step - loss: 0.2595 - acc: 0.9263 - val_loss: 0.2394 - val_acc: 0.9366
Epoch 19/100
506/506 [==============================] - 62s 123ms/step - loss: 0.2387 - acc: 0.9330 - val_loss: 0.2368 - val_acc: 0.9338
Epoch 20/100
506/506 [==============================] - 62s 123ms/step - loss: 0.2236 - acc: 0.9373 - val_loss: 0.2319 - val_acc: 0.9336
Epoch 21/100
506/506 [==============================] - 62s 123ms/step - loss: 0.2109 - acc: 0.9402 - val_loss: 0.2043 - val_acc: 0.9422
Epoch 22/100
506/506 [==============================] - 61s 121ms/step - loss: 0.1956 - acc: 0.9435 - val_loss: 0.1893 - val_acc: 0.9485
Epoch 23/100
506/506 [==============================] - 62s 122ms/step - loss: 0.1835 - acc: 0.9470 - val_loss: 0.1763 - val_acc: 0.9531
Epoch 24/100
506/506 [==============================] - 62s 122ms/step - loss: 0.1698 - acc: 0.9513 - val_loss: 0.1730 - val_acc: 0.9537
Epoch 25/100
506/506 [==============================] - 61s 121ms/step - loss: 0.1573 - acc: 0.9558 - val_loss: 0.1553 - val_acc: 0.9543
Epoch 26/100
506/506 [==============================] - 61s 121ms/step - loss: 0.1495 - acc: 0.9578 - val_loss: 0.1503 - val_acc: 0.9602
Epoch 27/100
506/506 [==============================] - 61s 121ms/step - loss: 0.1369 - acc: 0.9619 - val_loss: 0.1315 - val_acc: 0.9650
Epoch 28/100
506/506 [==============================] - 60s 119ms/step - loss: 0.1246 - acc: 0.9655 - val_loss: 0.1414 - val_acc: 0.9619
Epoch 29/100
506/506 [==============================] - 57s 112ms/step - loss: 0.1207 - acc: 0.9663 - val_loss: 0.1320 - val_acc: 0.9619
Epoch 30/100
506/506 [==============================] - 55s 110ms/step - loss: 0.1138 - acc: 0.9693 - val_loss: 0.1351 - val_acc: 0.9626
Epoch 31/100
506/506 [==============================] - 56s 110ms/step - loss: 0.1056 - acc: 0.9719 - val_loss: 0.0999 - val_acc: 0.9717
Epoch 32/100
506/506 [==============================] - 56s 112ms/step - loss: 0.0981 - acc: 0.9741 - val_loss: 0.1095 - val_acc: 0.9665
Epoch 33/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0918 - acc: 0.9755 - val_loss: 0.0901 - val_acc: 0.9738
Epoch 34/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0848 - acc: 0.9779 - val_loss: 0.0962 - val_acc: 0.9747
Epoch 35/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0791 - acc: 0.9789 - val_loss: 0.0826 - val_acc: 0.9758
Epoch 36/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0749 - acc: 0.9797 - val_loss: 0.0802 - val_acc: 0.9768
Epoch 37/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0692 - acc: 0.9815 - val_loss: 0.0720 - val_acc: 0.9805
Epoch 38/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0643 - acc: 0.9833 - val_loss: 0.0825 - val_acc: 0.9743
Epoch 39/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0632 - acc: 0.9834 - val_loss: 0.0703 - val_acc: 0.9818
Epoch 40/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0559 - acc: 0.9863 - val_loss: 0.0704 - val_acc: 0.9816
Epoch 41/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0524 - acc: 0.9868 - val_loss: 0.0549 - val_acc: 0.9844
Epoch 42/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0501 - acc: 0.9877 - val_loss: 0.0519 - val_acc: 0.9872
Epoch 43/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0471 - acc: 0.9880 - val_loss: 0.0494 - val_acc: 0.9868
Epoch 44/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0430 - acc: 0.9897 - val_loss: 0.0524 - val_acc: 0.9857
Epoch 45/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0415 - acc: 0.9904 - val_loss: 0.0458 - val_acc: 0.9881
Epoch 46/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0399 - acc: 0.9906 - val_loss: 0.0412 - val_acc: 0.9894
Epoch 47/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0362 - acc: 0.9912 - val_loss: 0.0366 - val_acc: 0.9916
Epoch 48/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0373 - acc: 0.9913 - val_loss: 0.0485 - val_acc: 0.9857
Epoch 49/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0332 - acc: 0.9920 - val_loss: 0.0513 - val_acc: 0.9864
Epoch 50/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0297 - acc: 0.9932 - val_loss: 0.0375 - val_acc: 0.9892
Epoch 51/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0290 - acc: 0.9932 - val_loss: 0.0299 - val_acc: 0.9918
Epoch 52/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0277 - acc: 0.9935 - val_loss: 0.0311 - val_acc: 0.9916
Epoch 53/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0260 - acc: 0.9941 - val_loss: 0.0370 - val_acc: 0.9900
Epoch 54/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0251 - acc: 0.9943 - val_loss: 0.0351 - val_acc: 0.9916
Epoch 55/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0220 - acc: 0.9958 - val_loss: 0.0282 - val_acc: 0.9924
Epoch 56/100
506/506 [==============================] - 55s 110ms/step - loss: 0.0216 - acc: 0.9954 - val_loss: 0.0322 - val_acc: 0.9922
Epoch 57/100
506/506 [==============================] - 60s 118ms/step - loss: 0.0229 - acc: 0.9952 - val_loss: 0.0229 - val_acc: 0.9944
Epoch 58/100
506/506 [==============================] - 72s 141ms/step - loss: 0.0184 - acc: 0.9963 - val_loss: 0.0223 - val_acc: 0.9944
Epoch 59/100
506/506 [==============================] - 57s 113ms/step - loss: 0.0188 - acc: 0.9956 - val_loss: 0.0240 - val_acc: 0.9950
Epoch 60/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0181 - acc: 0.9962 - val_loss: 0.0297 - val_acc: 0.9926
Epoch 61/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0177 - acc: 0.9960 - val_loss: 0.0185 - val_acc: 0.9952
Epoch 62/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0163 - acc: 0.9965 - val_loss: 0.0197 - val_acc: 0.9952
Epoch 63/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0138 - acc: 0.9974 - val_loss: 0.0217 - val_acc: 0.9948
Epoch 64/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0153 - acc: 0.9968 - val_loss: 0.0160 - val_acc: 0.9965
Epoch 65/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0139 - acc: 0.9969 - val_loss: 0.0413 - val_acc: 0.9862
Epoch 66/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0131 - acc: 0.9976 - val_loss: 0.0156 - val_acc: 0.9959
Epoch 67/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0116 - acc: 0.9977 - val_loss: 0.0267 - val_acc: 0.9911
Epoch 68/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0125 - acc: 0.9974 - val_loss: 0.0206 - val_acc: 0.9946
Epoch 69/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0113 - acc: 0.9978 - val_loss: 0.0166 - val_acc: 0.9970
Epoch 70/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0132 - acc: 0.9972 - val_loss: 0.0159 - val_acc: 0.9961
Epoch 71/100
506/506 [==============================] - 56s 110ms/step - loss: 0.0104 - acc: 0.9981 - val_loss: 0.0111 - val_acc: 0.9978
Epoch 72/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0086 - acc: 0.9983 - val_loss: 0.0154 - val_acc: 0.9948
Epoch 73/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0087 - acc: 0.9987 - val_loss: 0.0112 - val_acc: 0.9974
Epoch 74/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0098 - acc: 0.9980 - val_loss: 0.0132 - val_acc: 0.9961
Epoch 75/100
506/506 [==============================] - 56s 111ms/step - loss: 0.0094 - acc: 0.9982 - val_loss: 0.0135 - val_acc: 0.9959
Epoch 76/100
506/506 [==============================] - 57s 112ms/step - loss: 0.0090 - acc: 0.9981 - val_loss: 0.0133 - val_acc: 0.9970

[INFO] Duração do treinamento: 77.2 min

[INFO] Salvando o modelo...

[INFO] Avaliando modelo com conjunto de teste...

145/145 [==============================] - 69s 476ms/step - loss: 0.0247 - acc: 0.9956

Perda do teste: 0.025 
Acurácia do Teste: 99.56%

Gerando matriz de confusão tradicional...

[[451   0   0   1   2   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0 445   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
    0   0   0]
 [  0   0 455   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  2   0   0 434   0   0   3   0   0   0   0   0   1   0   0   0   0   0
    0   0   0]
 [  0   0   0   0 450   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0 418   0   0   0   0   0   0   0   0   0   0   2   0
    0   0   1]
 [  0   0   0   0   0   0 439   1   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0 440   0   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   1 439   0   0   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0 437   3   0   0   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   2 438   0   0   0   0   0   0   0
    0   0   0]
 [  3   0   1   0   0   0   1   2   0   0   0 430   0   1   0   0   0   0
    1   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0 440   0   0   0   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   0   0   0 438   0   0   0   0
    0   0   0]
 [  0   0   0   1   0   0   1   0   0   0   0   0   0   0 437   0   0   1
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 440   0   0
    0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 434   0
    0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   0   0   1   0   0   0   0 438
    0   0   0]
 [  0   0   0   0   0   1   0   0   0   0   0   0   0   0   2   0   0   0
  437   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    1 440   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 440]]

Quantidade total de amostras de teste:  9261

Classification Report

              precision    recall  f1-score   support

           A       0.99      0.99      0.99       454
           B       1.00      1.00      1.00       446
           C       1.00      1.00      1.00       455
           D       1.00      0.99      0.99       440
           E       1.00      1.00      1.00       450
           F       1.00      0.99      1.00       421
           G       0.99      1.00      0.99       440
           I       0.99      1.00      0.99       440
           L       1.00      1.00      1.00       440
           M       0.99      0.99      0.99       440
           N       0.99      1.00      0.99       440
           O       1.00      0.98      0.99       440
           P       1.00      1.00      1.00       440
           Q       1.00      1.00      1.00       440
           R       1.00      0.99      0.99       440
           S       1.00      1.00      1.00       440
           T       1.00      1.00      1.00       434
           U       1.00      1.00      1.00       440
           V       1.00      0.99      0.99       440
           W       1.00      1.00      1.00       441
           Y       1.00      1.00      1.00       440

    accuracy                           1.00      9261
   macro avg       1.00      1.00      1.00      9261
weighted avg       1.00      1.00      1.00      9261

[INFO] Gerando matriz de confusão formatada...

[INFO] Plottando gráficos...

[INFO] Gerando imagem da arquitetura do modelo...

[INFO] Apagando sub-conjuntos criados...

[INFO] [FIM]20211012_2338